(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{279371:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({entityKind:()=>t,hasOwnEntityKind:()=>i,is:()=>n});let t=Symbol.for("drizzle:entityKind"),i=Symbol.for("drizzle:hasOwnEntityKind");function n(e,i){if(!e||"object"!=typeof e)return!1;if(e instanceof i)return!0;if(!Object.prototype.hasOwnProperty.call(i,t))throw Error(`Class "${i.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let n=Object.getPrototypeOf(e).constructor;if(n)for(;n;){if(t in n&&n[t]===i[t])return!0;n=Object.getPrototypeOf(n)}return!1}}},464636:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({TableName:()=>t});let t=Symbol.for("drizzle:Name")}},607207:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({BaseName:()=>u,Columns:()=>i,ExtraConfigBuilder:()=>m,ExtraConfigColumns:()=>o,IsAlias:()=>c,OriginalName:()=>d,Schema:()=>t,Table:()=>h,getTableName:()=>a,getTableUniqueName:()=>l,isTable:()=>s});var n=e.i(279371),r=e.i(464636);let t=Symbol.for("drizzle:Schema"),i=Symbol.for("drizzle:Columns"),o=Symbol.for("drizzle:ExtraConfigColumns"),d=Symbol.for("drizzle:OriginalName"),u=Symbol.for("drizzle:BaseName"),c=Symbol.for("drizzle:IsAlias"),m=Symbol.for("drizzle:ExtraConfigBuilder"),g=Symbol.for("drizzle:IsDrizzleTable");class h{static [n.entityKind]="Table";static Symbol={Name:r.TableName,Schema:t,OriginalName:d,Columns:i,ExtraConfigColumns:o,BaseName:u,IsAlias:c,ExtraConfigBuilder:m};[r.TableName];[d];[t];[i];[o];[u];[c]=!1;[g]=!0;[m]=void 0;constructor(e,i,n){this[r.TableName]=this[d]=e,this[t]=i,this[u]=n}}function s(e){return"object"==typeof e&&null!==e&&g in e}function a(e){return e[r.TableName]}function l(e){return`${e[t]??"public"}.${e[r.TableName]}`}}},47473:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({Column:()=>t});var n=e.i(279371);class t{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static [n.entityKind]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return void 0!==this.config.generated&&"byDefault"!==this.config.generated.type}}}},505085:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({ColumnBuilder:()=>t});var n=e.i(279371);class t{static [n.entityKind]="ColumnBuilder";config;constructor(e,t,i){this.config={name:e,keyAsName:""===e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:i,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){""===this.config.name&&(this.config.name=e)}}}},977481:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({ForeignKey:()=>i,ForeignKeyBuilder:()=>t,foreignKey:()=>s});var n=e.i(279371),r=e.i(464636);class t{static [n.entityKind]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:t,columns:i,foreignColumns:n}=e();return{name:t,columns:i,foreignTable:n[0].table,foreignColumns:n}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=void 0===e?"no action":e,this}onDelete(e){return this._onDelete=void 0===e?"no action":e,this}build(e){return new i(e,this)}}class i{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static [n.entityKind]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:i}=this.reference(),n=t.map(e=>e.name),s=i.map(e=>e.name),a=[this.table[r.TableName],...n,i[0].table[r.TableName],...s];return e??`${a.join("_")}_fk`}}function s(e){return new t(function(){let{name:t,columns:i,foreignColumns:n}=e;return{name:t,columns:i,foreignColumns:n}})}}},766826:e=>{"use strict";var{g:t,__dirname:i}=e;function n(e,...t){return e(...t)}e.s({iife:()=>n})},394743:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({UniqueConstraint:()=>l,UniqueConstraintBuilder:()=>t,UniqueOnConstraintBuilder:()=>i,unique:()=>s,uniqueKeyName:()=>a});var n=e.i(279371),r=e.i(464636);function s(e){return new i(e)}function a(e,t){return`${e[r.TableName]}_${t.join("_")}_unique`}class t{constructor(e,t){this.name=t,this.columns=e}static [n.entityKind]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new l(e,this.columns,this.nullsNotDistinctConfig,this.name)}}class i{static [n.entityKind]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new t(e,this.name)}}class l{constructor(e,t,i,n){this.table=e,this.columns=t,this.name=n??a(this.table,this.columns.map(e=>e.name)),this.nullsNotDistinct=i}static [n.entityKind]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}}},818715:e=>{"use strict";var{g:t,__dirname:i}=e;function n(e,t,i){for(let n=t;n<e.length;n++){let r=e[n];if("\\"===r){n++;continue}if('"'===r)return[e.slice(t,n).replace(/\\/g,""),n+1];if(!i&&(","===r||"}"===r))return[e.slice(t,n).replace(/\\/g,""),n]}return[e.slice(t).replace(/\\/g,""),e.length]}function r(e,t=0){let i=[],s=t,a=!1;for(;s<e.length;){let l=e[s];if(","===l){(a||s===t)&&i.push(""),a=!0,s++;continue}if(a=!1,"\\"===l){s+=2;continue}if('"'===l){let[t,r]=n(e,s+1,!0);i.push(t),s=r;continue}if("}"===l)return[i,s+1];if("{"===l){let[t,n]=r(e,s+1);i.push(t),s=n;continue}let[o,d]=n(e,s,!1);i.push(o),s=d}return[i,s]}function s(e){let[t]=r(e,1);return t}e.s({makePgArray:()=>function e(t){return`{${t.map(t=>Array.isArray(t)?e(t):"string"==typeof t?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`},parsePgArray:()=>s,parsePgNestedArray:()=>r})},485283:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({ExtraConfigColumn:()=>u,IndexedColumn:()=>c,PgArray:()=>g,PgArrayBuilder:()=>m,PgColumn:()=>i,PgColumnBuilder:()=>t});var n=e.i(505085),r=e.i(47473),s=e.i(279371),a=e.i(977481),l=e.i(766826),o=e.i(394743),d=e.i(818715);class t extends n.ColumnBuilder{foreignKeyConfigs=[];static [s.entityKind]="PgColumnBuilder";array(e){return new m(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:i,actions:n})=>(0,l.iife)((i,n)=>{let r=new a.ForeignKeyBuilder(()=>({columns:[e],foreignColumns:[i()]}));return n.onUpdate&&r.onUpdate(n.onUpdate),n.onDelete&&r.onDelete(n.onDelete),r.build(t)},i,n))}buildExtraConfigColumn(e){return new u(e,this.config)}}class i extends r.Column{constructor(e,t){t.uniqueName||(t.uniqueName=(0,o.uniqueKeyName)(e,[t.name])),super(e,t),this.table=e}static [s.entityKind]="PgColumn"}class u extends i{static [s.entityKind]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}}class c{static [s.entityKind]="IndexedColumn";constructor(e,t,i,n){this.name=e,this.keyAsName=t,this.type=i,this.indexConfig=n}name;keyAsName;type;indexConfig}class m extends t{static [s.entityKind]="PgArrayBuilder";constructor(e,t,i){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=i}build(e){let t=this.config.baseBuilder.build(e);return new g(e,this.config,t)}}class g extends i{constructor(e,t,i,n){super(e,t),this.baseColumn=i,this.range=n,this.size=t.size}size;static [s.entityKind]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${"number"==typeof this.size?this.size:""}]`}mapFromDriverValue(e){return"string"==typeof e&&(e=(0,d.parsePgArray)(e)),e.map(e=>this.baseColumn.mapFromDriverValue(e))}mapToDriverValue(e,t=!1){let i=e.map(e=>null===e?null:(0,s.is)(this.baseColumn,g)?this.baseColumn.mapToDriverValue(e,!0):this.baseColumn.mapToDriverValue(e));return t?i:(0,d.makePgArray)(i)}}}},875531:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgEnumColumn:()=>c,PgEnumColumnBuilder:()=>u,PgEnumObjectColumn:()=>i,PgEnumObjectColumnBuilder:()=>t,isPgEnum:()=>s,pgEnum:()=>a,pgEnumObjectWithSchema:()=>o,pgEnumWithSchema:()=>l});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgEnumObjectColumnBuilder";constructor(e,t){super(e,"string","PgEnumObjectColumn"),this.config.enum=t}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgEnumObjectColumn";enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}let d=Symbol.for("drizzle:isPgEnum");function s(e){return!!e&&"function"==typeof e&&d in e&&!0===e[d]}class u extends r.PgColumnBuilder{static [n.entityKind]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new c(e,this.config)}}class c extends r.PgColumn{static [n.entityKind]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}function a(e,t){return Array.isArray(t)?l(e,[...t],void 0):o(e,t,void 0)}function l(e,t,i){let n=Object.assign(e=>new u(e??"",n),{enumName:e,enumValues:t,schema:i,[d]:!0});return n}function o(e,i,n){let r=Object.assign(e=>new t(e??"",r),{enumName:e,enumValues:Object.values(i),schema:n,[d]:!0});return r}}},535397:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({Subquery:()=>t,WithSubquery:()=>i});var n=e.i(279371);class t{static [n.entityKind]="Subquery";constructor(e,t,i,n=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:i,isWith:n}}}class i extends t{static [n.entityKind]="WithSubquery"}}},362764:e=>{"use strict";var{g:t,__dirname:i}=e;e.s({compatibilityVersion:()=>r,npmVersion:()=>n});var n="0.43.1",r=10},73028:e=>{"use strict";var{g:t,__dirname:i}=e;{let t,i;e.s({tracer:()=>s});var n=e.i(766826),r=e.i(362764);let s={startActiveSpan:(e,s)=>t?(i||(i=t.trace.getTracer("drizzle-orm",r.npmVersion)),(0,n.iife)((t,i)=>i.startActiveSpan(e,e=>{try{return s(e)}catch(i){throw e.setStatus({code:t.SpanStatusCode.ERROR,message:i instanceof Error?i.message:"Unknown error"}),i}finally{e.end()}}),t,i)):s()}}},922402:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({ViewBaseConfig:()=>t});let t=Symbol.for("drizzle:ViewBaseConfig")}},838556:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({FakePrimitiveParam:()=>t,Name:()=>b,Param:()=>_,Placeholder:()=>w,SQL:()=>x,StringChunk:()=>i,View:()=>T,fillPlaceholders:()=>f,getViewName:()=>v,isDriverValueEncoder:()=>m,isSQLWrapper:()=>u,isView:()=>y,name:()=>c,noopDecoder:()=>N,noopEncoder:()=>P,noopMapper:()=>C,param:()=>g,placeholder:()=>p,sql:()=>h});var n=e.i(279371),r=e.i(875531),s=e.i(535397),a=e.i(73028),l=e.i(922402),o=e.i(47473),d=e.i(607207);class t{static [n.entityKind]="FakePrimitiveParam"}function u(e){return null!=e&&"function"==typeof e.getSQL}class i{static [n.entityKind]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new x([this])}}class x{constructor(e){this.queryChunks=e}static [n.entityKind]="SQL";decoder=N;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return a.tracer.startActiveSpan("drizzle.buildSQL",t=>{let i=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":i.sql,"drizzle.query.params":JSON.stringify(i.params)}),i})}buildQueryFromSourceParams(e,t){let a=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:c,escapeName:m,escapeParam:g,prepareTyping:h,inlineParams:p,paramStartIndex:f}=a;var y=e.map(e=>{if((0,n.is)(e,i))return{sql:e.value.join(""),params:[]};if((0,n.is)(e,b))return{sql:m(e.value),params:[]};if(void 0===e)return{sql:"",params:[]};if(Array.isArray(e)){let t=[new i("(")];for(let[n,r]of e.entries())t.push(r),n<e.length-1&&t.push(new i(", "));return t.push(new i(")")),this.buildQueryFromSourceParams(t,a)}if((0,n.is)(e,x))return this.buildQueryFromSourceParams(e.queryChunks,{...a,inlineParams:p||e.shouldInlineParams});if((0,n.is)(e,d.Table)){let t=e[d.Table.Symbol.Schema],i=e[d.Table.Symbol.Name];return{sql:void 0===t||e[d.IsAlias]?m(i):m(t)+"."+m(i),params:[]}}if((0,n.is)(e,o.Column)){let i=c.getColumnCasing(e);if("indexes"===t.invokeSource)return{sql:m(i),params:[]};let n=e.table[d.Table.Symbol.Schema];return{sql:e.table[d.IsAlias]||void 0===n?m(e.table[d.Table.Symbol.Name])+"."+m(i):m(n)+"."+m(e.table[d.Table.Symbol.Name])+"."+m(i),params:[]}}if((0,n.is)(e,T)){let t=e[l.ViewBaseConfig].schema,i=e[l.ViewBaseConfig].name;return{sql:void 0===t||e[l.ViewBaseConfig].isAlias?m(i):m(t)+"."+m(i),params:[]}}if((0,n.is)(e,_)){if((0,n.is)(e.value,w))return{sql:g(f.value++,e),params:[e],typings:["none"]};let t=null===e.value?null:e.encoder.mapToDriverValue(e.value);if((0,n.is)(t,x))return this.buildQueryFromSourceParams([t],a);if(p)return{sql:this.mapInlineParam(t,a),params:[]};let i=["none"];return h&&(i=[h(e.encoder)]),{sql:g(f.value++,t),params:[t],typings:i}}return(0,n.is)(e,w)?{sql:g(f.value++,e),params:[e],typings:["none"]}:(0,n.is)(e,x.Aliased)&&void 0!==e.fieldAlias?{sql:m(e.fieldAlias),params:[]}:(0,n.is)(e,s.Subquery)?e._.isWith?{sql:m(e._.alias),params:[]}:this.buildQueryFromSourceParams([new i("("),e._.sql,new i(") "),new b(e._.alias)],a):(0,r.isPgEnum)(e)?e.schema?{sql:m(e.schema)+"."+m(e.enumName),params:[]}:{sql:m(e.enumName),params:[]}:u(e)?e.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([e.getSQL()],a):this.buildQueryFromSourceParams([new i("("),e.getSQL(),new i(")")],a):p?{sql:this.mapInlineParam(e,a),params:[]}:{sql:g(f.value++,e),params:[e],typings:["none"]}});let v={sql:"",params:[]};for(let e of y)v.sql+=e.sql,v.params.push(...e.params),e.typings?.length&&(v.typings||(v.typings=[]),v.typings.push(...e.typings));return v}mapInlineParam(e,{escapeString:t}){if(null===e)return"null";if("number"==typeof e||"boolean"==typeof e)return e.toString();if("string"==typeof e)return t(e);if("object"==typeof e){let i=e.toString();return"[object Object]"===i?t(JSON.stringify(e)):t(i)}throw Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return void 0===e?this:new x.Aliased(this,e)}mapWith(e){return this.decoder="function"==typeof e?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}}class b{constructor(e){this.value=e}static [n.entityKind]="Name";brand;getSQL(){return new x([this])}}function c(e){return new b(e)}function m(e){return"object"==typeof e&&null!==e&&"mapToDriverValue"in e&&"function"==typeof e.mapToDriverValue}let N={mapFromDriverValue:e=>e},P={mapToDriverValue:e=>e},C={...N,...P};class _{constructor(e,t=P){this.value=e,this.encoder=t}static [n.entityKind]="Param";brand;getSQL(){return new x([this])}}function g(e,t){return new _(e,t)}function h(e,...t){let n=[];for(let[r,s]of((t.length>0||e.length>0&&""!==e[0])&&n.push(new i(e[0])),t.entries()))n.push(s,new i(e[r+1]));return new x(n)}(e=>{e.empty=function(){return new x([])},e.fromList=function(e){return new x(e)},e.raw=function(e){return new x([new i(e)])},e.join=function(e,t){let i=[];for(let[n,r]of e.entries())n>0&&void 0!==t&&i.push(t),i.push(r);return new x(i)},e.identifier=function(e){return new b(e)},e.placeholder=function(e){return new w(e)},e.param=function(e,t){return new _(e,t)}})(h||(h={})),(e=>{class t{constructor(e,t){this.sql=e,this.fieldAlias=t}static [n.entityKind]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new t(this.sql,this.fieldAlias)}}e.Aliased=t})(x||(x={}));class w{constructor(e){this.name=e}static [n.entityKind]="Placeholder";getSQL(){return new x([this])}}function p(e){return new w(e)}function f(e,t){return e.map(e=>{if((0,n.is)(e,w)){if(!(e.name in t))throw Error(`No value for placeholder "${e.name}" was provided`);return t[e.name]}if((0,n.is)(e,_)&&(0,n.is)(e.value,w)){if(!(e.value.name in t))throw Error(`No value for placeholder "${e.value.name}" was provided`);return e.encoder.mapToDriverValue(t[e.value.name])}return e})}let S=Symbol.for("drizzle:IsDrizzleView");class T{static [n.entityKind]="View";[l.ViewBaseConfig];[S]=!0;constructor({name:e,schema:t,selectedFields:i,query:n}){this[l.ViewBaseConfig]={name:e,originalName:e,schema:t,selectedFields:i,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new x([this])}}function y(e){return"object"==typeof e&&null!==e&&S in e}function v(e){return e[l.ViewBaseConfig].name}o.Column.prototype.getSQL=function(){return new x([this])},d.Table.prototype.getSQL=function(){return new x([this])},s.Subquery.prototype.getSQL=function(){return new x([this])}}},790397:e=>{"use strict";var{g:t,__dirname:i}=e;e.s({applyMixins:()=>m,getColumnNameAndConfig:()=>f,getTableColumns:()=>g,getTableLikeName:()=>p,getViewSelectedFields:()=>h,haveSameKeys:()=>u,isConfig:()=>y,mapResultRow:()=>d,mapUpdateSet:()=>c,orderSelectedFields:()=>function e(t,i){return Object.entries(t).reduce((t,[a,o])=>{if("string"!=typeof a)return t;let d=i?[...i,a]:[a];return(0,r.is)(o,n.Column)||(0,r.is)(o,s.SQL)||(0,r.is)(o,s.SQL.Aliased)?t.push({path:d,field:o}):(0,r.is)(o,l.Table)?t.push(...e(o[l.Table.Symbol.Columns],d)):t.push(...e(o,d)),t},[])}});var n=e.i(47473),r=e.i(279371),s=e.i(838556),a=e.i(535397),l=e.i(607207),o=e.i(922402);function d(e,t,i){let a={},o=e.reduce((e,{path:o,field:d},u)=>{let c;c=(0,r.is)(d,n.Column)?d:(0,r.is)(d,s.SQL)?d.decoder:d.sql.decoder;let m=e;for(let[e,s]of o.entries())if(e<o.length-1)s in m||(m[s]={}),m=m[s];else{let e=t[u],g=m[s]=null===e?null:c.mapFromDriverValue(e);if(i&&(0,r.is)(d,n.Column)&&2===o.length){let e=o[0];e in a?"string"==typeof a[e]&&a[e]!==(0,l.getTableName)(d.table)&&(a[e]=!1):a[e]=null===g&&(0,l.getTableName)(d.table)}}return e},{});if(i&&Object.keys(a).length>0)for(let[e,t]of Object.entries(a))"string"!=typeof t||i[t]||(o[e]=null);return o}function u(e,t){let i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(let[e,t]of i.entries())if(t!==n[e])return!1;return!0}function c(e,t){let i=Object.entries(t).filter(([,e])=>void 0!==e).map(([t,i])=>(0,r.is)(i,s.SQL)||(0,r.is)(i,n.Column)?[t,i]:[t,new s.Param(i,e[l.Table.Symbol.Columns][t])]);if(0===i.length)throw Error("No values to set");return Object.fromEntries(i)}function m(e,t){for(let i of t)for(let t of Object.getOwnPropertyNames(i.prototype))"constructor"!==t&&Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(i.prototype,t)||Object.create(null))}function g(e){return e[l.Table.Symbol.Columns]}function h(e){return e[o.ViewBaseConfig].selectedFields}function p(e){return(0,r.is)(e,a.Subquery)?e._.alias:(0,r.is)(e,s.View)?e[o.ViewBaseConfig].name:(0,r.is)(e,s.SQL)?void 0:e[l.Table.Symbol.IsAlias]?e[l.Table.Symbol.Name]:e[l.Table.Symbol.BaseName]}function f(e,t){return{name:"string"==typeof e&&e.length>0?e:"",config:"object"==typeof e?e:t}}function y(e){if("object"!=typeof e||null===e||"Object"!==e.constructor.name)return!1;if("logger"in e){let t=typeof e.logger;return"boolean"===t||"object"===t&&"function"==typeof e.logger.logQuery||"undefined"===t}if("schema"in e){let t=typeof e.schema;return"object"===t||"undefined"===t}if("casing"in e){let t=typeof e.casing;return"string"===t||"undefined"===t}if("mode"in e)return"default"===e.mode&&"planetscale"===e.mode&&void 0===e.mode;if("connection"in e){let t=typeof e.connection;return"string"===t||"object"===t||"undefined"===t}if("client"in e){let t=typeof e.client;return"object"===t||"function"===t||"undefined"===t}return 0===Object.keys(e).length}},571273:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgIntColumnBaseBuilder:()=>t});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...i}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:i}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...i}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:i}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}}},806681:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgBigInt53:()=>i,PgBigInt53Builder:()=>t,PgBigInt64:()=>d,PgBigInt64Builder:()=>o,bigint:()=>l});var n=e.i(279371),r=e.i(790397),s=e.i(485283),a=e.i(571273);class t extends a.PgIntColumnBaseBuilder{static [n.entityKind]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}}class o extends a.PgIntColumnBaseBuilder{static [n.entityKind]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new d(e,this.config)}}class d extends s.PgColumn{static [n.entityKind]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}function l(e,i){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return"number"===s.mode?new t(n):new o(n)}}},431268:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgBigSerial53:()=>i,PgBigSerial53Builder:()=>t,PgBigSerial64:()=>o,PgBigSerial64Builder:()=>l,bigserial:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}}class l extends s.PgColumnBuilder{static [n.entityKind]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new o(e,this.config)}}class o extends s.PgColumn{static [n.entityKind]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}function a(e,i){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return"number"===s.mode?new t(n):new l(n)}}},752567:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgBoolean:()=>i,PgBooleanBuilder:()=>t,boolean:()=>s});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgBoolean";getSQLType(){return"boolean"}}function s(e){return new t(e??"")}}},729295:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgChar:()=>i,PgCharBuilder:()=>t,char:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function a(e,i={}){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return new t(n,s)}}},490215:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgCidr:()=>i,PgCidrBuilder:()=>t,cidr:()=>s});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgCidr";getSQLType(){return"cidr"}}function s(e){return new t(e??"")}}},319141:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgCustomColumn:()=>i,PgCustomColumnBuilder:()=>t,customType:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgCustomColumnBuilder";constructor(e,t,i){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=i}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return"function"==typeof this.mapFrom?this.mapFrom(e):e}mapToDriverValue(e){return"function"==typeof this.mapTo?this.mapTo(e):e}}function a(e){return(i,n)=>{let{name:s,config:a}=(0,r.getColumnNameAndConfig)(i,n);return new t(s,a,e)}}}},167423:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgDateColumnBaseBuilder:()=>t});var n=e.i(279371),r=e.i(838556),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgDateColumnBaseBuilder";defaultNow(){return this.default(r.sql`now()`)}}}},619939:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgDate:()=>i,PgDateBuilder:()=>t,PgDateString:()=>d,PgDateStringBuilder:()=>o,date:()=>l});var n=e.i(279371),r=e.i(790397),s=e.i(485283),a=e.i(167423);class t extends a.PgDateColumnBaseBuilder{static [n.entityKind]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}}class o extends a.PgDateColumnBaseBuilder{static [n.entityKind]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new d(e,this.config)}}class d extends s.PgColumn{static [n.entityKind]="PgDateString";getSQLType(){return"date"}}function l(e,i){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return s?.mode==="date"?new t(n):new o(n)}}},39822:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgDoublePrecision:()=>i,PgDoublePrecisionBuilder:()=>t,doublePrecision:()=>s});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return"string"==typeof e?Number.parseFloat(e):e}}function s(e){return new t(e??"")}}},125238:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgInet:()=>i,PgInetBuilder:()=>t,inet:()=>s});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgInet";getSQLType(){return"inet"}}function s(e){return new t(e??"")}}},585708:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgInteger:()=>i,PgIntegerBuilder:()=>t,integer:()=>a});var n=e.i(279371),r=e.i(485283),s=e.i(571273);class t extends s.PgIntColumnBaseBuilder{static [n.entityKind]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return"string"==typeof e?Number.parseInt(e):e}}function a(e){return new t(e??"")}}},755128:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgInterval:()=>i,PgIntervalBuilder:()=>t,interval:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}}function a(e,i={}){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return new t(n,s)}}},118425:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgJson:()=>i,PgJsonBuilder:()=>t,json:()=>s});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}}function s(e){return new t(e??"")}}},44817:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgJsonb:()=>i,PgJsonbBuilder:()=>t,jsonb:()=>s});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}}function s(e){return new t(e??"")}}},24360:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgLineABC:()=>o,PgLineABCBuilder:()=>l,PgLineBuilder:()=>t,PgLineTuple:()=>i,line:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,i,n]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(i),Number.parseFloat(n)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}}class l extends s.PgColumnBuilder{static [n.entityKind]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new o(e,this.config)}}class o extends s.PgColumn{static [n.entityKind]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,i,n]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(i),c:Number.parseFloat(n)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}function a(e,i){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return s?.mode&&"tuple"!==s.mode?new l(n):new t(n)}}},255975:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgMacaddr:()=>i,PgMacaddrBuilder:()=>t,macaddr:()=>s});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgMacaddr";getSQLType(){return"macaddr"}}function s(e){return new t(e??"")}}},867318:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgMacaddr8:()=>i,PgMacaddr8Builder:()=>t,macaddr8:()=>s});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgMacaddr8";getSQLType(){return"macaddr8"}}function s(e){return new t(e??"")}}},327419:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgNumeric:()=>i,PgNumericBigInt:()=>u,PgNumericBigIntBuilder:()=>d,PgNumericBuilder:()=>t,PgNumericNumber:()=>o,PgNumericNumberBuilder:()=>l,decimal:()=>c,numeric:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgNumericBuilder";constructor(e,t,i){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=i}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue(e){return"string"==typeof e?e:String(e)}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}class l extends s.PgColumnBuilder{static [n.entityKind]="PgNumericNumberBuilder";constructor(e,t,i){super(e,"number","PgNumericNumber"),this.config.precision=t,this.config.scale=i}build(e){return new o(e,this.config)}}class o extends s.PgColumn{static [n.entityKind]="PgNumericNumber";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}mapToDriverValue=String;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}class d extends s.PgColumnBuilder{static [n.entityKind]="PgNumericBigIntBuilder";constructor(e,t,i){super(e,"bigint","PgNumericBigInt"),this.config.precision=t,this.config.scale=i}build(e){return new u(e,this.config)}}class u extends s.PgColumn{static [n.entityKind]="PgNumericBigInt";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}function a(e,i){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i),a=s?.mode;return"number"===a?new l(n,s?.precision,s?.scale):"bigint"===a?new d(n,s?.precision,s?.scale):new t(n,s?.precision,s?.scale)}let c=a}},765173:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgPointObject:()=>o,PgPointObjectBuilder:()=>l,PgPointTuple:()=>i,PgPointTupleBuilder:()=>t,point:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if("string"==typeof e){let[t,i]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(i)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}}class l extends s.PgColumnBuilder{static [n.entityKind]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new o(e,this.config)}}class o extends s.PgColumn{static [n.entityKind]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if("string"==typeof e){let[t,i]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(i)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}function a(e,i){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return s?.mode&&"tuple"!==s.mode?new l(n):new t(n)}}},986688:e=>{"use strict";var{g:t,__dirname:i}=e;function n(e,t){let i=new DataView(new ArrayBuffer(8));for(let n=0;n<8;n++)i.setUint8(n,e[t+n]);return i.getFloat64(0,!0)}function r(e){let t=function(e){let t=[];for(let i=0;i<e.length;i+=2)t.push(Number.parseInt(e.slice(i,i+2),16));return new Uint8Array(t)}(e),i=0,r=t[0];i+=1;let s=new DataView(t.buffer),a=s.getUint32(i,1===r);if(i+=4,0x20000000&a&&(s.getUint32(i,1===r),i+=4),(65535&a)==1){let e=n(t,i),r=n(t,i+=8);return i+=8,[e,r]}throw Error("Unsupported geometry type")}e.s({parseEWKB:()=>r})},246662:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgGeometry:()=>i,PgGeometryBuilder:()=>t,PgGeometryObject:()=>d,PgGeometryObjectBuilder:()=>o,geometry:()=>l});var n=e.i(279371),r=e.i(790397),s=e.i(485283),a=e.i(986688);class t extends s.PgColumnBuilder{static [n.entityKind]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return(0,a.parseEWKB)(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}}class o extends s.PgColumnBuilder{static [n.entityKind]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new d(e,this.config)}}class d extends s.PgColumn{static [n.entityKind]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=(0,a.parseEWKB)(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}function l(e,i){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return s?.mode&&"tuple"!==s.mode?new o(n):new t(n)}}},965839:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgReal:()=>i,PgRealBuilder:()=>t,real:()=>s});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>"string"==typeof e?Number.parseFloat(e):e}function s(e){return new t(e??"")}}},470887:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgSerial:()=>i,PgSerialBuilder:()=>t,serial:()=>s});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgSerial";getSQLType(){return"serial"}}function s(e){return new t(e??"")}}},72244:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgSmallInt:()=>i,PgSmallIntBuilder:()=>t,smallint:()=>a});var n=e.i(279371),r=e.i(485283),s=e.i(571273);class t extends s.PgIntColumnBaseBuilder{static [n.entityKind]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>"string"==typeof e?Number(e):e}function a(e){return new t(e??"")}}},689770:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgSmallSerial:()=>i,PgSmallSerialBuilder:()=>t,smallserial:()=>s});var n=e.i(279371),r=e.i(485283);class t extends r.PgColumnBuilder{static [n.entityKind]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new i(e,this.config)}}class i extends r.PgColumn{static [n.entityKind]="PgSmallSerial";getSQLType(){return"smallserial"}}function s(e){return new t(e??"")}}},995471:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgText:()=>i,PgTextBuilder:()=>t,text:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function a(e,i={}){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return new t(n,s)}}},207961:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgTime:()=>i,PgTimeBuilder:()=>t,time:()=>l});var n=e.i(279371),r=e.i(790397),s=e.i(485283),a=e.i(167423);class t extends a.PgDateColumnBaseBuilder{constructor(e,t,i){super(e,"string","PgTime"),this.withTimezone=t,this.precision=i,this.config.withTimezone=t,this.config.precision=i}static [n.entityKind]="PgTimeBuilder";build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":`(${this.precision})`;return`time${e}${this.withTimezone?" with time zone":""}`}}function l(e,i={}){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return new t(n,s.withTimezone??!1,s.precision)}}},625647:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgTimestamp:()=>i,PgTimestampBuilder:()=>t,PgTimestampString:()=>d,PgTimestampStringBuilder:()=>o,timestamp:()=>l});var n=e.i(279371),r=e.i(790397),s=e.i(485283),a=e.i(167423);class t extends a.PgDateColumnBaseBuilder{static [n.entityKind]="PgTimestampBuilder";constructor(e,t,i){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=i}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":` (${this.precision})`;return`timestamp${e}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()}class o extends a.PgDateColumnBaseBuilder{static [n.entityKind]="PgTimestampStringBuilder";constructor(e,t,i){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=i}build(e){return new d(e,this.config)}}class d extends s.PgColumn{static [n.entityKind]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":`(${this.precision})`;return`timestamp${e}${this.withTimezone?" with time zone":""}`}}function l(e,i={}){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return s?.mode==="string"?new o(n,s.withTimezone??!1,s.precision):new t(n,s?.withTimezone??!1,s?.precision)}}},56464:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgUUID:()=>i,PgUUIDBuilder:()=>t,uuid:()=>a});var n=e.i(279371),r=e.i(838556),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(r.sql`gen_random_uuid()`)}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgUUID";getSQLType(){return"uuid"}}function a(e){return new t(e??"")}}},840166:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgVarchar:()=>i,PgVarcharBuilder:()=>t,varchar:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function a(e,i={}){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return new t(n,s)}}},614305:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgBinaryVector:()=>i,PgBinaryVectorBuilder:()=>t,bit:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function a(e,i){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return new t(n,s)}}},208534:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgHalfVector:()=>i,PgHalfVectorBuilder:()=>t,halfvec:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(e=>Number.parseFloat(e))}}function a(e,i){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return new t(n,s)}}},385352:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgSparseVector:()=>i,PgSparseVectorBuilder:()=>t,sparsevec:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgSparseVectorBuilder";constructor(e,t){super(e,"string","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function a(e,i){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return new t(n,s)}}},54854:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({PgVector:()=>i,PgVectorBuilder:()=>t,vector:()=>a});var n=e.i(279371),r=e.i(790397),s=e.i(485283);class t extends s.PgColumnBuilder{static [n.entityKind]="PgVectorBuilder";constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new i(e,this.config)}}class i extends s.PgColumn{static [n.entityKind]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(e=>Number.parseFloat(e))}}function a(e,i){let{name:n,config:s}=(0,r.getColumnNameAndConfig)(e,i);return new t(n,s)}}},695787:e=>{"use strict";var{g:t,__dirname:i}=e;e.s({getPgColumnBuilders:()=>V});var n=e.i(806681),r=e.i(431268),s=e.i(752567),a=e.i(729295),l=e.i(490215),o=e.i(319141),d=e.i(619939),u=e.i(39822),c=e.i(125238),m=e.i(585708),g=e.i(755128),h=e.i(118425),p=e.i(44817),f=e.i(24360),y=e.i(255975),v=e.i(867318),x=e.i(327419),b=e.i(765173),N=e.i(246662),P=e.i(965839),C=e.i(470887),_=e.i(72244),w=e.i(689770),S=e.i(995471),T=e.i(207961),j=e.i(625647),B=e.i(56464),D=e.i(840166),A=e.i(614305),I=e.i(208534),E=e.i(385352),K=e.i(54854);function V(){return{bigint:n.bigint,bigserial:r.bigserial,boolean:s.boolean,char:a.char,cidr:l.cidr,customType:o.customType,date:d.date,doublePrecision:u.doublePrecision,inet:c.inet,integer:m.integer,interval:g.interval,json:h.json,jsonb:p.jsonb,line:f.line,macaddr:y.macaddr,macaddr8:v.macaddr8,numeric:x.numeric,point:b.point,geometry:N.geometry,real:P.real,serial:C.serial,smallint:_.smallint,smallserial:w.smallserial,text:S.text,time:T.time,timestamp:j.timestamp,uuid:B.uuid,varchar:D.varchar,bit:A.bit,halfvec:I.halfvec,sparsevec:E.sparsevec,vector:K.vector}}},714171:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({EnableRLS:()=>i,InlineForeignKeys:()=>t,PgTable:()=>o,pgTable:()=>d,pgTableCreator:()=>l,pgTableWithSchema:()=>a});var n=e.i(279371),r=e.i(607207),s=e.i(695787);let t=Symbol.for("drizzle:PgInlineForeignKeys"),i=Symbol.for("drizzle:EnableRLS");class o extends r.Table{static [n.entityKind]="PgTable";static Symbol=Object.assign({},r.Table.Symbol,{InlineForeignKeys:t,EnableRLS:i});[t]=[];[i]=!1;[r.Table.Symbol.ExtraConfigBuilder]=void 0;[r.Table.Symbol.ExtraConfigColumns]={}}function a(e,i,n,l,d=e){let u=new o(e,l,d),c="function"==typeof i?i((0,s.getPgColumnBuilders)()):i,m=Object.fromEntries(Object.entries(c).map(([e,i])=>{i.setName(e);let n=i.build(u);return u[t].push(...i.buildForeignKeys(n,u)),[e,n]})),g=Object.fromEntries(Object.entries(c).map(([e,t])=>(t.setName(e),[e,t.buildExtraConfigColumn(u)]))),h=Object.assign(u,m);return h[r.Table.Symbol.Columns]=m,h[r.Table.Symbol.ExtraConfigColumns]=g,n&&(h[o.Symbol.ExtraConfigBuilder]=n),Object.assign(h,{enableRLS:()=>(h[o.Symbol.EnableRLS]=!0,h)})}let d=(e,t,i)=>a(e,t,i,void 0);function l(e){return(t,i,n)=>a(e(t),i,n,void 0,t)}}},644452:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({account:()=>o,apikey:()=>u,session:()=>i,user:()=>t,verification:()=>d});var n=e.i(714171),r=e.i(995471),s=e.i(625647),a=e.i(752567),l=e.i(585708);let t=(0,n.pgTable)("user",{id:(0,r.text)("id").primaryKey(),name:(0,r.text)("name").notNull(),email:(0,r.text)("email").notNull().unique(),emailVerified:(0,a.boolean)("email_verified").$defaultFn(()=>!1).notNull(),image:(0,r.text)("image"),createdAt:(0,s.timestamp)("created_at").$defaultFn(()=>new Date).notNull(),updatedAt:(0,s.timestamp)("updated_at").$defaultFn(()=>new Date).notNull(),role:(0,r.text)("role"),banned:(0,a.boolean)("banned"),banReason:(0,r.text)("ban_reason"),banExpires:(0,s.timestamp)("ban_expires"),stripeCustomerId:(0,r.text)("stripe_customer_id"),webhooksToEndpointsMigrated:(0,a.boolean)("webhooks_to_endpoints_migrated").default(!1),featureFlags:(0,r.text)("feature_flags")}),i=(0,n.pgTable)("session",{id:(0,r.text)("id").primaryKey(),expiresAt:(0,s.timestamp)("expires_at").notNull(),token:(0,r.text)("token").notNull().unique(),createdAt:(0,s.timestamp)("created_at").notNull(),updatedAt:(0,s.timestamp)("updated_at").notNull(),ipAddress:(0,r.text)("ip_address"),userAgent:(0,r.text)("user_agent"),userId:(0,r.text)("user_id").notNull().references(()=>t.id,{onDelete:"cascade"}),impersonatedBy:(0,r.text)("impersonated_by")}),o=(0,n.pgTable)("account",{id:(0,r.text)("id").primaryKey(),accountId:(0,r.text)("account_id").notNull(),providerId:(0,r.text)("provider_id").notNull(),userId:(0,r.text)("user_id").notNull().references(()=>t.id,{onDelete:"cascade"}),accessToken:(0,r.text)("access_token"),refreshToken:(0,r.text)("refresh_token"),idToken:(0,r.text)("id_token"),accessTokenExpiresAt:(0,s.timestamp)("access_token_expires_at"),refreshTokenExpiresAt:(0,s.timestamp)("refresh_token_expires_at"),scope:(0,r.text)("scope"),password:(0,r.text)("password"),createdAt:(0,s.timestamp)("created_at").notNull(),updatedAt:(0,s.timestamp)("updated_at").notNull()}),d=(0,n.pgTable)("verification",{id:(0,r.text)("id").primaryKey(),identifier:(0,r.text)("identifier").notNull(),value:(0,r.text)("value").notNull(),expiresAt:(0,s.timestamp)("expires_at").notNull(),createdAt:(0,s.timestamp)("created_at").$defaultFn(()=>new Date),updatedAt:(0,s.timestamp)("updated_at").$defaultFn(()=>new Date)}),u=(0,n.pgTable)("apikey",{id:(0,r.text)("id").primaryKey(),name:(0,r.text)("name"),start:(0,r.text)("start"),prefix:(0,r.text)("prefix"),key:(0,r.text)("key").notNull(),userId:(0,r.text)("user_id").notNull().references(()=>t.id,{onDelete:"cascade"}),refillInterval:(0,l.integer)("refill_interval"),refillAmount:(0,l.integer)("refill_amount"),lastRefillAt:(0,s.timestamp)("last_refill_at"),enabled:(0,a.boolean)("enabled").default(!0),rateLimitEnabled:(0,a.boolean)("rate_limit_enabled").default(!0),rateLimitTimeWindow:(0,l.integer)("rate_limit_time_window").default(864e5),rateLimitMax:(0,l.integer)("rate_limit_max").default(10),requestCount:(0,l.integer)("request_count"),remaining:(0,l.integer)("remaining"),lastRequest:(0,s.timestamp)("last_request"),expiresAt:(0,s.timestamp)("expires_at"),createdAt:(0,s.timestamp)("created_at").notNull(),updatedAt:(0,s.timestamp)("updated_at").notNull(),permissions:(0,r.text)("permissions"),metadata:(0,r.text)("metadata")})}},471364:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({DELIVERY_STATUS:()=>F,DELIVERY_TYPES:()=>A,DOMAIN_STATUS:()=>_,EMAIL_STATUS:()=>T,ENDPOINT_TYPES:()=>B,PROVIDER_CONFIDENCE:()=>S,SENT_EMAIL_STATUS:()=>L,SES_VERIFICATION_STATUS:()=>w,VIP_PAYMENT_STATUS:()=>k,WEBHOOK_FORMATS:()=>D,WEBHOOK_STATUS:()=>j,blockedEmails:()=>P,domainDnsRecords:()=>v,emailAddresses:()=>c,emailDomains:()=>u,emailGroups:()=>b,endpointDeliveries:()=>N,endpoints:()=>x,parsedEmails:()=>p,receivedEmails:()=>h,sentEmails:()=>C,sesEvents:()=>g,structuredEmails:()=>f,subscriptions:()=>t,userAccounts:()=>i,userOnboarding:()=>d,vipAllowedSenders:()=>K,vipConfigs:()=>I,vipEmailAttempts:()=>V,vipPaymentSessions:()=>E,webhookDeliveries:()=>y,webhooks:()=>m});var n=e.i(714171),r=e.i(840166),s=e.i(995471),a=e.i(625647),l=e.i(752567),o=e.i(585708);e.i(644452);let t=(0,n.pgTable)("subscriptions",{id:(0,r.varchar)("id",{length:255}).primaryKey(),plan:(0,r.varchar)("plan",{length:255}).notNull(),referenceId:(0,r.varchar)("reference_id",{length:255}).notNull(),stripeCustomerId:(0,r.varchar)("stripe_customer_id",{length:255}),stripeSubscriptionId:(0,r.varchar)("stripe_subscription_id",{length:255}),status:(0,r.varchar)("status",{length:255}).notNull(),periodStart:(0,a.timestamp)("period_start"),periodEnd:(0,a.timestamp)("period_end"),cancelAtPeriodEnd:(0,l.boolean)("cancel_at_period_end").default(!1),seats:(0,o.integer)("seats"),trialStart:(0,a.timestamp)("trial_start"),trialEnd:(0,a.timestamp)("trial_end"),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),i=(0,n.pgTable)("user_accounts",{id:(0,r.varchar)("id",{length:255}).primaryKey(),userId:(0,r.varchar)("user_id",{length:255}).notNull(),stripeRestrictedKey:(0,s.text)("stripe_restricted_key"),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),d=(0,n.pgTable)("user_onboarding",{id:(0,r.varchar)("id",{length:255}).primaryKey(),userId:(0,r.varchar)("user_id",{length:255}).notNull().unique(),isCompleted:(0,l.boolean)("is_completed").default(!1).notNull(),defaultEndpointCreated:(0,l.boolean)("default_endpoint_created").default(!1).notNull(),completedAt:(0,a.timestamp)("completed_at"),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),u=(0,n.pgTable)("email_domains",{id:(0,r.varchar)("id",{length:255}).primaryKey(),domain:(0,r.varchar)("domain",{length:255}).notNull().unique(),status:(0,r.varchar)("status",{length:50}).notNull(),verificationToken:(0,r.varchar)("verification_token",{length:255}),canReceiveEmails:(0,l.boolean)("can_receive_emails").default(!1),hasMxRecords:(0,l.boolean)("has_mx_records").default(!1),domainProvider:(0,r.varchar)("domain_provider",{length:100}),providerConfidence:(0,r.varchar)("provider_confidence",{length:20}),lastDnsCheck:(0,a.timestamp)("last_dns_check"),lastSesCheck:(0,a.timestamp)("last_ses_check"),isCatchAllEnabled:(0,l.boolean)("is_catch_all_enabled").default(!1),catchAllWebhookId:(0,r.varchar)("catch_all_webhook_id",{length:255}),catchAllEndpointId:(0,r.varchar)("catch_all_endpoint_id",{length:255}),catchAllReceiptRuleName:(0,r.varchar)("catch_all_receipt_rule_name",{length:255}),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow(),userId:(0,r.varchar)("user_id",{length:255}).notNull()}),c=(0,n.pgTable)("email_addresses",{id:(0,r.varchar)("id",{length:255}).primaryKey(),address:(0,r.varchar)("address",{length:255}).notNull().unique(),domainId:(0,r.varchar)("domain_id",{length:255}).notNull(),webhookId:(0,r.varchar)("webhook_id",{length:255}),endpointId:(0,r.varchar)("endpoint_id",{length:255}),isActive:(0,l.boolean)("is_active").default(!0),isReceiptRuleConfigured:(0,l.boolean)("is_receipt_rule_configured").default(!1),receiptRuleName:(0,r.varchar)("receipt_rule_name",{length:255}),isVipEnabled:(0,l.boolean)("is_vip_enabled").default(!1),vipConfigId:(0,r.varchar)("vip_config_id",{length:255}),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow(),userId:(0,r.varchar)("user_id",{length:255}).notNull()}),m=(0,n.pgTable)("webhooks",{id:(0,r.varchar)("id",{length:255}).primaryKey(),name:(0,r.varchar)("name",{length:255}).notNull(),url:(0,s.text)("url").notNull(),secret:(0,r.varchar)("secret",{length:255}),isActive:(0,l.boolean)("is_active").default(!0),description:(0,s.text)("description"),headers:(0,s.text)("headers"),timeout:(0,o.integer)("timeout").default(30),retryAttempts:(0,o.integer)("retry_attempts").default(3),lastUsed:(0,a.timestamp)("last_used"),totalDeliveries:(0,o.integer)("total_deliveries").default(0),successfulDeliveries:(0,o.integer)("successful_deliveries").default(0),failedDeliveries:(0,o.integer)("failed_deliveries").default(0),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow(),userId:(0,r.varchar)("user_id",{length:255}).notNull()}),g=(0,n.pgTable)("ses_events",{id:(0,r.varchar)("id",{length:255}).primaryKey(),eventSource:(0,r.varchar)("event_source",{length:100}).notNull(),eventVersion:(0,r.varchar)("event_version",{length:50}).notNull(),messageId:(0,r.varchar)("message_id",{length:255}).notNull(),source:(0,r.varchar)("source",{length:255}).notNull(),destination:(0,s.text)("destination").notNull(),subject:(0,s.text)("subject"),timestamp:(0,a.timestamp)("timestamp").notNull(),receiptTimestamp:(0,a.timestamp)("receipt_timestamp").notNull(),processingTimeMillis:(0,o.integer)("processing_time_millis"),recipients:(0,s.text)("recipients").notNull(),spamVerdict:(0,r.varchar)("spam_verdict",{length:50}),virusVerdict:(0,r.varchar)("virus_verdict",{length:50}),spfVerdict:(0,r.varchar)("spf_verdict",{length:50}),dkimVerdict:(0,r.varchar)("dkim_verdict",{length:50}),dmarcVerdict:(0,r.varchar)("dmarc_verdict",{length:50}),actionType:(0,r.varchar)("action_type",{length:50}),s3BucketName:(0,r.varchar)("s3_bucket_name",{length:255}),s3ObjectKey:(0,r.varchar)("s3_object_key",{length:500}),emailContent:(0,s.text)("email_content"),s3ContentFetched:(0,l.boolean)("s3_content_fetched").default(!1),s3ContentSize:(0,o.integer)("s3_content_size"),s3Error:(0,s.text)("s3_error"),commonHeaders:(0,s.text)("common_headers"),rawSesEvent:(0,s.text)("raw_ses_event").notNull(),lambdaContext:(0,s.text)("lambda_context"),webhookPayload:(0,s.text)("webhook_payload"),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),h=(0,n.pgTable)("received_emails",{id:(0,r.varchar)("id",{length:255}).primaryKey(),sesEventId:(0,r.varchar)("ses_event_id",{length:255}).notNull(),messageId:(0,r.varchar)("message_id",{length:255}).notNull(),from:(0,r.varchar)("from",{length:255}).notNull(),to:(0,s.text)("to").notNull(),recipient:(0,r.varchar)("recipient",{length:255}).notNull(),subject:(0,s.text)("subject"),fromParsed:(0,s.text)("from_parsed"),toParsed:(0,s.text)("to_parsed"),ccParsed:(0,s.text)("cc_parsed"),bccParsed:(0,s.text)("bcc_parsed"),replyToParsed:(0,s.text)("reply_to_parsed"),textBody:(0,s.text)("text_body"),htmlBody:(0,s.text)("html_body"),rawEmailContent:(0,s.text)("raw_email_content"),inReplyTo:(0,r.varchar)("in_reply_to",{length:255}),references:(0,s.text)("references"),priority:(0,r.varchar)("priority",{length:50}),attachments:(0,s.text)("attachments"),headers:(0,s.text)("headers"),emailDate:(0,a.timestamp)("email_date"),receivedAt:(0,a.timestamp)("received_at").notNull(),processedAt:(0,a.timestamp)("processed_at"),status:(0,r.varchar)("status",{length:50}).notNull(),isRead:(0,l.boolean)("is_read").default(!1),readAt:(0,a.timestamp)("read_at"),metadata:(0,s.text)("metadata"),userId:(0,r.varchar)("user_id",{length:255}).notNull(),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),p=(0,n.pgTable)("parsed_emails",{id:(0,r.varchar)("id",{length:255}).primaryKey(),emailId:(0,r.varchar)("email_id",{length:255}).notNull(),messageId:(0,r.varchar)("message_id",{length:255}),fromText:(0,s.text)("from_text"),fromAddress:(0,r.varchar)("from_address",{length:255}),fromName:(0,r.varchar)("from_name",{length:255}),toText:(0,s.text)("to_text"),toAddresses:(0,s.text)("to_addresses"),ccText:(0,s.text)("cc_text"),ccAddresses:(0,s.text)("cc_addresses"),bccText:(0,s.text)("bcc_text"),bccAddresses:(0,s.text)("bcc_addresses"),replyToText:(0,s.text)("reply_to_text"),replyToAddresses:(0,s.text)("reply_to_addresses"),subject:(0,s.text)("subject"),textBody:(0,s.text)("text_body"),htmlBody:(0,s.text)("html_body"),inReplyTo:(0,r.varchar)("in_reply_to",{length:255}),references:(0,s.text)("references"),priority:(0,r.varchar)("priority",{length:50}),emailDate:(0,a.timestamp)("email_date"),attachments:(0,s.text)("attachments"),attachmentCount:(0,o.integer)("attachment_count").default(0),hasAttachments:(0,l.boolean)("has_attachments").default(!1),headers:(0,s.text)("headers"),hasTextBody:(0,l.boolean)("has_text_body").default(!1),hasHtmlBody:(0,l.boolean)("has_html_body").default(!1),parseSuccess:(0,l.boolean)("parse_success").default(!0),parseError:(0,s.text)("parse_error"),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),f=(0,n.pgTable)("structured_emails",{id:(0,r.varchar)("id",{length:255}).primaryKey(),emailId:(0,r.varchar)("email_id",{length:255}).notNull(),sesEventId:(0,r.varchar)("ses_event_id",{length:255}).notNull(),messageId:(0,r.varchar)("message_id",{length:255}),date:(0,a.timestamp)("date"),subject:(0,s.text)("subject"),fromData:(0,s.text)("from_data"),toData:(0,s.text)("to_data"),ccData:(0,s.text)("cc_data"),bccData:(0,s.text)("bcc_data"),replyToData:(0,s.text)("reply_to_data"),inReplyTo:(0,r.varchar)("in_reply_to",{length:255}),references:(0,s.text)("references"),textBody:(0,s.text)("text_body"),htmlBody:(0,s.text)("html_body"),rawContent:(0,s.text)("raw_content"),attachments:(0,s.text)("attachments"),headers:(0,s.text)("headers"),priority:(0,r.varchar)("priority",{length:50}),parseSuccess:(0,l.boolean)("parse_success").default(!0),parseError:(0,s.text)("parse_error"),isRead:(0,l.boolean)("is_read").default(!1),readAt:(0,a.timestamp)("read_at"),isArchived:(0,l.boolean)("is_archived").default(!1),archivedAt:(0,a.timestamp)("archived_at"),userId:(0,r.varchar)("user_id",{length:255}).notNull(),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),y=(0,n.pgTable)("webhook_deliveries",{id:(0,r.varchar)("id",{length:255}).primaryKey(),emailId:(0,r.varchar)("email_id",{length:255}),webhookId:(0,r.varchar)("webhook_id",{length:255}).notNull(),endpoint:(0,r.varchar)("endpoint",{length:500}).notNull(),payload:(0,s.text)("payload"),status:(0,r.varchar)("status",{length:50}).notNull(),attempts:(0,o.integer)("attempts").default(0),lastAttemptAt:(0,a.timestamp)("last_attempt_at"),responseCode:(0,o.integer)("response_code"),responseBody:(0,s.text)("response_body"),error:(0,s.text)("error"),deliveryTime:(0,o.integer)("delivery_time"),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),v=(0,n.pgTable)("domain_dns_records",{id:(0,r.varchar)("id",{length:255}).primaryKey(),domainId:(0,r.varchar)("domain_id",{length:255}).notNull(),recordType:(0,r.varchar)("record_type",{length:10}).notNull(),name:(0,r.varchar)("name",{length:255}).notNull(),value:(0,s.text)("value").notNull(),isRequired:(0,l.boolean)("is_required").default(!0),isVerified:(0,l.boolean)("is_verified").default(!1),lastChecked:(0,a.timestamp)("last_checked"),createdAt:(0,a.timestamp)("created_at").defaultNow()}),x=(0,n.pgTable)("endpoints",{id:(0,r.varchar)("id",{length:255}).primaryKey(),name:(0,r.varchar)("name",{length:255}).notNull(),type:(0,r.varchar)("type",{length:50}).notNull(),webhookFormat:(0,r.varchar)("webhook_format",{length:50}).default("inbound"),config:(0,s.text)("config").notNull(),isActive:(0,l.boolean)("is_active").default(!0),description:(0,s.text)("description"),userId:(0,r.varchar)("user_id",{length:255}).notNull(),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),b=(0,n.pgTable)("email_groups",{id:(0,r.varchar)("id",{length:255}).primaryKey(),endpointId:(0,r.varchar)("endpoint_id",{length:255}).notNull(),emailAddress:(0,r.varchar)("email_address",{length:255}).notNull(),createdAt:(0,a.timestamp)("created_at").defaultNow()}),N=(0,n.pgTable)("endpoint_deliveries",{id:(0,r.varchar)("id",{length:255}).primaryKey(),emailId:(0,r.varchar)("email_id",{length:255}),endpointId:(0,r.varchar)("endpoint_id",{length:255}).notNull(),deliveryType:(0,r.varchar)("delivery_type",{length:50}).notNull(),status:(0,r.varchar)("status",{length:50}).notNull(),attempts:(0,o.integer)("attempts").default(0),lastAttemptAt:(0,a.timestamp)("last_attempt_at"),responseData:(0,s.text)("response_data"),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),P=(0,n.pgTable)("blocked_emails",{id:(0,r.varchar)("id",{length:255}).primaryKey(),emailAddress:(0,r.varchar)("email_address",{length:255}).notNull().unique(),domainId:(0,r.varchar)("domain_id",{length:255}).notNull(),reason:(0,s.text)("reason"),blockedBy:(0,r.varchar)("blocked_by",{length:255}).notNull(),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),C=(0,n.pgTable)("sent_emails",{id:(0,r.varchar)("id",{length:255}).primaryKey(),from:(0,r.varchar)("from",{length:500}).notNull(),fromAddress:(0,r.varchar)("from_address",{length:255}).notNull(),fromDomain:(0,r.varchar)("from_domain",{length:255}).notNull(),to:(0,s.text)("to").notNull(),cc:(0,s.text)("cc"),bcc:(0,s.text)("bcc"),replyTo:(0,s.text)("reply_to"),subject:(0,s.text)("subject").notNull(),textBody:(0,s.text)("text_body"),htmlBody:(0,s.text)("html_body"),headers:(0,s.text)("headers"),attachments:(0,s.text)("attachments"),status:(0,r.varchar)("status",{length:50}).notNull().default("pending"),messageId:(0,r.varchar)("message_id",{length:255}),provider:(0,r.varchar)("provider",{length:50}).default("ses"),providerResponse:(0,s.text)("provider_response"),sentAt:(0,a.timestamp)("sent_at"),failureReason:(0,s.text)("failure_reason"),idempotencyKey:(0,r.varchar)("idempotency_key",{length:256}),userId:(0,r.varchar)("user_id",{length:255}).notNull(),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),_={PENDING:"pending",VERIFIED:"verified",FAILED:"failed"},w={PENDING:"Pending",SUCCESS:"Success",FAILED:"Failed"},S={HIGH:"high",MEDIUM:"medium",LOW:"low"},T={RECEIVED:"received",PROCESSING:"processing",FORWARDED:"forwarded",FAILED:"failed",BLOCKED:"blocked"},j={PENDING:"pending",SUCCESS:"success",FAILED:"failed"},B={WEBHOOK:"webhook",EMAIL:"email",EMAIL_GROUP:"email_group"},D={INBOUND:"inbound",DISCORD:"discord",SLACK:"slack"},A={WEBHOOK:"webhook",EMAIL:"email",EMAILGROUP:"emailgroup"},I=(0,n.pgTable)("vip_configs",{id:(0,r.varchar)("id",{length:255}).primaryKey(),emailAddressId:(0,r.varchar)("email_address_id",{length:255}).notNull().unique(),userId:(0,r.varchar)("user_id",{length:255}).notNull(),priceInCents:(0,o.integer)("price_in_cents").notNull().default(100),allowAfterPayment:(0,l.boolean)("allow_after_payment").default(!1),customMessage:(0,s.text)("custom_message"),paymentLinkExpirationHours:(0,o.integer)("payment_link_expiration_hours").default(24),isActive:(0,l.boolean)("is_active").default(!0),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),E=(0,n.pgTable)("vip_payment_sessions",{id:(0,r.varchar)("id",{length:255}).primaryKey(),vipConfigId:(0,r.varchar)("vip_config_id",{length:255}).notNull(),senderEmail:(0,r.varchar)("sender_email",{length:255}).notNull(),originalEmailId:(0,r.varchar)("original_email_id",{length:255}).notNull(),stripePaymentLinkId:(0,r.varchar)("stripe_payment_link_id",{length:255}),stripePaymentLinkUrl:(0,s.text)("stripe_payment_link_url"),stripeSessionId:(0,r.varchar)("stripe_session_id",{length:255}),status:(0,r.varchar)("status",{length:50}).notNull().default("pending"),paidAt:(0,a.timestamp)("paid_at"),expiresAt:(0,a.timestamp)("expires_at"),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),K=(0,n.pgTable)("vip_allowed_senders",{id:(0,r.varchar)("id",{length:255}).primaryKey(),vipConfigId:(0,r.varchar)("vip_config_id",{length:255}).notNull(),senderEmail:(0,r.varchar)("sender_email",{length:255}).notNull(),allowedAt:(0,a.timestamp)("allowed_at").defaultNow(),allowedUntil:(0,a.timestamp)("allowed_until"),paymentSessionId:(0,r.varchar)("payment_session_id",{length:255}),createdAt:(0,a.timestamp)("created_at").defaultNow()}),V=(0,n.pgTable)("vip_email_attempts",{id:(0,r.varchar)("id",{length:255}).primaryKey(),vipConfigId:(0,r.varchar)("vip_config_id",{length:255}).notNull(),senderEmail:(0,r.varchar)("sender_email",{length:255}).notNull(),recipientEmail:(0,r.varchar)("recipient_email",{length:255}).notNull(),originalEmailId:(0,r.varchar)("original_email_id",{length:255}).notNull(),emailSubject:(0,s.text)("email_subject"),status:(0,r.varchar)("status",{length:50}).notNull().default("payment_required"),paymentSessionId:(0,r.varchar)("payment_session_id",{length:255}),allowedReason:(0,r.varchar)("allowed_reason",{length:100}),createdAt:(0,a.timestamp)("created_at").defaultNow(),updatedAt:(0,a.timestamp)("updated_at").defaultNow()}),k={PENDING:"pending",PAID:"paid",EXPIRED:"expired",CANCELLED:"cancelled"},F={PENDING:"pending",SUCCESS:"success",FAILED:"failed"},L={PENDING:"pending",SENT:"sent",FAILED:"failed"}}},953687:e=>{"use strict";var{g:t,__dirname:i}=e;e.s({}),e.i(644452),e.i(471364)},612666:e=>{"use strict";var{g:t,__dirname:i}=e;{e.s({__iconNode:()=>t,default:()=>i});var n=e.i(722486);let t=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],i=(0,n.default)("triangle-alert",t)}},437566:e=>{"use strict";var{g:t,__dirname:i}=e;e.s({AlertTriangle:()=>n.default});var n=e.i(612666)},870684:e=>{"use strict";var{g:t,__dirname:i}=e;e.s({DeleteConfirmationDialog:()=>l});var n=e.i(731636),r=e.i(611206),s=e.i(834953),a=e.i(437566);function l({open:e,onOpenChange:t,onConfirm:i,title:l,description:o,itemName:d,itemType:u="item",isLoading:c=!1}){let m=l||`Delete ${u}`,g=o||`Are you sure you want to delete ${d?`"${d}"`:`this ${u}`}? This action cannot be undone.`;return(0,n.jsx)(r.Dialog,{open:e,onOpenChange:t,children:(0,n.jsxs)(r.DialogContent,{className:"sm:max-w-md",children:[(0,n.jsxs)(r.DialogHeader,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-destructive/10",children:(0,n.jsx)(a.AlertTriangle,{className:"h-5 w-5 text-destructive"})}),(0,n.jsx)(r.DialogTitle,{className:"text-left",children:m})]}),(0,n.jsx)(r.DialogDescription,{className:"text-left mt-2",children:g})]}),(0,n.jsxs)(r.DialogFooter,{className:"flex items-center gap-2 sm:gap-2",children:[(0,n.jsx)(s.Button,{variant:"secondary",onClick:()=>t(!1),disabled:c,children:"Cancel"}),(0,n.jsx)(s.Button,{variant:"destructive",onClick:()=>{i()},disabled:c,children:c?"Deleting...":"Delete"})]})]})})}},593853:e=>{"use strict";var{g:t,__dirname:i}=e;e.s({default:()=>q});var n=e.i(731636),r=e.i(838653),s=e.i(395372),a=e.i(555366),l=e.i(186240),o=e.i(921361),d=e.i(210339),u=e.i(834953),c=e.i(330790),m=e.i(268628),g=e.i(401575),h=e.i(891083),p=e.i(611206),f=e.i(799544),y=e.i(862421),v=e.i(221917),x=e.i(896842),b=e.i(976760),N=e.i(773930),P=e.i(397682),C=e.i(602833),_=e.i(561657),w=e.i(379225),S=e.i(451081),T=e.i(242148),j=e.i(274260),B=e.i(622808),D=e.i(280783),A=e.i(135673),I=e.i(55496);e.i(953687);var E=e.i(471364),K=e.i(974294),V=e.i(984607),k=e.i(870684),F=e.i(645643),L=e.i(628662);e.i(486973);var z=e.i(994579),O=e.i(231843);function q(){let{data:e}=(0,s.useSession)(),t=(0,a.useParams)(),i=(0,a.useRouter)(),q=t.id,$=(0,L.useQueryClient)(),{data:Q,isLoading:U,error:R,refetch:M}=(0,O.useDomainDetailsV2Query)(q),{data:G,isLoading:W,refetch:H}=(0,F.useQuery)({queryKey:[...O.domainV2Keys.emailAddresses(q)],queryFn:async()=>{let e=await fetch(`/api/v2/email-addresses?domainId=${q}`);if(!e.ok)throw Error((await e.json()).error||"Failed to fetch email addresses");return e.json()},enabled:!!q&&Q?.status==="verified",staleTime:12e4,gcTime:6e5}),{data:J,isLoading:Y}=(0,F.useQuery)({queryKey:["dnsRecords",q],queryFn:async()=>{let e=await fetch(`/api/v2/domains/${q}/dns-records`);if(!e.ok)throw Error((await e.json()).error||"Failed to fetch DNS records");return e.json()},enabled:!!q&&Q?.status==="pending",staleTime:12e4,gcTime:6e5}),{data:X=[],isLoading:Z}=(0,z.useEndpointsQuery)();(0,O.useDomainVerificationCheckV2)(q);let ee=(0,O.useDeleteDomainV2Mutation)(),et=(0,O.useAddEmailAddressV2Mutation)(),ei=(0,O.useDeleteEmailAddressV2Mutation)(),en=(0,O.useUpdateEmailEndpointV2Mutation)(),er=(0,O.useUpdateDomainCatchAllV2Mutation)(),[es,ea]=(0,r.useState)(""),[el,eo]=(0,r.useState)("none"),[ed,eu]=(0,r.useState)(null),[ec,em]=(0,r.useState)(!1),[eg,eh]=(0,r.useState)(new Set),[ep,ef]=(0,r.useState)(!1),[ey,ev]=(0,r.useState)(!1),[ex,eb]=(0,r.useState)(""),[eN,eP]=(0,r.useState)(!1),[eC,e_]=(0,r.useState)(!1),[ew,eS]=(0,r.useState)(null),[eT,ej]=(0,r.useState)("none"),[eB,eD]=(0,r.useState)("none"),[eA,eI]=(0,r.useState)(null);(0,r.useState)(()=>{Q?.catchAllEndpointId&&eD(Q.catchAllEndpointId)});let eE=G?.data||[],eK=e=>{let t=new Set(eg);t.has(e)?t.delete(e):t.add(e),eh(t)},eV=async()=>{if(Q?.domain)try{await navigator.clipboard.writeText(Q.domain),eP(!0),I.toast.success("Domain copied to clipboard"),setTimeout(()=>{eP(!1)},2e3)}catch(e){I.toast.error("Failed to copy domain")}},ek=async()=>{console.log(" Forcing domain verification check..."),em(!0);try{let e=await fetch(`/api/v2/domains/${q}?check=true`);if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to check domain verification")}let t=await e.json();if($.setQueryData(O.domainV2Keys.detail(q),t),Q?.status==="pending"&&"verified"===t.status)I.toast.success("Domain verified successfully!"),await H();else if("verified"===t.status)I.toast.success("Domain is already verified");else if("failed"===t.status)I.toast.error("Domain verification failed. Please check your DNS records.");else if(t.verificationCheck){let{dnsRecords:e,sesStatus:i}=t.verificationCheck,n=e?.filter(e=>!e.isVerified)||[];if(n.length>0){let e=n.find(e=>"MX"===e.type);if(e&&e.error){let t=e.value,i=e.error.match(/but found: \[(.*?)\]/)?.[1];i&&i.includes(`.${Q?.domain||""}`)?I.toast.error(`MX record issue: Remove ".${Q?.domain||""}" from the end of your MX record value. It should be just "${t.split(" ")[1]}"`,{duration:8e3}):I.toast.warning(`${n.length} DNS record(s) still pending verification`)}else{let e=n.map(e=>e.type).join(", ");I.toast.warning(`DNS records not verified: ${e}`)}}else"Success"!==i?I.toast.info(`DNS records verified. Email status: ${i}`):I.toast.info("Verification in progress...")}else I.toast.info("Verification status refreshed")}catch(e){console.error("Error refreshing verification:",e),I.toast.error("Failed to refresh verification status")}finally{em(!1)}},eF=async()=>{if(Q&&es.trim()){eu(null);try{let e=es.includes("@")?es:`${es}@${Q.domain}`;await et.mutateAsync({address:e,domainId:q,endpointId:"none"===el?void 0:el}),ea(""),eo("none"),I.toast.success("Email address added successfully")}catch(t){let e=t instanceof Error?t.message:"Failed to add email address";eu(e),I.toast.error(e)}}},eL=(e,t)=>{eI({id:e,address:t})},ez=async()=>{if(eA&&Q)try{await ei.mutateAsync({emailAddressId:eA.id,domainId:q}),eI(null)}catch(e){I.toast.error(e instanceof Error?e.message:"Failed to delete email address")}},eO=async()=>{if(Q&&0!==eg.size)try{let e=Array.from(eg).map(e=>ei.mutateAsync({emailAddressId:e,domainId:q}));await Promise.all(e),I.toast.success(`Successfully deleted ${eg.size} email address${eg.size>1?"es":""}`),eh(new Set),ef(!1)}catch(e){I.toast.error(e instanceof Error?e.message:"Failed to delete some email addresses")}},eq=async()=>{if(Q){if(ex!==Q.domain)return void I.toast.error("Please type the domain name exactly to confirm deletion");try{await ee.mutateAsync(q),I.toast.success("Domain deleted successfully"),ev(!1),i.push("/emails")}catch(e){I.toast.error(e instanceof Error?e.message:"Failed to delete domain")}}},e$=async()=>{if(ew){console.log(" Updating email endpoint:",{emailId:ew.id,currentEndpointId:ew.endpointId,newEndpointId:"none"===eT?null:eT,domainId:q});try{let e=await en.mutateAsync({emailAddressId:ew.id,endpointId:"none"===eT?null:eT,domainId:q});console.log(" Update result:",e),I.toast.success("Endpoint updated successfully"),e_(!1),eS(null),ej("none"),await H()}catch(e){console.error(" Update failed:",e),I.toast.error(e instanceof Error?e.message:"Failed to update endpoint")}}},eQ=e=>{eS(e),ej(e.endpointId||e.webhookId||"none"),e_(!0)},eU=async()=>{if(Q)try{if(Q.isCatchAllEnabled)await er.mutateAsync({domainId:q,isCatchAllEnabled:!1,catchAllEndpointId:null}),I.toast.success("Catch-all disabled successfully");else{if("none"===eB)return void I.toast.error("Please select an endpoint for catch-all emails");await er.mutateAsync({domainId:q,isCatchAllEnabled:!0,catchAllEndpointId:eB}),I.toast.success("Catch-all enabled successfully")}}catch(e){I.toast.error(e instanceof Error?e.message:"Failed to toggle catch-all")}};if(U)return(0,n.jsxs)("div",{className:"flex flex-1 flex-col gap-6 p-6",children:[(0,n.jsx)("div",{className:"flex items-center gap-4",children:(0,n.jsx)("div",{className:"h-4 w-24 bg-muted animate-pulse rounded"})}),(0,n.jsx)("div",{className:"h-32 bg-muted animate-pulse rounded-lg"}),(0,n.jsx)("div",{className:"h-64 bg-muted animate-pulse rounded-lg"})]});if(R||!Q)return(0,n.jsxs)("div",{className:"flex flex-1 flex-col gap-6 p-6",children:[(0,n.jsx)("div",{className:"flex items-center gap-4",children:(0,n.jsx)(l.default,{href:"/emails",children:(0,n.jsxs)(u.Button,{variant:"ghost",size:"sm",children:[(0,n.jsx)(y.default,{width:"16",height:"16",className:"mr-2"}),"Back to Domains"]})})}),(0,n.jsx)(o.Card,{className:"border-destructive/50 bg-destructive/10",children:(0,n.jsx)(o.CardContent,{className:"pt-6",children:(0,n.jsxs)("div",{className:"flex items-center gap-2 text-destructive",children:[(0,n.jsx)(B.default,{width:"16",height:"16"}),(0,n.jsx)("span",{children:R instanceof Error?R.message:"Domain not found"}),(0,n.jsx)(u.Button,{variant:"ghost",size:"sm",onClick:()=>M(),className:"ml-auto text-destructive hover:text-destructive",children:"Try Again"})]})})})]});let{domain:eR,status:eM,stats:eG={totalEmailAddresses:0,activeEmailAddresses:0,emailsLast24h:0,emailsLast7d:0,emailsLast30d:0}}=Q,eW=e=>{switch(e?.type){case"webhook":return D.default;case"email":default:return S.default;case"email_group":return A.default}},eH=e=>{if(!e?.isActive)return"#64748b";switch(e?.type){case"webhook":return"#8b5cf6";case"email":return"#3b82f6";case"email_group":return"#10b981";default:return"#6b7280"}},eJ=eM===E.DOMAIN_STATUS.VERIFIED,eY=eE.filter(e=>eg.has(e.id));return(0,n.jsx)("div",{className:"h-full p-4 font-outfit",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto space-y-4",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsxs)(l.default,{href:"/emails",className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground",children:[(0,n.jsx)(y.default,{width:"16",height:"16"}),"Back to Domains"]})}),(0,n.jsxs)("div",{className:"flex items-center justify-between bg-card text-card-foreground rounded-lg p-4 border border-border",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(C.CustomInboundIcon,{Icon:w.default,size:40,backgroundColor:"#3b82f6"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-xl font-semibold mb-1",children:eR}),(0,n.jsxs)("div",{className:"text-sm text-muted-foreground",children:[eM===E.DOMAIN_STATUS.PENDING&&"Add DNS records to complete verification",eM===E.DOMAIN_STATUS.VERIFIED&&"Domain verified - manage email addresses below",eM===E.DOMAIN_STATUS.FAILED&&"Domain verification failed - please check your DNS records"]})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[eM===E.DOMAIN_STATUS.VERIFIED?(0,n.jsxs)(d.Badge,{className:"bg-emerald-500 text-white rounded-full px-2.5 py-0.5 text-xs font-medium shadow-sm pointer-events-none",children:[(0,n.jsx)(_.default,{width:"12",height:"12",className:"mr-1"}),"Verified"]}):eM===E.DOMAIN_STATUS.PENDING?(0,n.jsxs)(d.Badge,{className:"bg-amber-500 text-white rounded-full px-2.5 py-0.5 text-xs font-medium shadow-sm pointer-events-none",children:[(0,n.jsx)(f.default,{width:"12",height:"12",className:"mr-1"}),"Pending"]}):(0,n.jsxs)(d.Badge,{className:"bg-red-500 text-white rounded-full px-2.5 py-0.5 text-xs font-medium shadow-sm pointer-events-none",children:[(0,n.jsx)(B.default,{width:"12",height:"12",className:"mr-1"}),"Failed"]}),(0,n.jsxs)(u.Button,{variant:"secondary",size:"sm",onClick:ek,disabled:ec,className:"flex items-center gap-2",children:[(0,n.jsx)(j.default,{width:"16",height:"16",className:ec?"animate-spin":""}),ec?"Checking...":"Refresh"]}),(0,n.jsxs)(p.Dialog,{open:ey,onOpenChange:ev,children:[(0,n.jsxs)(u.Button,{variant:"destructive",size:"sm",onClick:()=>ev(!0),children:[(0,n.jsx)(b.default,{width:"16",height:"16",className:"mr-2"}),"Delete"]}),(0,n.jsxs)(p.DialogContent,{children:[(0,n.jsxs)(p.DialogHeader,{children:[(0,n.jsx)(p.DialogTitle,{children:"Delete Domain"}),(0,n.jsxs)(p.DialogDescription,{children:['This action cannot be undone. This will permanently delete the domain "',eR,'" and all associated email addresses and data.']})]}),(0,n.jsx)("div",{className:"space-y-4",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)(m.Label,{htmlFor:"delete-confirm",children:["Type ",(0,n.jsxs)("strong",{className:"cursor-pointer hover:bg-muted px-1 py-0.5 rounded transition-colors inline-flex items-center gap-1 p-1 bg-muted",onClick:eV,children:[eR," ",eN?(0,n.jsx)(_.default,{width:"16",height:"16",className:"text-green-600"}):(0,n.jsx)(x.default,{width:"16",height:"16"})]})," to confirm deletion:"]}),(0,n.jsx)(c.Input,{id:"delete-confirm",value:ex,onChange:e=>eb(e.target.value),placeholder:eR,className:"mt-2"})]})}),(0,n.jsxs)(p.DialogFooter,{children:[(0,n.jsx)(u.Button,{variant:"secondary",onClick:()=>{ev(!1),eb("")},children:"Cancel"}),(0,n.jsx)(u.Button,{variant:"destructive",onClick:eq,disabled:ex!==eR,children:"Delete Domain"})]})]})]})]})]}),eM===E.DOMAIN_STATUS.PENDING&&(0,n.jsx)(V.default,{preloadedDomain:eR,preloadedDomainId:Q.id,preloadedDnsRecords:J?.records?.map(e=>({type:e.recordType,name:e.name,value:e.value,isVerified:e.isVerified}))||[],preloadedStep:1,preloadedProvider:Q.domainProvider||void 0,overrideRefreshFunction:ek,onSuccess:e=>{M()}}),eJ&&(0,n.jsxs)(o.Card,{className:"bg-card border-border rounded-xl",children:[(0,n.jsx)(o.CardHeader,{className:"pb-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(o.CardTitle,{className:"flex items-center gap-2 text-foreground text-lg",children:"Email Management"}),(0,n.jsx)(o.CardDescription,{className:"text-muted-foreground",children:Q?.isCatchAllEnabled?`Catch-all enabled - all emails to @${eR} are captured`:`Manage individual email addresses for @${eR}`})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,n.jsx)(S.default,{width:"16",height:"16"}),eG.totalEmailAddresses," addresses",(0,n.jsx)("span",{className:"text-muted-foreground/60",children:""}),(0,n.jsx)(v.default,{width:"16",height:"16"}),eG.emailsLast24h," emails (24h)"]})]})}),(0,n.jsxs)(o.CardContent,{className:"space-y-4",children:[!Q?.isCatchAllEnabled&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 w-full",children:[(0,n.jsx)("div",{className:"w-full sm:flex-1",children:(0,n.jsxs)("div",{className:"flex items-center border border-input rounded-xl bg-background h-10 w-full",children:[(0,n.jsx)(c.Input,{type:"text",placeholder:"username",value:es,onChange:e=>ea(e.target.value),onKeyDown:e=>{"Enter"===e.key&&es.trim()&&eF()},className:"border-0 rounded-r-none focus:ring-0 flex-1 h-full"}),(0,n.jsxs)("div",{className:"px-3 bg-muted border-l border-border text-sm text-muted-foreground rounded-r-lg flex items-center h-full whitespace-nowrap",children:["@",eR]})]})}),(0,n.jsxs)("div",{className:"flex gap-2 w-full sm:flex-1",children:[(0,n.jsxs)(K.Select,{value:el,onValueChange:e=>{"create-new"===e?i.push("/endpoints"):eo(e)},disabled:Z,children:[(0,n.jsx)(K.SelectTrigger,{className:"flex-1 h-10 min-w-0",children:(0,n.jsx)(K.SelectValue,{placeholder:"Endpoint (optional)"})}),(0,n.jsxs)(K.SelectContent,{children:[(0,n.jsx)(K.SelectItem,{value:"none",children:"Store in Inbound"}),(0,n.jsx)(K.SelectItem,{value:"create-new",className:"text-blue-600 font-medium",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(T.default,{width:"16",height:"16"}),"Create Endpoint"]})}),X.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"px-2 py-1 text-xs font-medium text-muted-foreground border-t",children:"Endpoints"}),X.map(e=>(0,n.jsx)(K.SelectItem,{value:e.id,children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(C.CustomInboundIcon,{Icon:eW(e),size:16,backgroundColor:eH(e)}),e.name," (",e.type,")"]})},e.id))]})]})]}),(0,n.jsx)(u.Button,{onClick:eF,disabled:!es.trim(),className:"shrink-0 h-10 w-10",children:(0,n.jsx)(T.default,{width:"16",height:"16"})})]})]}),ed&&(0,n.jsx)("p",{className:"text-sm text-red-600",children:ed}),(0,n.jsx)(h.Separator,{}),0===eE.length?(0,n.jsxs)("div",{className:"text-center py-8",children:[(0,n.jsx)(S.default,{width:"32",height:"32",className:"text-muted-foreground mx-auto mb-2"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"No email addresses configured"})]}):(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg border border-border",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(g.Checkbox,{checked:eE.length>0&&eg.size===eE.length,onCheckedChange:()=>{0!==eE.length&&(eg.size===eE.length?eh(new Set):eh(new Set(eE.map(e=>e.id))))},className:"h-4 w-4"}),(0,n.jsxs)("span",{className:"text-sm font-medium text-foreground",children:["Select all (",eE.length,")",eg.size>0&&(0,n.jsxs)("span",{className:"text-blue-600 ml-2",children:[" ",eg.size," selected"]})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[eg.size>0&&(0,n.jsx)(u.Button,{variant:"ghost",size:"sm",onClick:()=>{eh(new Set)},className:"text-muted-foreground hover:text-foreground h-8 px-3",children:"Clear"}),(0,n.jsxs)(u.Button,{variant:"destructive",size:"sm",onClick:()=>ef(!0),disabled:0===eg.size,className:"h-8",children:[(0,n.jsx)(b.default,{width:"16",height:"16",className:"mr-2"}),"Delete Selected"]})]})]}),eE.map(e=>(0,n.jsxs)("div",{className:`flex items-center justify-between p-3 rounded-lg border border-border transition-colors ${eg.has(e.id)?"bg-accent/50 border-accent":"bg-muted/30 border-border"}`,children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(g.Checkbox,{checked:eg.has(e.id),onCheckedChange:()=>eK(e.id),className:"h-4 w-4"}),(0,n.jsx)("div",{className:"font-mono text-sm",children:e.address}),(0,n.jsx)(u.Button,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(e.address),I.toast.success("Copied to clipboard")},className:"h-6 w-6 p-0",children:(0,n.jsx)(x.default,{width:"12",height:"12"})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:(()=>{console.log(" Routing:",e.routing);let t=e.routing;if("endpoint"===t.type&&t.id){let e=X.find(e=>e.id===t.id);if(e){let i=eW(e);return(0,n.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,n.jsx)(C.CustomInboundIcon,{Icon:i,size:25,backgroundColor:eH(e)}),(0,n.jsx)("span",{className:"font-medium",style:{color:eH(e)},children:t.name})]})}}else if("webhook"===t.type&&t.id)return(0,n.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,n.jsx)(C.CustomInboundIcon,{Icon:D.default,size:14,backgroundColor:"#8b5cf6"}),(0,n.jsx)("span",{className:"text-amber-600 font-medium",children:t.name||"Legacy Webhook"})]});return(0,n.jsx)("span",{className:"text-muted-foreground",children:"Store in Inbound"})})()}),(0,n.jsx)(u.Button,{variant:"ghost",size:"sm",onClick:()=>eQ(e),className:"h-8 w-8 p-0",children:(0,n.jsx)(N.default,{width:"16",height:"16"})}),(0,n.jsx)(u.Button,{variant:"ghost",size:"sm",onClick:()=>eL(e.id,e.address),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:(0,n.jsx)(b.default,{width:"16",height:"16"})})]})]},e.id))]}),(0,n.jsx)("div",{className:"flex items-center justify-center pt-2",children:(0,n.jsxs)(l.default,{href:"/endpoints",className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700",children:[(0,n.jsx)(P.default,{width:"12",height:"12"}),"Manage all endpoints"]})})]}),Q&&(0,n.jsxs)(n.Fragment,{children:[!Q.isCatchAllEnabled&&(0,n.jsx)(h.Separator,{}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium text-foreground",children:"Catch-all Configuration"}),(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:Q.isCatchAllEnabled?"All emails to any address are captured":"Capture emails to any address on this domain"})]})}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[!Q.isCatchAllEnabled&&(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsxs)(K.Select,{value:eB,onValueChange:e=>{"create-new"===e?i.push("/endpoints"):eD(e)},disabled:Z,children:[(0,n.jsx)(K.SelectTrigger,{className:"w-full h-10",children:(0,n.jsx)(K.SelectValue,{placeholder:"Select endpoint"})}),(0,n.jsxs)(K.SelectContent,{children:[(0,n.jsx)(K.SelectItem,{value:"none",children:"Store in Inbound"}),(0,n.jsx)(K.SelectItem,{value:"create-new",className:"text-blue-600 font-medium",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(T.default,{width:"16",height:"16"}),"Create Endpoint"]})}),X.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"px-2 py-1 text-xs font-medium text-muted-foreground border-t",children:"Endpoints"}),X.map(e=>(0,n.jsx)(K.SelectItem,{value:e.id,children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(C.CustomInboundIcon,{Icon:eW(e),size:16,backgroundColor:eH(e)}),e.name," (",e.type,")"]})},e.id))]})]})]})}),(0,n.jsx)("div",{className:Q.isCatchAllEnabled?"w-full":"w-full sm:w-auto sm:min-w-[140px]",children:(0,n.jsx)(u.Button,{variant:Q.isCatchAllEnabled?"destructive":"secondary",className:"h-10 w-full",onClick:eU,disabled:!Q.isCatchAllEnabled&&"none"===eB,children:Q.isCatchAllEnabled?"Disable Catch-all":"Enable Catch-all"})})]})]})]})]})]}),(0,n.jsx)(p.Dialog,{open:eC,onOpenChange:e_,children:(0,n.jsxs)(p.DialogContent,{className:"sm:max-w-[425px]",children:[(0,n.jsxs)(p.DialogHeader,{children:[(0,n.jsx)(p.DialogTitle,{children:"Configure Endpoint"}),(0,n.jsxs)(p.DialogDescription,{children:["Configure endpoint for ",ew?.address]})]}),(0,n.jsx)("div",{className:"grid gap-4 py-4",children:(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)(m.Label,{htmlFor:"endpoint-assignment",children:"Endpoint Assignment"}),(0,n.jsxs)(K.Select,{value:eT,onValueChange:e=>{"create-new"===e?i.push("/endpoints"):ej(e)},disabled:Z,children:[(0,n.jsx)(K.SelectTrigger,{children:(0,n.jsx)(K.SelectValue,{placeholder:"Store in Inbound"})}),(0,n.jsxs)(K.SelectContent,{children:[(0,n.jsx)(K.SelectItem,{value:"none",children:"Store in Inbound"}),(0,n.jsx)(K.SelectItem,{value:"create-new",className:"text-blue-600 font-medium",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(T.default,{width:"16",height:"16"}),"Create New Endpoint"]})}),X.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"px-2 py-1 text-xs font-medium text-muted-foreground border-t",children:"Existing Endpoints"}),X.map(e=>(0,n.jsx)(K.SelectItem,{value:e.id,children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(C.CustomInboundIcon,{Icon:eW(e),size:16,backgroundColor:eH(e)}),(0,n.jsxs)("span",{children:[e.name," (",e.type,")"]})]})},e.id))]})]})]})]})}),(0,n.jsxs)(p.DialogFooter,{children:[(0,n.jsx)(u.Button,{variant:"secondary",onClick:()=>{e_(!1),eS(null),ej("none")},children:"Cancel"}),(0,n.jsx)(u.Button,{onClick:e$,children:"Update Endpoint"})]})]})}),(0,n.jsx)(p.Dialog,{open:ep,onOpenChange:ef,children:(0,n.jsxs)(p.DialogContent,{className:"sm:max-w-[425px]",children:[(0,n.jsxs)(p.DialogHeader,{children:[(0,n.jsx)(p.DialogTitle,{children:"Delete Email Addresses"}),(0,n.jsxs)(p.DialogDescription,{children:["Are you sure you want to delete ",eg.size," email address",eg.size>1?"es":"","? This action cannot be undone."]})]}),(0,n.jsx)("div",{className:"py-4",children:(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Email addresses to be deleted:"}),(0,n.jsx)("div",{className:"max-h-32 overflow-y-auto space-y-1",children:eY.map(e=>(0,n.jsx)("div",{className:"text-sm text-muted-foreground font-mono bg-muted px-2 py-1 rounded",children:e.address},e.id))})]})}),(0,n.jsxs)(p.DialogFooter,{children:[(0,n.jsx)(u.Button,{variant:"secondary",onClick:()=>ef(!1),children:"Cancel"}),(0,n.jsx)(u.Button,{variant:"destructive",onClick:eO,disabled:ei.isPending,children:ei.isPending?"Deleting...":`Delete ${eg.size} Address${eg.size>1?"es":""}`})]})]})}),(0,n.jsx)(k.DeleteConfirmationDialog,{open:!!eA,onOpenChange:e=>!e&&eI(null),onConfirm:ez,title:"Delete Email Address",itemName:eA?.address,itemType:"email address",isLoading:ei.isPending})]})})}}}]);

//# sourceMappingURL=04723bece42c8b11.js.map