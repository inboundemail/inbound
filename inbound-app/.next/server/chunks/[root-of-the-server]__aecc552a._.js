module.exports={929549:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},983943:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},86103:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},945935:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},348629:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("@opentelemetry/api",()=>require("@opentelemetry/api"))},76569:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("node:events",()=>require("node:events"))},804713:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("util",()=>require("util"))},87485:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("child_process",()=>require("child_process"))},420467:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("events",()=>require("events"))},936121:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("node:util",()=>require("node:util"))},681635:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("node:http",()=>require("node:http"))},866098:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("node:https",()=>require("node:https"))},580767:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("node:buffer",()=>require("node:buffer"))},329295:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("crypto",()=>require("crypto"))},62445:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("http",()=>require("http"))},348388:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("https",()=>require("https"))},591032:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("node:crypto",()=>require("node:crypto"))},909834:e=>{"use strict";var{g:r,__dirname:t}=e;e.s({DELIVERY_STATUS:()=>i.DELIVERY_STATUS,DELIVERY_TYPES:()=>i.DELIVERY_TYPES,DOMAIN_STATUS:()=>i.DOMAIN_STATUS,EMAIL_STATUS:()=>i.EMAIL_STATUS,ENDPOINT_TYPES:()=>i.ENDPOINT_TYPES,PROVIDER_CONFIDENCE:()=>i.PROVIDER_CONFIDENCE,SENT_EMAIL_STATUS:()=>i.SENT_EMAIL_STATUS,SES_VERIFICATION_STATUS:()=>i.SES_VERIFICATION_STATUS,VIP_PAYMENT_STATUS:()=>i.VIP_PAYMENT_STATUS,WEBHOOK_FORMATS:()=>i.WEBHOOK_FORMATS,WEBHOOK_STATUS:()=>i.WEBHOOK_STATUS,account:()=>a.account,apikey:()=>a.apikey,blockedEmails:()=>i.blockedEmails,domainDnsRecords:()=>i.domainDnsRecords,emailAddresses:()=>i.emailAddresses,emailDomains:()=>i.emailDomains,emailGroups:()=>i.emailGroups,endpointDeliveries:()=>i.endpointDeliveries,endpoints:()=>i.endpoints,parsedEmails:()=>i.parsedEmails,receivedEmails:()=>i.receivedEmails,sentEmails:()=>i.sentEmails,sesEvents:()=>i.sesEvents,session:()=>a.session,structuredEmails:()=>i.structuredEmails,subscriptions:()=>i.subscriptions,user:()=>a.user,userAccounts:()=>i.userAccounts,userOnboarding:()=>i.userOnboarding,verification:()=>a.verification,vipAllowedSenders:()=>i.vipAllowedSenders,vipConfigs:()=>i.vipConfigs,vipEmailAttempts:()=>i.vipEmailAttempts,vipPaymentSessions:()=>i.vipPaymentSessions,webhookDeliveries:()=>i.webhookDeliveries,webhooks:()=>i.webhooks});var a=e.i(594120),i=e.i(55379)},436754:e=>{"use strict";var{g:r,__dirname:t}=e;e.s({DELIVERY_STATUS:()=>a.DELIVERY_STATUS,DELIVERY_TYPES:()=>a.DELIVERY_TYPES,DOMAIN_STATUS:()=>a.DOMAIN_STATUS,EMAIL_STATUS:()=>a.EMAIL_STATUS,ENDPOINT_TYPES:()=>a.ENDPOINT_TYPES,PROVIDER_CONFIDENCE:()=>a.PROVIDER_CONFIDENCE,SENT_EMAIL_STATUS:()=>a.SENT_EMAIL_STATUS,SES_VERIFICATION_STATUS:()=>a.SES_VERIFICATION_STATUS,VIP_PAYMENT_STATUS:()=>a.VIP_PAYMENT_STATUS,WEBHOOK_FORMATS:()=>a.WEBHOOK_FORMATS,WEBHOOK_STATUS:()=>a.WEBHOOK_STATUS,account:()=>a.account,apikey:()=>a.apikey,blockedEmails:()=>a.blockedEmails,domainDnsRecords:()=>a.domainDnsRecords,emailAddresses:()=>a.emailAddresses,emailDomains:()=>a.emailDomains,emailGroups:()=>a.emailGroups,endpointDeliveries:()=>a.endpointDeliveries,endpoints:()=>a.endpoints,parsedEmails:()=>a.parsedEmails,receivedEmails:()=>a.receivedEmails,sentEmails:()=>a.sentEmails,sesEvents:()=>a.sesEvents,session:()=>a.session,structuredEmails:()=>a.structuredEmails,subscriptions:()=>a.subscriptions,user:()=>a.user,userAccounts:()=>a.userAccounts,userOnboarding:()=>a.userOnboarding,verification:()=>a.verification,vipAllowedSenders:()=>a.vipAllowedSenders,vipConfigs:()=>a.vipConfigs,vipEmailAttempts:()=>a.vipEmailAttempts,vipPaymentSessions:()=>a.vipPaymentSessions,webhookDeliveries:()=>a.webhookDeliveries,webhooks:()=>a.webhooks}),e.i(468686);var a=e.i(909834)},906273:e=>{"use strict";var{g:r,__dirname:t}=e;e.s({areAllDnsRecordsVerified:()=>u,createDomainVerification:()=>o,createEmailAddress:()=>p,deleteDomainFromDatabase:()=>v,disableDomainCatchAll:()=>y,enableDomainCatchAll:()=>D,getDomainOwnerByDomain:()=>A,getDomainWithCatchAll:()=>E,getDomainWithRecords:()=>c,getDomainWithRecordsAndEmails:()=>g,getEmailAddressesForDomain:()=>f,isDomainCatchAllEnabled:()=>T,markDomainAsVerified:()=>w,updateDnsRecordVerification:()=>d,updateDomainSesVerification:()=>l,updateDomainStatus:()=>m,updateEmailAddressReceiptRule:()=>h});var a=e.i(557440);e.i(468686);var i=e.i(55379),s=e.i(176825),n=e.i(318812);async function o(e,r,t){let s={id:`indm_${(0,n.nanoid)()}`,domain:e,userId:r,status:"pending",canReceiveEmails:t.canReceiveEmails,hasMxRecords:t.hasMxRecords,domainProvider:t.provider?.name,providerConfidence:t.provider?.confidence,lastDnsCheck:new Date,updatedAt:new Date},[o]=await a.db.insert(i.emailDomains).values(s).returning();return o}async function l(e,r,t,o){let[l]=await a.db.update(i.emailDomains).set({verificationToken:r,status:"Success"===t?"verified":"pending",lastSesCheck:new Date,updatedAt:new Date}).where((0,s.eq)(i.emailDomains.id,e)).returning();for(let r of o){let t={id:`dns_${(0,n.nanoid)()}`,domainId:e,recordType:r.type,name:r.name,value:r.value,isRequired:!0,isVerified:!1};await a.db.insert(i.domainDnsRecords).values(t).onConflictDoNothing()}return l}async function c(e,r){let t=await a.db.select().from(i.emailDomains).where((0,s.and)((0,s.eq)(i.emailDomains.domain,e),(0,s.eq)(i.emailDomains.userId,r))).limit(1);if(!t[0])return null;let n=await a.db.select().from(i.domainDnsRecords).where((0,s.eq)(i.domainDnsRecords.domainId,t[0].id));return{...t[0],dnsRecords:n}}async function d(e,r,t,n){await a.db.update(i.domainDnsRecords).set({isVerified:n,lastChecked:new Date}).where((0,s.and)((0,s.eq)(i.domainDnsRecords.domainId,e),(0,s.eq)(i.domainDnsRecords.recordType,r),(0,s.eq)(i.domainDnsRecords.name,t)))}async function u(e){let r=await a.db.select().from(i.domainDnsRecords).where((0,s.and)((0,s.eq)(i.domainDnsRecords.domainId,e),(0,s.eq)(i.domainDnsRecords.isRequired,!0)));return r.length>0&&r.every(e=>e.isVerified)}async function m(e,r){let[t]=await a.db.update(i.emailDomains).set({status:r,updatedAt:new Date}).where((0,s.eq)(i.emailDomains.id,e)).returning();return t}async function p(e,r,t){let s={id:`email_${(0,n.nanoid)()}`,address:e,domainId:r,userId:t,isActive:!0,isReceiptRuleConfigured:!1,updatedAt:new Date},[o]=await a.db.insert(i.emailAddresses).values(s).returning();return o}async function f(e){return a.db.select().from(i.emailAddresses).where((0,s.eq)(i.emailAddresses.domainId,e))}async function h(e,r,t){let[n]=await a.db.update(i.emailAddresses).set({isReceiptRuleConfigured:r,receiptRuleName:t,updatedAt:new Date}).where((0,s.eq)(i.emailAddresses.id,e)).returning();return n}async function g(e,r){let t=await a.db.select().from(i.emailDomains).where((0,s.and)((0,s.eq)(i.emailDomains.domain,e),(0,s.eq)(i.emailDomains.userId,r))).limit(1);if(!t[0])return null;let n=await a.db.select().from(i.domainDnsRecords).where((0,s.eq)(i.domainDnsRecords.domainId,t[0].id)),o=await a.db.select().from(i.emailAddresses).where((0,s.eq)(i.emailAddresses.domainId,t[0].id));return{...t[0],dnsRecords:n,emailAddresses:o}}async function v(e,r){try{let t=await a.db.select().from(i.emailDomains).where((0,s.and)((0,s.eq)(i.emailDomains.id,e),(0,s.eq)(i.emailDomains.userId,r))).limit(1);if(!t[0])return{success:!1,error:"Domain not found or access denied"};return console.log(`ðŸ—‘ï¸ Deleting domain from database: ${t[0].domain}`),await a.db.delete(i.emailAddresses).where((0,s.eq)(i.emailAddresses.domainId,e)),await a.db.delete(i.domainDnsRecords).where((0,s.eq)(i.domainDnsRecords.domainId,e)),await a.db.delete(i.emailDomains).where((0,s.eq)(i.emailDomains.id,e)),console.log(`âœ… Successfully deleted domain from database: ${t[0].domain}`),{success:!0}}catch(e){return console.error("Database domain deletion error:",e),{success:!1,error:e instanceof Error?e.message:"Failed to delete domain from database"}}}async function D(e,r,t){let[n]=await a.db.update(i.emailDomains).set({isCatchAllEnabled:!0,catchAllWebhookId:r,catchAllReceiptRuleName:t,updatedAt:new Date}).where((0,s.eq)(i.emailDomains.id,e)).returning();if(!n)throw Error("Domain not found");return n}async function y(e){let[r]=await a.db.update(i.emailDomains).set({isCatchAllEnabled:!1,catchAllWebhookId:null,catchAllReceiptRuleName:null,updatedAt:new Date}).where((0,s.eq)(i.emailDomains.id,e)).returning();if(!r)throw Error("Domain not found");return r}async function E(e,r){let[t]=await a.db.select().from(i.emailDomains).where((0,s.and)((0,s.eq)(i.emailDomains.domain,e),(0,s.eq)(i.emailDomains.userId,r))).limit(1);return t||null}async function T(e){let[r]=await a.db.select({isCatchAllEnabled:i.emailDomains.isCatchAllEnabled}).from(i.emailDomains).where((0,s.eq)(i.emailDomains.id,e)).limit(1);return r?.isCatchAllEnabled||!1}async function A(r){try{let{user:t}=await e.r(278680)(e.i),n=await a.db.select({userId:i.emailDomains.userId,userEmail:t.email,userName:t.name}).from(i.emailDomains).innerJoin(t,(0,s.eq)(i.emailDomains.userId,t.id)).where((0,s.eq)(i.emailDomains.domain,r)).limit(1);if(!n[0])return console.log(`âŒ getDomainOwnerByDomain - No owner found for domain: ${r}`),null;return console.log(`âœ… getDomainOwnerByDomain - Found owner for domain ${r}: ${n[0].userEmail}`),n[0]}catch(e){return console.error("âŒ getDomainOwnerByDomain - Error looking up domain owner:",e),null}}async function w(e){try{let[r]=await a.db.update(i.emailDomains).set({status:"verified",lastSesCheck:new Date,updatedAt:new Date}).where((0,s.eq)(i.emailDomains.domain,e)).returning();return r&&console.log(`âœ… markDomainAsVerified - Domain ${e} marked as verified`),r||null}catch(e){return console.error("âŒ markDomainAsVerified - Error updating domain status:",e),null}}},362474:function(e){var{g:r,__dirname:t,m:a,e:i}=e;a.exports=e.x("dns",()=>require("dns"))},719797:e=>{"use strict";var{g:r,__dirname:t}=e;{e.s({checkDomainCanReceiveEmails:()=>o,checkMultipleDomainsCanReceiveEmails:()=>l,detectDomainProvider:()=>s,getDetailedMxInfo:()=>d,getDetailedProviderInfo:()=>c,verifyDnsRecords:()=>v,verifyMxRecord:()=>m,verifyMxRecordWithFallback:()=>h,verifyTxtRecord:()=>u,verifyTxtRecordWithFallback:()=>g});var a=e.i(362474);let r={cloudflare:{name:"Cloudflare",icon:"cloudflare",patterns:["cloudflare.com","ns.cloudflare.com","cloudflare.net"]},namecheap:{name:"Namecheap",icon:"namecheap",patterns:["registrar-servers.com","namecheap.com","namecheaphosting.com"]},godaddy:{name:"GoDaddy",icon:"godaddy",patterns:["domaincontrol.com","godaddy.com","secureserver.net"]},route53:{name:"AWS Route 53",icon:"aws",patterns:["awsdns","amazonaws.com","awsdns-"]},google:{name:"Google Domains",icon:"google",patterns:["googledomains.com","google.com","googlehosted.com"]},vercel:{name:"Vercel",icon:"vercel",patterns:["vercel-dns.com","vercel.app"]},digitalocean:{name:"DigitalOcean",icon:"digitalocean",patterns:["digitalocean.com","ns1.digitalocean.com","ns2.digitalocean.com","ns3.digitalocean.com"]},netlify:{name:"Netlify",icon:"netlify",patterns:["netlify.com","dns1.p01.nsone.net","dns2.p01.nsone.net"]},dnsimple:{name:"DNSimple",icon:"dnsimple",patterns:["dnsimple.com","ns1.dnsimple.com","ns2.dnsimple.com"]},hover:{name:"Hover",icon:"hover",patterns:["hover.com","ns1.hover.com","ns2.hover.com"]},porkbun:{name:"Porkbun",icon:"porkbun",patterns:["porkbun.com","curitiba.porkbun.com","fortaleza.porkbun.com"]},squarespace:{name:"Squarespace",icon:"squarespace",patterns:["squarespace.com","ext-dns.squarespace.com"]}};function i(e){let r=e.split("."),t=[];for(let e=1;e<r.length;e++)t.push(r.slice(e).join("."));return t}async function s(e){let r=await n(e);if(r&&r.detected)return r;for(let r of i(e))try{let e=await n(r);if(e&&e.detected)return{...e,confidence:"high"===e.confidence?"medium":"low"}}catch(e){continue}return r||{name:"DNS Provider",icon:"globe",detected:!1,confidence:"low"}}async function n(e){try{let t=await a.promises.resolveNs(e);for(let[e,a]of Object.entries(r))for(let e of t)for(let r of a.patterns)if(e.toLowerCase().includes(r.toLowerCase()))return{name:a.name,icon:a.icon,detected:!0,confidence:"high"};if(t.length>0)return{name:"Custom DNS Provider",icon:"globe",detected:!1,confidence:"medium"};return null}catch(e){return null}}async function o(e){var r;let t={domain:e,canReceiveEmails:!1,hasMxRecords:!1,timestamp:new Date};if(r=e,!/^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(r)||!(r.length<=253))return t.error="Invalid domain format",t;try{let r=await s(e);r&&(t.provider=r)}catch(e){}let i=[],n=null;try{i=await a.promises.resolveMx(e),console.log("ðŸ CANDOMAINRECEIVE ðŸ \n MX Records:",i)}catch(e){"ENOTFOUND"!==e.code&&"ENODATA"!==e.code&&(n=e.message)}let o=[],l=null;try{o=await a.promises.resolveCname(e)}catch(e){"ENOTFOUND"!==e.code&&"ENODATA"!==e.code&&(l=e.message)}let c=i.length>0,d=o.length>0;if(c||d)t.hasMxRecords=c,t.mxRecords=i,t.canReceiveEmails=!1,c?t.error=`Domain has ${i.length} MX record(s) - email already configured`:d&&(t.error="Domain has CNAME record(s) - conflicts with MX records");else if(t.hasMxRecords=!1,t.canReceiveEmails=!0,n||l){let e=[n,l].filter(Boolean);t.error=`Domain check: ${e.join(", ")} (safe for email receiving)`}return t}async function l(e){return Promise.all(e.map(e=>o(e)))}async function c(e){let r=[e];try{let t=[];try{t=await a.promises.resolveNs(e)}catch(n){let s=i(e);for(let e of(r.push(...s),s))try{t=await a.promises.resolveNs(e);break}catch(e){continue}}let n=await s(e);return{domain:e,provider:n,nameservers:t,checkedDomains:r}}catch(t){return{domain:e,provider:null,nameservers:[],checkedDomains:r,error:t.message}}}async function d(e){try{let r=await a.promises.resolveMx(e);return{domain:e,mxRecords:r,hasRecords:r.length>0}}catch(r){return{domain:e,mxRecords:[],hasRecords:!1,error:r.message}}}async function u(e,r){let t={type:"TXT",name:e,expectedValue:r,actualValues:[],isVerified:!1};try{console.log(`ðŸ” TXT Verification - Checking TXT records for: ${e}`),console.log(`ðŸŽ¯ TXT Verification - Expected value: ${r}`);let i=await a.promises.resolveTxt(e);console.log(`ðŸ“‹ TXT Verification - Found ${i.length} TXT records:`,i),t.actualValues=i.flat(),console.log(`ðŸ“Š TXT Verification - Flattened values:`,t.actualValues),t.isVerified=t.actualValues.some(e=>e===r),console.log(`âœ… TXT Verification - Is verified: ${t.isVerified}`),!t.isVerified&&t.actualValues.length>0&&console.log(`âŒ TXT Verification - Expected "${r}" but found:`,t.actualValues)}catch(a){let r=a instanceof Error?a.message:"Unknown DNS error";console.log(`ðŸ’¥ TXT Verification - DNS lookup failed for ${e}:`,r),r.includes("ENODATA")||r.includes("ENOTFOUND")?t.error=`No TXT records found for ${e}. Please add the TXT record to your DNS.`:t.error=r,t.isVerified=!1}return t}async function m(e,r){let t={type:"MX",name:e,expectedValue:r,actualValues:[],isVerified:!1};try{console.log(`ðŸ” MX Verification - Checking MX records for: ${e}`),console.log(`ðŸŽ¯ MX Verification - Expected value: ${r}`);let i=await a.promises.resolveMx(e);console.log(`ðŸ“‹ MX Verification - Found ${i.length} MX records:`,i),t.actualValues=i.map(e=>`${e.priority} ${e.exchange}`),console.log(`ðŸ“Š MX Verification - Formatted values:`,t.actualValues),t.isVerified=t.actualValues.some(e=>e===r),console.log(`âœ… MX Verification - Is verified: ${t.isVerified}`),!t.isVerified&&t.actualValues.length>0&&console.log(`âŒ MX Verification - Expected "${r}" but found:`,t.actualValues)}catch(a){let r=a instanceof Error?a.message:"Unknown DNS error";console.log(`ðŸ’¥ MX Verification - DNS lookup failed for ${e}:`,r),r.includes("ENODATA")||r.includes("ENOTFOUND")?t.error=`No MX records found for ${e}. Please add the MX record to your DNS.`:t.error=r,t.isVerified=!1}return t}async function p(e){for(let r of[["8.8.8.8","8.8.4.4"],["1.1.1.1","1.0.0.1"],["208.67.222.222","208.67.220.220"]])try{console.log(`ðŸ”„ TXT Alternative - Trying resolver: ${r.join(", ")}`);let t=new a.Resolver;t.setServers(r);let i=await new Promise((r,a)=>{t.resolveTxt(e,(e,t)=>{e?a(e):r(t||[])})});if(i.length>0)return console.log(`âœ… TXT Alternative - Found records with ${r[0]}:`,i),i}catch(e){console.log(`âŒ TXT Alternative - Failed with ${r[0]}:`,e instanceof Error?e.message:"Unknown error");continue}return[]}async function f(e){for(let r of[["8.8.8.8","8.8.4.4"],["1.1.1.1","1.0.0.1"],["208.67.222.222","208.67.220.220"]])try{console.log(`ðŸ”„ MX Alternative - Trying resolver: ${r.join(", ")}`);let t=new a.Resolver;t.setServers(r);let i=await new Promise((r,a)=>{t.resolveMx(e,(e,t)=>{e?a(e):r(t||[])})});if(i.length>0)return console.log(`âœ… MX Alternative - Found records with ${r[0]}:`,i),i}catch(e){console.log(`âŒ MX Alternative - Failed with ${r[0]}:`,e instanceof Error?e.message:"Unknown error");continue}return[]}async function h(e,r){let t={type:"MX",name:e,expectedValue:r,actualValues:[],isVerified:!1};try{console.log(`ðŸ” MX Verification - Checking MX records for: ${e}`),console.log(`ðŸŽ¯ MX Verification - Expected value: ${r}`);let i=[];try{i=await a.promises.resolveMx(e),console.log(`ðŸ“‹ MX Verification - Default DNS found ${i.length} MX records:`,i)}catch(r){console.log(`âš ï¸ MX Verification - Default DNS failed, trying alternative resolvers...`),i=await f(e)}t.actualValues=i.map(e=>`${e.priority} ${e.exchange}`),console.log(`ðŸ“Š MX Verification - Formatted values:`,t.actualValues),t.isVerified=t.actualValues.some(e=>e===r),console.log(`âœ… MX Verification - Is verified: ${t.isVerified}`),!t.isVerified&&t.actualValues.length>0&&console.log(`âŒ MX Verification - Expected "${r}" but found:`,t.actualValues),0===t.actualValues.length&&(t.error=`No MX records found for ${e} using multiple DNS resolvers. Please add the MX record to your DNS.`)}catch(a){let r=a instanceof Error?a.message:"Unknown DNS error";console.log(`ðŸ’¥ MX Verification - All DNS lookups failed for ${e}:`,r),t.error=`DNS resolution failed: ${r}`,t.isVerified=!1}return t}async function g(e,r){let t={type:"TXT",name:e,expectedValue:r,actualValues:[],isVerified:!1};try{console.log(`ðŸ” TXT Verification - Checking TXT records for: ${e}`),console.log(`ðŸŽ¯ TXT Verification - Expected value: ${r}`);let i=[];try{i=await a.promises.resolveTxt(e),console.log(`ðŸ“‹ TXT Verification - Default DNS found ${i.length} TXT records:`,i)}catch(r){console.log(`âš ï¸ TXT Verification - Default DNS failed, trying alternative resolvers...`),i=await p(e)}t.actualValues=i.flat(),console.log(`ðŸ“Š TXT Verification - Flattened values:`,t.actualValues),t.isVerified=t.actualValues.some(e=>e===r),console.log(`âœ… TXT Verification - Is verified: ${t.isVerified}`),!t.isVerified&&t.actualValues.length>0&&console.log(`âŒ TXT Verification - Expected "${r}" but found:`,t.actualValues),0===t.actualValues.length&&(t.error=`No TXT records found for ${e} using multiple DNS resolvers. Please add the TXT record to your DNS.`)}catch(a){let r=a instanceof Error?a.message:"Unknown DNS error";console.log(`ðŸ’¥ TXT Verification - All DNS lookups failed for ${e}:`,r),t.error=`DNS resolution failed: ${r}`,t.isVerified=!1}return t}async function v(e){return console.log(`ðŸ“‹ Starting verification of ${e.length} DNS records:`),e.forEach((e,r)=>{console.log(`  ${r+1}. ${e.type} record for ${e.name}`)}),Promise.all(e.map(async e=>{switch(e.type.toUpperCase()){case"TXT":return g(e.name,e.value);case"MX":return h(e.name,e.value);default:return{type:e.type,name:e.name,expectedValue:e.value,actualValues:[],isVerified:!1,error:`Unsupported record type: ${e.type}`}}}))}}},459351:e=>{"use strict";var{g:r,__dirname:t}=e;e.s({AppEnv:()=>_,Autumn:()=>k,AutumnError:()=>n,FreeTrialDuration:()=>P,Infinite:()=>O,ProductItemInterval:()=>q,ProductStatus:()=>M,UsageModel:()=>X,fetchPricingTable:()=>C,toContainerResult:()=>I});var a=Object.defineProperty,i=(e,r,t)=>r in e?a(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,s=(e,r,t)=>i(e,"symbol"!=typeof r?r+"":r,t),n=class extends Error{constructor(e){super(e.message),s(this,"message"),s(this,"code"),this.message=e.message,this.code=e.code}toString(){return`${this.message} (code: ${this.code})`}toJSON(){return{message:this.message,code:this.code}}},o=(e,r,t)=>(r||(r=new k),e({instance:r,...t})),l=e=>({get:(r,t)=>o(d,e,{id:r,params:t}),create:r=>o(u,e,{params:r}),update:(r,t)=>o(m,e,{id:r,params:t}),delete:r=>o(p,e,{id:r}),billingPortal:(r,t)=>o(f,e,{id:r,params:t})}),c=e=>e?`expand=${e.join(",")}`:"",d=async({instance:e,id:r,params:t})=>r?e.get(`/customers/${r}?${c(t?.expand)}`):{data:null,error:new n({message:"Customer ID is required",code:"CUSTOMER_ID_REQUIRED"})},u=async({instance:e,params:r})=>e.post(`/customers?${c(r?.expand)}`,r),m=async({instance:e,id:r,params:t})=>e.post(`/customers/${r}`,t),p=async({instance:e,id:r})=>e.delete(`/customers/${r}`),f=async({instance:e,id:r,params:t})=>e.post(`/customers/${r}/billing_portal`,t),h=e=>({get:(r,t,a)=>o(v,e,{customer_id:r,entity_id:t,params:a}),create:(r,t)=>o(D,e,{customer_id:r,params:t}),delete:(r,t)=>o(y,e,{customer_id:r,entity_id:t})}),g=e=>e?`expand=${e.join(",")}`:"",v=async({instance:e,customer_id:r,entity_id:t,params:a})=>e.get(`/customers/${r}/entities/${t}?${g(a?.expand)}`),D=async({instance:e,customer_id:r,params:t})=>e.post(`/customers/${r}/entities`,t),y=async({instance:e,customer_id:r,entity_id:t})=>e.delete(`/customers/${r}/entities/${t}`),E=async({instance:e,params:r})=>e.post("/attach",r),T=async({instance:e,params:r})=>e.post("/cancel",r),A=async({instance:e,params:r})=>e.post("/entitled",r),w=async({instance:e,params:r})=>e.post("/events",r),S=async({instance:e,params:r})=>e.post("/track",r),b=async({instance:e,params:r})=>e.post("/usage",r),R=async({instance:e,params:r})=>e.post("/check",r),V=e=>({get:r=>o(N,e,{id:r}),create:r=>o($,e,{params:r}),list:r=>o(x,e,{params:r})}),x=async({instance:e,params:r})=>{let t="/products";if(r){let e=new URLSearchParams;for(let[t,a]of Object.entries(r))void 0!==a&&e.append(t,String(a));let a=e.toString();a&&(t+=`?${a}`)}return e.get(t)},N=async({instance:e,id:r})=>e.get(`/products/${r}`),$=async({instance:e,params:r})=>e.post("/products",r),I=async e=>{if(e.status<200||e.status>=300){let r;try{r=await e.json()}catch(r){return{data:null,error:new n({message:"Failed to parse JSON response from Autumn",code:"internal_error"}),statusCode:e.status}}return{data:null,error:new n({message:r.message,code:r.code}),statusCode:e.status}}try{return{data:await e.json(),error:null,statusCode:e?.status}}catch(r){return{data:null,error:new n({message:"Failed to parse Autumn API response",code:"internal_error"}),statusCode:e?.status}}},k=class{constructor(e){s(this,"secretKey"),s(this,"publishableKey"),s(this,"level"),s(this,"headers"),s(this,"url"),s(this,"customers",l(this)),s(this,"products",V(this)),s(this,"entities",h(this));try{this.secretKey=e?.secretKey||process.env.AUTUMN_SECRET_KEY,this.publishableKey=e?.publishableKey||process.env.AUTUMN_PUBLISHABLE_KEY}catch(e){}if(!this.secretKey&&!this.publishableKey)throw Error("Autumn secret key or publishable key is required");this.headers={Authorization:`Bearer ${this.secretKey||this.publishableKey}`,"Content-Type":"application/json"};let r=e?.version||"1.2";this.headers["x-api-version"]=r,this.url=e?.url||"https://api.useautumn.com/v1",this.level=this.secretKey?"secret":"publishable"}getLevel(){return this.level}async get(e){return I(await fetch(`${this.url}${e}`,{headers:this.headers}))}async post(e,r){return I(await fetch(`${this.url}${e}`,{method:"POST",headers:this.headers,body:JSON.stringify(r)}))}async delete(e){return I(await fetch(`${this.url}${e}`,{method:"DELETE",headers:this.headers}))}async attach(e){return E({instance:this,params:e})}async cancel(e){return T({instance:this,params:e})}async entitled(e){return A({instance:this,params:e})}async check(e){return R({instance:this,params:e})}async event(e){return w({instance:this,params:e})}async track(e){return S({instance:this,params:e})}async usage(e){return b({instance:this,params:e})}};s(k,"customers",l()),s(k,"products",V()),s(k,"entities",h()),s(k,"attach",e=>o(E,void 0,{params:e})),s(k,"usage",e=>o(b,void 0,{params:e})),s(k,"cancel",e=>o(T,void 0,{params:e})),s(k,"entitled",e=>o(A,void 0,{params:e})),s(k,"check",e=>o(R,void 0,{params:e})),s(k,"event",e=>o(w,void 0,{params:e})),s(k,"track",e=>o(S,void 0,{params:e}));var _=(e=>(e.Sandbox="sandbox",e.Live="live",e))(_||{}),M=(e=>(e.Active="active",e.Expired="expired",e.Trialing="trialing",e.Scheduled="scheduled",e))(M||{}),O="inf",P=(e=>(e.Day="day",e))(P||{}),X=(e=>(e.Prepaid="prepaid",e.PayPerUse="pay_per_use",e))(X||{}),q=(e=>(e.Minute="minute",e.Hour="hour",e.Day="day",e.Week="week",e.Month="month",e.Quarter="quarter",e.SemiAnnual="semi_annual",e.Year="year",e.Multiple="multiple",e))(q||{}),C=async({instance:e,params:r})=>{let t="/components/pricing_table";if(r){let e=new URLSearchParams;for(let[t,a]of Object.entries(r))"products"!==t&&void 0!==a&&e.append(t,String(a));let a=e.toString();a&&(t+=`?${a}`)}return await e.get(t)}},212765:function(e){var{g:r,__dirname:t,m:a,e:i}=e},357644:e=>{"use strict";var{g:r,__dirname:t}=e;e.s({POST:()=>p});var a=e.i(125427),i=e.i(719797),s=e.i(906273),n=e.i(402168),o=e.i(998322),l=e.i(459351),c=e.i(557440);e.i(468686);var d=e.i(55379),u=e.i(176825),m=e.i(91890);async function p(e){try{let r=await n.auth.api.getSession({headers:await (0,o.headers)()});if(!r?.user?.id)return a.NextResponse.json({error:"Unauthorized"},{status:401});let{domain:t}=await e.json();if(!t)return a.NextResponse.json({error:"Domain is required"},{status:400});if(!/^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(t)||t.length>253)return a.NextResponse.json({error:"Invalid domain format"},{status:400});let p=await (0,s.getDomainWithRecords)(t,r.user.id);if(p)return a.NextResponse.json({...p,timestamp:new Date});let{data:f,error:h}=await l.Autumn.check({customer_id:r.user.id,feature_id:"domains"});if(h)return console.error("Autumn domain check error:",h),a.NextResponse.json({error:"Failed to check domain limits"},{status:500});if(!f?.allowed)return a.NextResponse.json({error:"Domain limit reached. Please upgrade your plan to add more domains."},{status:403});let[g]=await c.db.select({count:(0,m.count)()}).from(d.emailDomains).where((0,u.eq)(d.emailDomains.userId,r.user.id)),v=g?.count||0,D=f.balance||0;if(!f.unlimited&&v>=D)return a.NextResponse.json({error:`Domain limit reached (${v}/${D}). Please upgrade your plan to add more domains.`},{status:403});let y=await (0,i.checkDomainCanReceiveEmails)(t),E=await (0,s.createDomainVerification)(t,r.user.id,{canReceiveEmails:y.canReceiveEmails,hasMxRecords:y.hasMxRecords,provider:y.provider});return a.NextResponse.json({...y,domainId:E.id,timestamp:new Date})}catch(e){return console.error("DNS check error:",e),a.NextResponse.json({error:"Failed to check DNS records",domain:"",canReceiveEmails:!1,hasMxRecords:!1,timestamp:new Date},{status:500})}}},335012:e=>{"use strict";var{g:r,__dirname:t}=e;{e.s({patchFetch:()=>o,routeModule:()=>r,serverHooks:()=>c,workAsyncStorage:()=>t,workUnitAsyncStorage:()=>l});var a=e.i(854885),i=e.i(814689),s=e.i(25402),n=e.i(357644);let r=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/inbound/check-dns/route",pathname:"/api/inbound/check-dns",filename:"route",bundlePath:""},resolvedPagePath:"[project]/app/api/inbound/check-dns/route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:t,workUnitAsyncStorage:l,serverHooks:c}=r;function o(){return(0,s.patchFetch)({workAsyncStorage:t,workUnitAsyncStorage:l})}}},278680:e=>{var{g:r,__dirname:t}=e;e.v(e=>Promise.resolve().then(()=>e(594120)))},993477:e=>{var{g:r,__dirname:t}=e;e.v(r=>Promise.all(["server/chunks/[root-of-the-server]__26a98de8._.js","server/chunks/node_modules_10ae7a2d._.js"].map(r=>e.l(r))).then(()=>r(611487)))}};

//# sourceMappingURL=%5Broot-of-the-server%5D__aecc552a._.js.map