module.exports={873949:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({entityKind:()=>b,hasOwnEntityKind:()=>c,is:()=>d});let b=Symbol.for("drizzle:entityKind"),c=Symbol.for("drizzle:hasOwnEntityKind");function d(a,c){if(!a||"object"!=typeof a)return!1;if(a instanceof c)return!0;if(!Object.prototype.hasOwnProperty.call(c,b))throw Error(`Class "${c.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let d=Object.getPrototypeOf(a).constructor;if(d)for(;d;){if(b in d&&d[b]===c[b])return!0;d=Object.getPrototypeOf(d)}return!1}}},544174:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({TableName:()=>b});let b=Symbol.for("drizzle:Name")}},940702:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({BaseName:()=>k,Columns:()=>c,ExtraConfigBuilder:()=>m,ExtraConfigColumns:()=>i,IsAlias:()=>l,OriginalName:()=>j,Schema:()=>b,Table:()=>o,getTableName:()=>g,getTableUniqueName:()=>h,isTable:()=>f});var d=a.i(873949),e=a.i(544174);let b=Symbol.for("drizzle:Schema"),c=Symbol.for("drizzle:Columns"),i=Symbol.for("drizzle:ExtraConfigColumns"),j=Symbol.for("drizzle:OriginalName"),k=Symbol.for("drizzle:BaseName"),l=Symbol.for("drizzle:IsAlias"),m=Symbol.for("drizzle:ExtraConfigBuilder"),n=Symbol.for("drizzle:IsDrizzleTable");class o{static [d.entityKind]="Table";static Symbol={Name:e.TableName,Schema:b,OriginalName:j,Columns:c,ExtraConfigColumns:i,BaseName:k,IsAlias:l,ExtraConfigBuilder:m};[e.TableName];[j];[b];[c];[i];[k];[l]=!1;[n]=!0;[m]=void 0;constructor(a,c,d){this[e.TableName]=this[j]=a,this[b]=c,this[k]=d}}function f(a){return"object"==typeof a&&null!==a&&n in a}function g(a){return a[e.TableName]}function h(a){return`${a[b]??"public"}.${a[e.TableName]}`}}},26736:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({Column:()=>b});var d=a.i(873949);class b{constructor(a,b){this.table=a,this.config=b,this.name=b.name,this.keyAsName=b.keyAsName,this.notNull=b.notNull,this.default=b.default,this.defaultFn=b.defaultFn,this.onUpdateFn=b.onUpdateFn,this.hasDefault=b.hasDefault,this.primary=b.primaryKey,this.isUnique=b.isUnique,this.uniqueName=b.uniqueName,this.uniqueType=b.uniqueType,this.dataType=b.dataType,this.columnType=b.columnType,this.generated=b.generated,this.generatedIdentity=b.generatedIdentity}static [d.entityKind]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(a){return a}mapToDriverValue(a){return a}shouldDisableInsert(){return void 0!==this.config.generated&&"byDefault"!==this.config.generated.type}}}},956067:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({ColumnBuilder:()=>b});var d=a.i(873949);class b{static [d.entityKind]="ColumnBuilder";config;constructor(a,b,c){this.config={name:a,keyAsName:""===a,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:b,columnType:c,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(a){return this.config.default=a,this.config.hasDefault=!0,this}$defaultFn(a){return this.config.defaultFn=a,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(a){return this.config.onUpdateFn=a,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(a){""===this.config.name&&(this.config.name=a)}}}},164881:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({ForeignKey:()=>c,ForeignKeyBuilder:()=>b,foreignKey:()=>f});var d=a.i(873949),e=a.i(544174);class b{static [d.entityKind]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(a,b){this.reference=()=>{let{name:b,columns:c,foreignColumns:d}=a();return{name:b,columns:c,foreignTable:d[0].table,foreignColumns:d}},b&&(this._onUpdate=b.onUpdate,this._onDelete=b.onDelete)}onUpdate(a){return this._onUpdate=void 0===a?"no action":a,this}onDelete(a){return this._onDelete=void 0===a?"no action":a,this}build(a){return new c(a,this)}}class c{constructor(a,b){this.table=a,this.reference=b.reference,this.onUpdate=b._onUpdate,this.onDelete=b._onDelete}static [d.entityKind]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:a,columns:b,foreignColumns:c}=this.reference(),d=b.map(a=>a.name),f=c.map(a=>a.name),g=[this.table[e.TableName],...d,c[0].table[e.TableName],...f];return a??`${g.join("_")}_fk`}}function f(a){return new b(function(){let{name:b,columns:c,foreignColumns:d}=a;return{name:b,columns:c,foreignColumns:d}})}}},321019:a=>{"use strict";var{g:b,__dirname:c}=a;function d(a,...b){return a(...b)}a.s({iife:()=>d})},442297:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({UniqueConstraint:()=>h,UniqueConstraintBuilder:()=>b,UniqueOnConstraintBuilder:()=>c,unique:()=>f,uniqueKeyName:()=>g});var d=a.i(873949),e=a.i(544174);function f(a){return new c(a)}function g(a,b){return`${a[e.TableName]}_${b.join("_")}_unique`}class b{constructor(a,b){this.name=b,this.columns=a}static [d.entityKind]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(a){return new h(a,this.columns,this.nullsNotDistinctConfig,this.name)}}class c{static [d.entityKind]="PgUniqueOnConstraintBuilder";name;constructor(a){this.name=a}on(...a){return new b(a,this.name)}}class h{constructor(a,b,c,d){this.table=a,this.columns=b,this.name=d??g(this.table,this.columns.map(a=>a.name)),this.nullsNotDistinct=c}static [d.entityKind]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}}},464892:a=>{"use strict";var{g:b,__dirname:c}=a;function d(a,b,c){for(let d=b;d<a.length;d++){let e=a[d];if("\\"===e){d++;continue}if('"'===e)return[a.slice(b,d).replace(/\\/g,""),d+1];if(!c&&(","===e||"}"===e))return[a.slice(b,d).replace(/\\/g,""),d]}return[a.slice(b).replace(/\\/g,""),a.length]}function e(a,b=0){let c=[],f=b,g=!1;for(;f<a.length;){let h=a[f];if(","===h){(g||f===b)&&c.push(""),g=!0,f++;continue}if(g=!1,"\\"===h){f+=2;continue}if('"'===h){let[b,e]=d(a,f+1,!0);c.push(b),f=e;continue}if("}"===h)return[c,f+1];if("{"===h){let[b,d]=e(a,f+1);c.push(b),f=d;continue}let[i,j]=d(a,f,!1);c.push(i),f=j}return[c,f]}function f(a){let[b]=e(a,1);return b}a.s({makePgArray:()=>function a(b){return`{${b.map(b=>Array.isArray(b)?a(b):"string"==typeof b?`"${b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${b}`).join(",")}}`},parsePgArray:()=>f,parsePgNestedArray:()=>e})},716764:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({ExtraConfigColumn:()=>k,IndexedColumn:()=>l,PgArray:()=>n,PgArrayBuilder:()=>m,PgColumn:()=>c,PgColumnBuilder:()=>b});var d=a.i(956067),e=a.i(26736),f=a.i(873949),g=a.i(164881),h=a.i(321019),i=a.i(442297),j=a.i(464892);class b extends d.ColumnBuilder{foreignKeyConfigs=[];static [f.entityKind]="PgColumnBuilder";array(a){return new m(this.config.name,this,a)}references(a,b={}){return this.foreignKeyConfigs.push({ref:a,actions:b}),this}unique(a,b){return this.config.isUnique=!0,this.config.uniqueName=a,this.config.uniqueType=b?.nulls,this}generatedAlwaysAs(a){return this.config.generated={as:a,type:"always",mode:"stored"},this}buildForeignKeys(a,b){return this.foreignKeyConfigs.map(({ref:c,actions:d})=>(0,h.iife)((c,d)=>{let e=new g.ForeignKeyBuilder(()=>({columns:[a],foreignColumns:[c()]}));return d.onUpdate&&e.onUpdate(d.onUpdate),d.onDelete&&e.onDelete(d.onDelete),e.build(b)},c,d))}buildExtraConfigColumn(a){return new k(a,this.config)}}class c extends e.Column{constructor(a,b){b.uniqueName||(b.uniqueName=(0,i.uniqueKeyName)(a,[b.name])),super(a,b),this.table=a}static [f.entityKind]="PgColumn"}class k extends c{static [f.entityKind]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(a){return this.indexConfig.opClass=a,this}}class l{static [f.entityKind]="IndexedColumn";constructor(a,b,c,d){this.name=a,this.keyAsName=b,this.type=c,this.indexConfig=d}name;keyAsName;type;indexConfig}class m extends b{static [f.entityKind]="PgArrayBuilder";constructor(a,b,c){super(a,"array","PgArray"),this.config.baseBuilder=b,this.config.size=c}build(a){let b=this.config.baseBuilder.build(a);return new n(a,this.config,b)}}class n extends c{constructor(a,b,c,d){super(a,b),this.baseColumn=c,this.range=d,this.size=b.size}size;static [f.entityKind]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${"number"==typeof this.size?this.size:""}]`}mapFromDriverValue(a){return"string"==typeof a&&(a=(0,j.parsePgArray)(a)),a.map(a=>this.baseColumn.mapFromDriverValue(a))}mapToDriverValue(a,b=!1){let c=a.map(a=>null===a?null:(0,f.is)(this.baseColumn,n)?this.baseColumn.mapToDriverValue(a,!0):this.baseColumn.mapToDriverValue(a));return b?c:(0,j.makePgArray)(c)}}}},839388:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgEnumColumn:()=>l,PgEnumColumnBuilder:()=>k,PgEnumObjectColumn:()=>c,PgEnumObjectColumnBuilder:()=>b,isPgEnum:()=>f,pgEnum:()=>g,pgEnumObjectWithSchema:()=>i,pgEnumWithSchema:()=>h});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgEnumObjectColumnBuilder";constructor(a,b){super(a,"string","PgEnumObjectColumn"),this.config.enum=b}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgEnumObjectColumn";enum;enumValues=this.config.enum.enumValues;constructor(a,b){super(a,b),this.enum=b.enum}getSQLType(){return this.enum.enumName}}let j=Symbol.for("drizzle:isPgEnum");function f(a){return!!a&&"function"==typeof a&&j in a&&!0===a[j]}class k extends e.PgColumnBuilder{static [d.entityKind]="PgEnumColumnBuilder";constructor(a,b){super(a,"string","PgEnumColumn"),this.config.enum=b}build(a){return new l(a,this.config)}}class l extends e.PgColumn{static [d.entityKind]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(a,b){super(a,b),this.enum=b.enum}getSQLType(){return this.enum.enumName}}function g(a,b){return Array.isArray(b)?h(a,[...b],void 0):i(a,b,void 0)}function h(a,b,c){let d=Object.assign(a=>new k(a??"",d),{enumName:a,enumValues:b,schema:c,[j]:!0});return d}function i(a,c,d){let e=Object.assign(a=>new b(a??"",e),{enumName:a,enumValues:Object.values(c),schema:d,[j]:!0});return e}}},564540:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({Subquery:()=>b,WithSubquery:()=>c});var d=a.i(873949);class b{static [d.entityKind]="Subquery";constructor(a,b,c,d=!1){this._={brand:"Subquery",sql:a,selectedFields:b,alias:c,isWith:d}}}class c extends b{static [d.entityKind]="WithSubquery"}}},836872:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({compatibilityVersion:()=>e,npmVersion:()=>d});var d="0.43.1",e=10},762733:a=>{"use strict";var{g:b,__dirname:c}=a;{let b,c;a.s({tracer:()=>f});var d=a.i(321019),e=a.i(836872);let f={startActiveSpan:(a,f)=>b?(c||(c=b.trace.getTracer("drizzle-orm",e.npmVersion)),(0,d.iife)((b,c)=>c.startActiveSpan(a,a=>{try{return f(a)}catch(c){throw a.setStatus({code:b.SpanStatusCode.ERROR,message:c instanceof Error?c.message:"Unknown error"}),c}finally{a.end()}}),b,c)):f()}}},671725:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({ViewBaseConfig:()=>b});let b=Symbol.for("drizzle:ViewBaseConfig")}},260708:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({FakePrimitiveParam:()=>b,Name:()=>u,Param:()=>y,Placeholder:()=>z,SQL:()=>t,StringChunk:()=>c,View:()=>B,fillPlaceholders:()=>q,getViewName:()=>s,isDriverValueEncoder:()=>m,isSQLWrapper:()=>k,isView:()=>r,name:()=>l,noopDecoder:()=>v,noopEncoder:()=>w,noopMapper:()=>x,param:()=>n,placeholder:()=>p,sql:()=>o});var d=a.i(873949),e=a.i(839388),f=a.i(564540),g=a.i(762733),h=a.i(671725),i=a.i(26736),j=a.i(940702);class b{static [d.entityKind]="FakePrimitiveParam"}function k(a){return null!=a&&"function"==typeof a.getSQL}class c{static [d.entityKind]="StringChunk";value;constructor(a){this.value=Array.isArray(a)?a:[a]}getSQL(){return new t([this])}}class t{constructor(a){this.queryChunks=a}static [d.entityKind]="SQL";decoder=v;shouldInlineParams=!1;append(a){return this.queryChunks.push(...a.queryChunks),this}toQuery(a){return g.tracer.startActiveSpan("drizzle.buildSQL",b=>{let c=this.buildQueryFromSourceParams(this.queryChunks,a);return b?.setAttributes({"drizzle.query.text":c.sql,"drizzle.query.params":JSON.stringify(c.params)}),c})}buildQueryFromSourceParams(a,b){let g=Object.assign({},b,{inlineParams:b.inlineParams||this.shouldInlineParams,paramStartIndex:b.paramStartIndex||{value:0}}),{casing:l,escapeName:m,escapeParam:n,prepareTyping:o,inlineParams:p,paramStartIndex:q}=g;var r=a.map(a=>{if((0,d.is)(a,c))return{sql:a.value.join(""),params:[]};if((0,d.is)(a,u))return{sql:m(a.value),params:[]};if(void 0===a)return{sql:"",params:[]};if(Array.isArray(a)){let b=[new c("(")];for(let[d,e]of a.entries())b.push(e),d<a.length-1&&b.push(new c(", "));return b.push(new c(")")),this.buildQueryFromSourceParams(b,g)}if((0,d.is)(a,t))return this.buildQueryFromSourceParams(a.queryChunks,{...g,inlineParams:p||a.shouldInlineParams});if((0,d.is)(a,j.Table)){let b=a[j.Table.Symbol.Schema],c=a[j.Table.Symbol.Name];return{sql:void 0===b||a[j.IsAlias]?m(c):m(b)+"."+m(c),params:[]}}if((0,d.is)(a,i.Column)){let c=l.getColumnCasing(a);if("indexes"===b.invokeSource)return{sql:m(c),params:[]};let d=a.table[j.Table.Symbol.Schema];return{sql:a.table[j.IsAlias]||void 0===d?m(a.table[j.Table.Symbol.Name])+"."+m(c):m(d)+"."+m(a.table[j.Table.Symbol.Name])+"."+m(c),params:[]}}if((0,d.is)(a,B)){let b=a[h.ViewBaseConfig].schema,c=a[h.ViewBaseConfig].name;return{sql:void 0===b||a[h.ViewBaseConfig].isAlias?m(c):m(b)+"."+m(c),params:[]}}if((0,d.is)(a,y)){if((0,d.is)(a.value,z))return{sql:n(q.value++,a),params:[a],typings:["none"]};let b=null===a.value?null:a.encoder.mapToDriverValue(a.value);if((0,d.is)(b,t))return this.buildQueryFromSourceParams([b],g);if(p)return{sql:this.mapInlineParam(b,g),params:[]};let c=["none"];return o&&(c=[o(a.encoder)]),{sql:n(q.value++,b),params:[b],typings:c}}return(0,d.is)(a,z)?{sql:n(q.value++,a),params:[a],typings:["none"]}:(0,d.is)(a,t.Aliased)&&void 0!==a.fieldAlias?{sql:m(a.fieldAlias),params:[]}:(0,d.is)(a,f.Subquery)?a._.isWith?{sql:m(a._.alias),params:[]}:this.buildQueryFromSourceParams([new c("("),a._.sql,new c(") "),new u(a._.alias)],g):(0,e.isPgEnum)(a)?a.schema?{sql:m(a.schema)+"."+m(a.enumName),params:[]}:{sql:m(a.enumName),params:[]}:k(a)?a.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([a.getSQL()],g):this.buildQueryFromSourceParams([new c("("),a.getSQL(),new c(")")],g):p?{sql:this.mapInlineParam(a,g),params:[]}:{sql:n(q.value++,a),params:[a],typings:["none"]}});let s={sql:"",params:[]};for(let a of r)s.sql+=a.sql,s.params.push(...a.params),a.typings?.length&&(s.typings||(s.typings=[]),s.typings.push(...a.typings));return s}mapInlineParam(a,{escapeString:b}){if(null===a)return"null";if("number"==typeof a||"boolean"==typeof a)return a.toString();if("string"==typeof a)return b(a);if("object"==typeof a){let c=a.toString();return"[object Object]"===c?b(JSON.stringify(a)):b(c)}throw Error("Unexpected param value: "+a)}getSQL(){return this}as(a){return void 0===a?this:new t.Aliased(this,a)}mapWith(a){return this.decoder="function"==typeof a?{mapFromDriverValue:a}:a,this}inlineParams(){return this.shouldInlineParams=!0,this}if(a){return a?this:void 0}}class u{constructor(a){this.value=a}static [d.entityKind]="Name";brand;getSQL(){return new t([this])}}function l(a){return new u(a)}function m(a){return"object"==typeof a&&null!==a&&"mapToDriverValue"in a&&"function"==typeof a.mapToDriverValue}let v={mapFromDriverValue:a=>a},w={mapToDriverValue:a=>a},x={...v,...w};class y{constructor(a,b=w){this.value=a,this.encoder=b}static [d.entityKind]="Param";brand;getSQL(){return new t([this])}}function n(a,b){return new y(a,b)}function o(a,...b){let d=[];for(let[e,f]of((b.length>0||a.length>0&&""!==a[0])&&d.push(new c(a[0])),b.entries()))d.push(f,new c(a[e+1]));return new t(d)}(a=>{a.empty=function(){return new t([])},a.fromList=function(a){return new t(a)},a.raw=function(a){return new t([new c(a)])},a.join=function(a,b){let c=[];for(let[d,e]of a.entries())d>0&&void 0!==b&&c.push(b),c.push(e);return new t(c)},a.identifier=function(a){return new u(a)},a.placeholder=function(a){return new z(a)},a.param=function(a,b){return new y(a,b)}})(o||(o={})),(a=>{class b{constructor(a,b){this.sql=a,this.fieldAlias=b}static [d.entityKind]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new b(this.sql,this.fieldAlias)}}a.Aliased=b})(t||(t={}));class z{constructor(a){this.name=a}static [d.entityKind]="Placeholder";getSQL(){return new t([this])}}function p(a){return new z(a)}function q(a,b){return a.map(a=>{if((0,d.is)(a,z)){if(!(a.name in b))throw Error(`No value for placeholder "${a.name}" was provided`);return b[a.name]}if((0,d.is)(a,y)&&(0,d.is)(a.value,z)){if(!(a.value.name in b))throw Error(`No value for placeholder "${a.value.name}" was provided`);return a.encoder.mapToDriverValue(b[a.value.name])}return a})}let A=Symbol.for("drizzle:IsDrizzleView");class B{static [d.entityKind]="View";[h.ViewBaseConfig];[A]=!0;constructor({name:a,schema:b,selectedFields:c,query:d}){this[h.ViewBaseConfig]={name:a,originalName:a,schema:b,selectedFields:c,query:d,isExisting:!d,isAlias:!1}}getSQL(){return new t([this])}}function r(a){return"object"==typeof a&&null!==a&&A in a}function s(a){return a[h.ViewBaseConfig].name}i.Column.prototype.getSQL=function(){return new t([this])},j.Table.prototype.getSQL=function(){return new t([this])},f.Subquery.prototype.getSQL=function(){return new t([this])}}},241723:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({applyMixins:()=>m,getColumnNameAndConfig:()=>q,getTableColumns:()=>n,getTableLikeName:()=>p,getViewSelectedFields:()=>o,haveSameKeys:()=>k,isConfig:()=>r,mapResultRow:()=>j,mapUpdateSet:()=>l,orderSelectedFields:()=>function a(b,c){return Object.entries(b).reduce((b,[g,i])=>{if("string"!=typeof g)return b;let j=c?[...c,g]:[g];return(0,e.is)(i,d.Column)||(0,e.is)(i,f.SQL)||(0,e.is)(i,f.SQL.Aliased)?b.push({path:j,field:i}):(0,e.is)(i,h.Table)?b.push(...a(i[h.Table.Symbol.Columns],j)):b.push(...a(i,j)),b},[])}});var d=a.i(26736),e=a.i(873949),f=a.i(260708),g=a.i(564540),h=a.i(940702),i=a.i(671725);function j(a,b,c){let g={},i=a.reduce((a,{path:i,field:j},k)=>{let l;l=(0,e.is)(j,d.Column)?j:(0,e.is)(j,f.SQL)?j.decoder:j.sql.decoder;let m=a;for(let[a,f]of i.entries())if(a<i.length-1)f in m||(m[f]={}),m=m[f];else{let a=b[k],n=m[f]=null===a?null:l.mapFromDriverValue(a);if(c&&(0,e.is)(j,d.Column)&&2===i.length){let a=i[0];a in g?"string"==typeof g[a]&&g[a]!==(0,h.getTableName)(j.table)&&(g[a]=!1):g[a]=null===n&&(0,h.getTableName)(j.table)}}return a},{});if(c&&Object.keys(g).length>0)for(let[a,b]of Object.entries(g))"string"!=typeof b||c[b]||(i[a]=null);return i}function k(a,b){let c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(let[a,b]of c.entries())if(b!==d[a])return!1;return!0}function l(a,b){let c=Object.entries(b).filter(([,a])=>void 0!==a).map(([b,c])=>(0,e.is)(c,f.SQL)||(0,e.is)(c,d.Column)?[b,c]:[b,new f.Param(c,a[h.Table.Symbol.Columns][b])]);if(0===c.length)throw Error("No values to set");return Object.fromEntries(c)}function m(a,b){for(let c of b)for(let b of Object.getOwnPropertyNames(c.prototype))"constructor"!==b&&Object.defineProperty(a.prototype,b,Object.getOwnPropertyDescriptor(c.prototype,b)||Object.create(null))}function n(a){return a[h.Table.Symbol.Columns]}function o(a){return a[i.ViewBaseConfig].selectedFields}function p(a){return(0,e.is)(a,g.Subquery)?a._.alias:(0,e.is)(a,f.View)?a[i.ViewBaseConfig].name:(0,e.is)(a,f.SQL)?void 0:a[h.Table.Symbol.IsAlias]?a[h.Table.Symbol.Name]:a[h.Table.Symbol.BaseName]}function q(a,b){return{name:"string"==typeof a&&a.length>0?a:"",config:"object"==typeof a?a:b}}function r(a){if("object"!=typeof a||null===a||"Object"!==a.constructor.name)return!1;if("logger"in a){let b=typeof a.logger;return"boolean"===b||"object"===b&&"function"==typeof a.logger.logQuery||"undefined"===b}if("schema"in a){let b=typeof a.schema;return"object"===b||"undefined"===b}if("casing"in a){let b=typeof a.casing;return"string"===b||"undefined"===b}if("mode"in a)return"default"===a.mode&&"planetscale"===a.mode&&void 0===a.mode;if("connection"in a){let b=typeof a.connection;return"string"===b||"object"===b||"undefined"===b}if("client"in a){let b=typeof a.client;return"object"===b||"function"===b||"undefined"===b}return 0===Object.keys(a).length}},901770:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgIntColumnBaseBuilder:()=>b});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(a){if(a){let{name:b,...c}=a;this.config.generatedIdentity={type:"always",sequenceName:b,sequenceOptions:c}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(a){if(a){let{name:b,...c}=a;this.config.generatedIdentity={type:"byDefault",sequenceName:b,sequenceOptions:c}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}}},573931:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgBigInt53:()=>c,PgBigInt53Builder:()=>b,PgBigInt64:()=>j,PgBigInt64Builder:()=>i,bigint:()=>h});var d=a.i(873949),e=a.i(241723),f=a.i(716764),g=a.i(901770);class b extends g.PgIntColumnBaseBuilder{static [d.entityKind]="PgBigInt53Builder";constructor(a){super(a,"number","PgBigInt53")}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}}class i extends g.PgIntColumnBaseBuilder{static [d.entityKind]="PgBigInt64Builder";constructor(a){super(a,"bigint","PgBigInt64")}build(a){return new j(a,this.config)}}class j extends f.PgColumn{static [d.entityKind]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(a){return BigInt(a)}}function h(a,c){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return"number"===f.mode?new b(d):new i(d)}}},187401:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgBigSerial53:()=>c,PgBigSerial53Builder:()=>b,PgBigSerial64:()=>i,PgBigSerial64Builder:()=>h,bigserial:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgBigSerial53Builder";constructor(a){super(a,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}}class h extends f.PgColumnBuilder{static [d.entityKind]="PgBigSerial64Builder";constructor(a){super(a,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(a){return new i(a,this.config)}}class i extends f.PgColumn{static [d.entityKind]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(a){return BigInt(a)}}function g(a,c){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return"number"===f.mode?new b(d):new h(d)}}},523269:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgBoolean:()=>c,PgBooleanBuilder:()=>b,boolean:()=>f});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgBooleanBuilder";constructor(a){super(a,"boolean","PgBoolean")}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgBoolean";getSQLType(){return"boolean"}}function f(a){return new b(a??"")}}},892036:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgChar:()=>c,PgCharBuilder:()=>b,char:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgCharBuilder";constructor(a,b){super(a,"string","PgChar"),this.config.length=b.length,this.config.enumValues=b.enum}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function g(a,c={}){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return new b(d,f)}}},620733:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgCidr:()=>c,PgCidrBuilder:()=>b,cidr:()=>f});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgCidrBuilder";constructor(a){super(a,"string","PgCidr")}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgCidr";getSQLType(){return"cidr"}}function f(a){return new b(a??"")}}},897124:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgCustomColumn:()=>c,PgCustomColumnBuilder:()=>b,customType:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgCustomColumnBuilder";constructor(a,b,c){super(a,"custom","PgCustomColumn"),this.config.fieldConfig=b,this.config.customTypeParams=c}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(a,b){super(a,b),this.sqlName=b.customTypeParams.dataType(b.fieldConfig),this.mapTo=b.customTypeParams.toDriver,this.mapFrom=b.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(a){return"function"==typeof this.mapFrom?this.mapFrom(a):a}mapToDriverValue(a){return"function"==typeof this.mapTo?this.mapTo(a):a}}function g(a){return(c,d)=>{let{name:f,config:g}=(0,e.getColumnNameAndConfig)(c,d);return new b(f,g,a)}}}},216872:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgDateColumnBaseBuilder:()=>b});var d=a.i(873949),e=a.i(260708),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgDateColumnBaseBuilder";defaultNow(){return this.default(e.sql`now()`)}}}},924822:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgDate:()=>c,PgDateBuilder:()=>b,PgDateString:()=>j,PgDateStringBuilder:()=>i,date:()=>h});var d=a.i(873949),e=a.i(241723),f=a.i(716764),g=a.i(216872);class b extends g.PgDateColumnBaseBuilder{static [d.entityKind]="PgDateBuilder";constructor(a){super(a,"date","PgDate")}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgDate";getSQLType(){return"date"}mapFromDriverValue(a){return new Date(a)}mapToDriverValue(a){return a.toISOString()}}class i extends g.PgDateColumnBaseBuilder{static [d.entityKind]="PgDateStringBuilder";constructor(a){super(a,"string","PgDateString")}build(a){return new j(a,this.config)}}class j extends f.PgColumn{static [d.entityKind]="PgDateString";getSQLType(){return"date"}}function h(a,c){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return f?.mode==="date"?new b(d):new i(d)}}},427058:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgDoublePrecision:()=>c,PgDoublePrecisionBuilder:()=>b,doublePrecision:()=>f});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgDoublePrecisionBuilder";constructor(a){super(a,"number","PgDoublePrecision")}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(a){return"string"==typeof a?Number.parseFloat(a):a}}function f(a){return new b(a??"")}}},118861:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgInet:()=>c,PgInetBuilder:()=>b,inet:()=>f});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgInetBuilder";constructor(a){super(a,"string","PgInet")}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgInet";getSQLType(){return"inet"}}function f(a){return new b(a??"")}}},500627:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgInteger:()=>c,PgIntegerBuilder:()=>b,integer:()=>g});var d=a.i(873949),e=a.i(716764),f=a.i(901770);class b extends f.PgIntColumnBaseBuilder{static [d.entityKind]="PgIntegerBuilder";constructor(a){super(a,"number","PgInteger")}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(a){return"string"==typeof a?Number.parseInt(a):a}}function g(a){return new b(a??"")}}},881514:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgInterval:()=>c,PgIntervalBuilder:()=>b,interval:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgIntervalBuilder";constructor(a,b){super(a,"string","PgInterval"),this.config.intervalConfig=b}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let a=this.fields?` ${this.fields}`:"",b=this.precision?`(${this.precision})`:"";return`interval${a}${b}`}}function g(a,c={}){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return new b(d,f)}}},862253:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgJson:()=>c,PgJsonBuilder:()=>b,json:()=>f});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgJsonBuilder";constructor(a){super(a,"json","PgJson")}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgJson";constructor(a,b){super(a,b)}getSQLType(){return"json"}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){if("string"==typeof a)try{return JSON.parse(a)}catch{}return a}}function f(a){return new b(a??"")}}},377745:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgJsonb:()=>c,PgJsonbBuilder:()=>b,jsonb:()=>f});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgJsonbBuilder";constructor(a){super(a,"json","PgJsonb")}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgJsonb";constructor(a,b){super(a,b)}getSQLType(){return"jsonb"}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){if("string"==typeof a)try{return JSON.parse(a)}catch{}return a}}function f(a){return new b(a??"")}}},835642:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgLineABC:()=>i,PgLineABCBuilder:()=>h,PgLineBuilder:()=>b,PgLineTuple:()=>c,line:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgLineBuilder";constructor(a){super(a,"array","PgLine")}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgLine";getSQLType(){return"line"}mapFromDriverValue(a){let[b,c,d]=a.slice(1,-1).split(",");return[Number.parseFloat(b),Number.parseFloat(c),Number.parseFloat(d)]}mapToDriverValue(a){return`{${a[0]},${a[1]},${a[2]}}`}}class h extends f.PgColumnBuilder{static [d.entityKind]="PgLineABCBuilder";constructor(a){super(a,"json","PgLineABC")}build(a){return new i(a,this.config)}}class i extends f.PgColumn{static [d.entityKind]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(a){let[b,c,d]=a.slice(1,-1).split(",");return{a:Number.parseFloat(b),b:Number.parseFloat(c),c:Number.parseFloat(d)}}mapToDriverValue(a){return`{${a.a},${a.b},${a.c}}`}}function g(a,c){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return f?.mode&&"tuple"!==f.mode?new h(d):new b(d)}}},811343:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgMacaddr:()=>c,PgMacaddrBuilder:()=>b,macaddr:()=>f});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgMacaddrBuilder";constructor(a){super(a,"string","PgMacaddr")}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgMacaddr";getSQLType(){return"macaddr"}}function f(a){return new b(a??"")}}},513100:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgMacaddr8:()=>c,PgMacaddr8Builder:()=>b,macaddr8:()=>f});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgMacaddr8Builder";constructor(a){super(a,"string","PgMacaddr8")}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgMacaddr8";getSQLType(){return"macaddr8"}}function f(a){return new b(a??"")}}},486477:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgNumeric:()=>c,PgNumericBigInt:()=>k,PgNumericBigIntBuilder:()=>j,PgNumericBuilder:()=>b,PgNumericNumber:()=>i,PgNumericNumberBuilder:()=>h,decimal:()=>l,numeric:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgNumericBuilder";constructor(a,b,c){super(a,"string","PgNumeric"),this.config.precision=b,this.config.scale=c}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgNumeric";precision;scale;constructor(a,b){super(a,b),this.precision=b.precision,this.scale=b.scale}mapFromDriverValue(a){return"string"==typeof a?a:String(a)}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}class h extends f.PgColumnBuilder{static [d.entityKind]="PgNumericNumberBuilder";constructor(a,b,c){super(a,"number","PgNumericNumber"),this.config.precision=b,this.config.scale=c}build(a){return new i(a,this.config)}}class i extends f.PgColumn{static [d.entityKind]="PgNumericNumber";precision;scale;constructor(a,b){super(a,b),this.precision=b.precision,this.scale=b.scale}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}mapToDriverValue=String;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}class j extends f.PgColumnBuilder{static [d.entityKind]="PgNumericBigIntBuilder";constructor(a,b,c){super(a,"bigint","PgNumericBigInt"),this.config.precision=b,this.config.scale=c}build(a){return new k(a,this.config)}}class k extends f.PgColumn{static [d.entityKind]="PgNumericBigInt";precision;scale;constructor(a,b){super(a,b),this.precision=b.precision,this.scale=b.scale}mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}function g(a,c){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c),g=f?.mode;return"number"===g?new h(d,f?.precision,f?.scale):"bigint"===g?new j(d,f?.precision,f?.scale):new b(d,f?.precision,f?.scale)}let l=g}},736613:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgPointObject:()=>i,PgPointObjectBuilder:()=>h,PgPointTuple:()=>c,PgPointTupleBuilder:()=>b,point:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgPointTupleBuilder";constructor(a){super(a,"array","PgPointTuple")}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(a){if("string"==typeof a){let[b,c]=a.slice(1,-1).split(",");return[Number.parseFloat(b),Number.parseFloat(c)]}return[a.x,a.y]}mapToDriverValue(a){return`(${a[0]},${a[1]})`}}class h extends f.PgColumnBuilder{static [d.entityKind]="PgPointObjectBuilder";constructor(a){super(a,"json","PgPointObject")}build(a){return new i(a,this.config)}}class i extends f.PgColumn{static [d.entityKind]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(a){if("string"==typeof a){let[b,c]=a.slice(1,-1).split(",");return{x:Number.parseFloat(b),y:Number.parseFloat(c)}}return a}mapToDriverValue(a){return`(${a.x},${a.y})`}}function g(a,c){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return f?.mode&&"tuple"!==f.mode?new h(d):new b(d)}}},629466:a=>{"use strict";var{g:b,__dirname:c}=a;function d(a,b){let c=new DataView(new ArrayBuffer(8));for(let d=0;d<8;d++)c.setUint8(d,a[b+d]);return c.getFloat64(0,!0)}function e(a){let b=function(a){let b=[];for(let c=0;c<a.length;c+=2)b.push(Number.parseInt(a.slice(c,c+2),16));return new Uint8Array(b)}(a),c=0,e=b[0];c+=1;let f=new DataView(b.buffer),g=f.getUint32(c,1===e);if(c+=4,0x20000000&g&&(f.getUint32(c,1===e),c+=4),(65535&g)==1){let a=d(b,c),e=d(b,c+=8);return c+=8,[a,e]}throw Error("Unsupported geometry type")}a.s({parseEWKB:()=>e})},401759:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgGeometry:()=>c,PgGeometryBuilder:()=>b,PgGeometryObject:()=>j,PgGeometryObjectBuilder:()=>i,geometry:()=>h});var d=a.i(873949),e=a.i(241723),f=a.i(716764),g=a.i(629466);class b extends f.PgColumnBuilder{static [d.entityKind]="PgGeometryBuilder";constructor(a){super(a,"array","PgGeometry")}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(a){return(0,g.parseEWKB)(a)}mapToDriverValue(a){return`point(${a[0]} ${a[1]})`}}class i extends f.PgColumnBuilder{static [d.entityKind]="PgGeometryObjectBuilder";constructor(a){super(a,"json","PgGeometryObject")}build(a){return new j(a,this.config)}}class j extends f.PgColumn{static [d.entityKind]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(a){let b=(0,g.parseEWKB)(a);return{x:b[0],y:b[1]}}mapToDriverValue(a){return`point(${a.x} ${a.y})`}}function h(a,c){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return f?.mode&&"tuple"!==f.mode?new i(d):new b(d)}}},97403:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgReal:()=>c,PgRealBuilder:()=>b,real:()=>f});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgRealBuilder";constructor(a,b){super(a,"number","PgReal"),this.config.length=b}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgReal";constructor(a,b){super(a,b)}getSQLType(){return"real"}mapFromDriverValue=a=>"string"==typeof a?Number.parseFloat(a):a}function f(a){return new b(a??"")}}},821805:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgSerial:()=>c,PgSerialBuilder:()=>b,serial:()=>f});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgSerialBuilder";constructor(a){super(a,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgSerial";getSQLType(){return"serial"}}function f(a){return new b(a??"")}}},901616:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgSmallInt:()=>c,PgSmallIntBuilder:()=>b,smallint:()=>g});var d=a.i(873949),e=a.i(716764),f=a.i(901770);class b extends f.PgIntColumnBaseBuilder{static [d.entityKind]="PgSmallIntBuilder";constructor(a){super(a,"number","PgSmallInt")}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=a=>"string"==typeof a?Number(a):a}function g(a){return new b(a??"")}}},787283:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgSmallSerial:()=>c,PgSmallSerialBuilder:()=>b,smallserial:()=>f});var d=a.i(873949),e=a.i(716764);class b extends e.PgColumnBuilder{static [d.entityKind]="PgSmallSerialBuilder";constructor(a){super(a,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new c(a,this.config)}}class c extends e.PgColumn{static [d.entityKind]="PgSmallSerial";getSQLType(){return"smallserial"}}function f(a){return new b(a??"")}}},684701:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgText:()=>c,PgTextBuilder:()=>b,text:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgTextBuilder";constructor(a,b){super(a,"string","PgText"),this.config.enumValues=b.enum}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function g(a,c={}){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return new b(d,f)}}},969432:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgTime:()=>c,PgTimeBuilder:()=>b,time:()=>h});var d=a.i(873949),e=a.i(241723),f=a.i(716764),g=a.i(216872);class b extends g.PgDateColumnBaseBuilder{constructor(a,b,c){super(a,"string","PgTime"),this.withTimezone=b,this.precision=c,this.config.withTimezone=b,this.config.precision=c}static [d.entityKind]="PgTimeBuilder";build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgTime";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":`(${this.precision})`;return`time${a}${this.withTimezone?" with time zone":""}`}}function h(a,c={}){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return new b(d,f.withTimezone??!1,f.precision)}}},481795:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgTimestamp:()=>c,PgTimestampBuilder:()=>b,PgTimestampString:()=>j,PgTimestampStringBuilder:()=>i,timestamp:()=>h});var d=a.i(873949),e=a.i(241723),f=a.i(716764),g=a.i(216872);class b extends g.PgDateColumnBaseBuilder{static [d.entityKind]="PgTimestampBuilder";constructor(a,b,c){super(a,"date","PgTimestamp"),this.config.withTimezone=b,this.config.precision=c}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgTimestamp";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":` (${this.precision})`;return`timestamp${a}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=a=>new Date(this.withTimezone?a:a+"+0000");mapToDriverValue=a=>a.toISOString()}class i extends g.PgDateColumnBaseBuilder{static [d.entityKind]="PgTimestampStringBuilder";constructor(a,b,c){super(a,"string","PgTimestampString"),this.config.withTimezone=b,this.config.precision=c}build(a){return new j(a,this.config)}}class j extends f.PgColumn{static [d.entityKind]="PgTimestampString";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":`(${this.precision})`;return`timestamp${a}${this.withTimezone?" with time zone":""}`}}function h(a,c={}){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return f?.mode==="string"?new i(d,f.withTimezone??!1,f.precision):new b(d,f?.withTimezone??!1,f?.precision)}}},895908:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgUUID:()=>c,PgUUIDBuilder:()=>b,uuid:()=>g});var d=a.i(873949),e=a.i(260708),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgUUIDBuilder";constructor(a){super(a,"string","PgUUID")}defaultRandom(){return this.default(e.sql`gen_random_uuid()`)}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgUUID";getSQLType(){return"uuid"}}function g(a){return new b(a??"")}}},68827:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgVarchar:()=>c,PgVarcharBuilder:()=>b,varchar:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgVarcharBuilder";constructor(a,b){super(a,"string","PgVarchar"),this.config.length=b.length,this.config.enumValues=b.enum}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function g(a,c={}){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return new b(d,f)}}},956408:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgBinaryVector:()=>c,PgBinaryVectorBuilder:()=>b,bit:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgBinaryVectorBuilder";constructor(a,b){super(a,"string","PgBinaryVector"),this.config.dimensions=b.dimensions}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function g(a,c){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return new b(d,f)}}},850347:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgHalfVector:()=>c,PgHalfVectorBuilder:()=>b,halfvec:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgHalfVectorBuilder";constructor(a,b){super(a,"array","PgHalfVector"),this.config.dimensions=b.dimensions}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){return a.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}function g(a,c){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return new b(d,f)}}},682838:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgSparseVector:()=>c,PgSparseVectorBuilder:()=>b,sparsevec:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgSparseVectorBuilder";constructor(a,b){super(a,"string","PgSparseVector"),this.config.dimensions=b.dimensions}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function g(a,c){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return new b(d,f)}}},188363:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({PgVector:()=>c,PgVectorBuilder:()=>b,vector:()=>g});var d=a.i(873949),e=a.i(241723),f=a.i(716764);class b extends f.PgColumnBuilder{static [d.entityKind]="PgVectorBuilder";constructor(a,b){super(a,"array","PgVector"),this.config.dimensions=b.dimensions}build(a){return new c(a,this.config)}}class c extends f.PgColumn{static [d.entityKind]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){return a.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}function g(a,c){let{name:d,config:f}=(0,e.getColumnNameAndConfig)(a,c);return new b(d,f)}}},34452:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({getPgColumnBuilders:()=>J});var d=a.i(573931),e=a.i(187401),f=a.i(523269),g=a.i(892036),h=a.i(620733),i=a.i(897124),j=a.i(924822),k=a.i(427058),l=a.i(118861),m=a.i(500627),n=a.i(881514),o=a.i(862253),p=a.i(377745),q=a.i(835642),r=a.i(811343),s=a.i(513100),t=a.i(486477),u=a.i(736613),v=a.i(401759),w=a.i(97403),x=a.i(821805),y=a.i(901616),z=a.i(787283),A=a.i(684701),B=a.i(969432),C=a.i(481795),D=a.i(895908),E=a.i(68827),F=a.i(956408),G=a.i(850347),H=a.i(682838),I=a.i(188363);function J(){return{bigint:d.bigint,bigserial:e.bigserial,boolean:f.boolean,char:g.char,cidr:h.cidr,customType:i.customType,date:j.date,doublePrecision:k.doublePrecision,inet:l.inet,integer:m.integer,interval:n.interval,json:o.json,jsonb:p.jsonb,line:q.line,macaddr:r.macaddr,macaddr8:s.macaddr8,numeric:t.numeric,point:u.point,geometry:v.geometry,real:w.real,serial:x.serial,smallint:y.smallint,smallserial:z.smallserial,text:A.text,time:B.time,timestamp:C.timestamp,uuid:D.uuid,varchar:E.varchar,bit:F.bit,halfvec:G.halfvec,sparsevec:H.sparsevec,vector:I.vector}}},377608:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({EnableRLS:()=>c,InlineForeignKeys:()=>b,PgTable:()=>i,pgTable:()=>j,pgTableCreator:()=>h,pgTableWithSchema:()=>g});var d=a.i(873949),e=a.i(940702),f=a.i(34452);let b=Symbol.for("drizzle:PgInlineForeignKeys"),c=Symbol.for("drizzle:EnableRLS");class i extends e.Table{static [d.entityKind]="PgTable";static Symbol=Object.assign({},e.Table.Symbol,{InlineForeignKeys:b,EnableRLS:c});[b]=[];[c]=!1;[e.Table.Symbol.ExtraConfigBuilder]=void 0;[e.Table.Symbol.ExtraConfigColumns]={}}function g(a,c,d,h,j=a){let k=new i(a,h,j),l="function"==typeof c?c((0,f.getPgColumnBuilders)()):c,m=Object.fromEntries(Object.entries(l).map(([a,c])=>{c.setName(a);let d=c.build(k);return k[b].push(...c.buildForeignKeys(d,k)),[a,d]})),n=Object.fromEntries(Object.entries(l).map(([a,b])=>(b.setName(a),[a,b.buildExtraConfigColumn(k)]))),o=Object.assign(k,m);return o[e.Table.Symbol.Columns]=m,o[e.Table.Symbol.ExtraConfigColumns]=n,d&&(o[i.Symbol.ExtraConfigBuilder]=d),Object.assign(o,{enableRLS:()=>(o[i.Symbol.EnableRLS]=!0,o)})}let j=(a,b,c)=>g(a,b,c,void 0);function h(a){return(b,c,d)=>g(a(b),c,d,void 0,b)}}},186932:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({account:()=>i,apikey:()=>k,session:()=>c,user:()=>b,verification:()=>j});var d=a.i(377608),e=a.i(684701),f=a.i(481795),g=a.i(523269),h=a.i(500627);let b=(0,d.pgTable)("user",{id:(0,e.text)("id").primaryKey(),name:(0,e.text)("name").notNull(),email:(0,e.text)("email").notNull().unique(),emailVerified:(0,g.boolean)("email_verified").$defaultFn(()=>!1).notNull(),image:(0,e.text)("image"),createdAt:(0,f.timestamp)("created_at").$defaultFn(()=>new Date).notNull(),updatedAt:(0,f.timestamp)("updated_at").$defaultFn(()=>new Date).notNull(),role:(0,e.text)("role"),banned:(0,g.boolean)("banned"),banReason:(0,e.text)("ban_reason"),banExpires:(0,f.timestamp)("ban_expires"),stripeCustomerId:(0,e.text)("stripe_customer_id"),webhooksToEndpointsMigrated:(0,g.boolean)("webhooks_to_endpoints_migrated").default(!1),featureFlags:(0,e.text)("feature_flags")}),c=(0,d.pgTable)("session",{id:(0,e.text)("id").primaryKey(),expiresAt:(0,f.timestamp)("expires_at").notNull(),token:(0,e.text)("token").notNull().unique(),createdAt:(0,f.timestamp)("created_at").notNull(),updatedAt:(0,f.timestamp)("updated_at").notNull(),ipAddress:(0,e.text)("ip_address"),userAgent:(0,e.text)("user_agent"),userId:(0,e.text)("user_id").notNull().references(()=>b.id,{onDelete:"cascade"}),impersonatedBy:(0,e.text)("impersonated_by")}),i=(0,d.pgTable)("account",{id:(0,e.text)("id").primaryKey(),accountId:(0,e.text)("account_id").notNull(),providerId:(0,e.text)("provider_id").notNull(),userId:(0,e.text)("user_id").notNull().references(()=>b.id,{onDelete:"cascade"}),accessToken:(0,e.text)("access_token"),refreshToken:(0,e.text)("refresh_token"),idToken:(0,e.text)("id_token"),accessTokenExpiresAt:(0,f.timestamp)("access_token_expires_at"),refreshTokenExpiresAt:(0,f.timestamp)("refresh_token_expires_at"),scope:(0,e.text)("scope"),password:(0,e.text)("password"),createdAt:(0,f.timestamp)("created_at").notNull(),updatedAt:(0,f.timestamp)("updated_at").notNull()}),j=(0,d.pgTable)("verification",{id:(0,e.text)("id").primaryKey(),identifier:(0,e.text)("identifier").notNull(),value:(0,e.text)("value").notNull(),expiresAt:(0,f.timestamp)("expires_at").notNull(),createdAt:(0,f.timestamp)("created_at").$defaultFn(()=>new Date),updatedAt:(0,f.timestamp)("updated_at").$defaultFn(()=>new Date)}),k=(0,d.pgTable)("apikey",{id:(0,e.text)("id").primaryKey(),name:(0,e.text)("name"),start:(0,e.text)("start"),prefix:(0,e.text)("prefix"),key:(0,e.text)("key").notNull(),userId:(0,e.text)("user_id").notNull().references(()=>b.id,{onDelete:"cascade"}),refillInterval:(0,h.integer)("refill_interval"),refillAmount:(0,h.integer)("refill_amount"),lastRefillAt:(0,f.timestamp)("last_refill_at"),enabled:(0,g.boolean)("enabled").default(!0),rateLimitEnabled:(0,g.boolean)("rate_limit_enabled").default(!0),rateLimitTimeWindow:(0,h.integer)("rate_limit_time_window").default(864e5),rateLimitMax:(0,h.integer)("rate_limit_max").default(10),requestCount:(0,h.integer)("request_count"),remaining:(0,h.integer)("remaining"),lastRequest:(0,f.timestamp)("last_request"),expiresAt:(0,f.timestamp)("expires_at"),createdAt:(0,f.timestamp)("created_at").notNull(),updatedAt:(0,f.timestamp)("updated_at").notNull(),permissions:(0,e.text)("permissions"),metadata:(0,e.text)("metadata")})}},840347:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({DELIVERY_STATUS:()=>L,DELIVERY_TYPES:()=>F,DOMAIN_STATUS:()=>y,EMAIL_STATUS:()=>B,ENDPOINT_TYPES:()=>D,PROVIDER_CONFIDENCE:()=>A,SENT_EMAIL_STATUS:()=>M,SES_VERIFICATION_STATUS:()=>z,VIP_PAYMENT_STATUS:()=>K,WEBHOOK_FORMATS:()=>E,WEBHOOK_STATUS:()=>C,blockedEmails:()=>w,domainDnsRecords:()=>s,emailAddresses:()=>l,emailDomains:()=>k,emailGroups:()=>u,endpointDeliveries:()=>v,endpoints:()=>t,parsedEmails:()=>p,receivedEmails:()=>o,sentEmails:()=>x,sesEvents:()=>n,structuredEmails:()=>q,subscriptions:()=>b,userAccounts:()=>c,userOnboarding:()=>j,vipAllowedSenders:()=>I,vipConfigs:()=>G,vipEmailAttempts:()=>J,vipPaymentSessions:()=>H,webhookDeliveries:()=>r,webhooks:()=>m});var d=a.i(377608),e=a.i(68827),f=a.i(684701),g=a.i(481795),h=a.i(523269),i=a.i(500627);a.i(186932);let b=(0,d.pgTable)("subscriptions",{id:(0,e.varchar)("id",{length:255}).primaryKey(),plan:(0,e.varchar)("plan",{length:255}).notNull(),referenceId:(0,e.varchar)("reference_id",{length:255}).notNull(),stripeCustomerId:(0,e.varchar)("stripe_customer_id",{length:255}),stripeSubscriptionId:(0,e.varchar)("stripe_subscription_id",{length:255}),status:(0,e.varchar)("status",{length:255}).notNull(),periodStart:(0,g.timestamp)("period_start"),periodEnd:(0,g.timestamp)("period_end"),cancelAtPeriodEnd:(0,h.boolean)("cancel_at_period_end").default(!1),seats:(0,i.integer)("seats"),trialStart:(0,g.timestamp)("trial_start"),trialEnd:(0,g.timestamp)("trial_end"),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),c=(0,d.pgTable)("user_accounts",{id:(0,e.varchar)("id",{length:255}).primaryKey(),userId:(0,e.varchar)("user_id",{length:255}).notNull(),stripeRestrictedKey:(0,f.text)("stripe_restricted_key"),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),j=(0,d.pgTable)("user_onboarding",{id:(0,e.varchar)("id",{length:255}).primaryKey(),userId:(0,e.varchar)("user_id",{length:255}).notNull().unique(),isCompleted:(0,h.boolean)("is_completed").default(!1).notNull(),defaultEndpointCreated:(0,h.boolean)("default_endpoint_created").default(!1).notNull(),completedAt:(0,g.timestamp)("completed_at"),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),k=(0,d.pgTable)("email_domains",{id:(0,e.varchar)("id",{length:255}).primaryKey(),domain:(0,e.varchar)("domain",{length:255}).notNull().unique(),status:(0,e.varchar)("status",{length:50}).notNull(),verificationToken:(0,e.varchar)("verification_token",{length:255}),canReceiveEmails:(0,h.boolean)("can_receive_emails").default(!1),hasMxRecords:(0,h.boolean)("has_mx_records").default(!1),domainProvider:(0,e.varchar)("domain_provider",{length:100}),providerConfidence:(0,e.varchar)("provider_confidence",{length:20}),lastDnsCheck:(0,g.timestamp)("last_dns_check"),lastSesCheck:(0,g.timestamp)("last_ses_check"),isCatchAllEnabled:(0,h.boolean)("is_catch_all_enabled").default(!1),catchAllWebhookId:(0,e.varchar)("catch_all_webhook_id",{length:255}),catchAllEndpointId:(0,e.varchar)("catch_all_endpoint_id",{length:255}),catchAllReceiptRuleName:(0,e.varchar)("catch_all_receipt_rule_name",{length:255}),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow(),userId:(0,e.varchar)("user_id",{length:255}).notNull()}),l=(0,d.pgTable)("email_addresses",{id:(0,e.varchar)("id",{length:255}).primaryKey(),address:(0,e.varchar)("address",{length:255}).notNull().unique(),domainId:(0,e.varchar)("domain_id",{length:255}).notNull(),webhookId:(0,e.varchar)("webhook_id",{length:255}),endpointId:(0,e.varchar)("endpoint_id",{length:255}),isActive:(0,h.boolean)("is_active").default(!0),isReceiptRuleConfigured:(0,h.boolean)("is_receipt_rule_configured").default(!1),receiptRuleName:(0,e.varchar)("receipt_rule_name",{length:255}),isVipEnabled:(0,h.boolean)("is_vip_enabled").default(!1),vipConfigId:(0,e.varchar)("vip_config_id",{length:255}),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow(),userId:(0,e.varchar)("user_id",{length:255}).notNull()}),m=(0,d.pgTable)("webhooks",{id:(0,e.varchar)("id",{length:255}).primaryKey(),name:(0,e.varchar)("name",{length:255}).notNull(),url:(0,f.text)("url").notNull(),secret:(0,e.varchar)("secret",{length:255}),isActive:(0,h.boolean)("is_active").default(!0),description:(0,f.text)("description"),headers:(0,f.text)("headers"),timeout:(0,i.integer)("timeout").default(30),retryAttempts:(0,i.integer)("retry_attempts").default(3),lastUsed:(0,g.timestamp)("last_used"),totalDeliveries:(0,i.integer)("total_deliveries").default(0),successfulDeliveries:(0,i.integer)("successful_deliveries").default(0),failedDeliveries:(0,i.integer)("failed_deliveries").default(0),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow(),userId:(0,e.varchar)("user_id",{length:255}).notNull()}),n=(0,d.pgTable)("ses_events",{id:(0,e.varchar)("id",{length:255}).primaryKey(),eventSource:(0,e.varchar)("event_source",{length:100}).notNull(),eventVersion:(0,e.varchar)("event_version",{length:50}).notNull(),messageId:(0,e.varchar)("message_id",{length:255}).notNull(),source:(0,e.varchar)("source",{length:255}).notNull(),destination:(0,f.text)("destination").notNull(),subject:(0,f.text)("subject"),timestamp:(0,g.timestamp)("timestamp").notNull(),receiptTimestamp:(0,g.timestamp)("receipt_timestamp").notNull(),processingTimeMillis:(0,i.integer)("processing_time_millis"),recipients:(0,f.text)("recipients").notNull(),spamVerdict:(0,e.varchar)("spam_verdict",{length:50}),virusVerdict:(0,e.varchar)("virus_verdict",{length:50}),spfVerdict:(0,e.varchar)("spf_verdict",{length:50}),dkimVerdict:(0,e.varchar)("dkim_verdict",{length:50}),dmarcVerdict:(0,e.varchar)("dmarc_verdict",{length:50}),actionType:(0,e.varchar)("action_type",{length:50}),s3BucketName:(0,e.varchar)("s3_bucket_name",{length:255}),s3ObjectKey:(0,e.varchar)("s3_object_key",{length:500}),emailContent:(0,f.text)("email_content"),s3ContentFetched:(0,h.boolean)("s3_content_fetched").default(!1),s3ContentSize:(0,i.integer)("s3_content_size"),s3Error:(0,f.text)("s3_error"),commonHeaders:(0,f.text)("common_headers"),rawSesEvent:(0,f.text)("raw_ses_event").notNull(),lambdaContext:(0,f.text)("lambda_context"),webhookPayload:(0,f.text)("webhook_payload"),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),o=(0,d.pgTable)("received_emails",{id:(0,e.varchar)("id",{length:255}).primaryKey(),sesEventId:(0,e.varchar)("ses_event_id",{length:255}).notNull(),messageId:(0,e.varchar)("message_id",{length:255}).notNull(),from:(0,e.varchar)("from",{length:255}).notNull(),to:(0,f.text)("to").notNull(),recipient:(0,e.varchar)("recipient",{length:255}).notNull(),subject:(0,f.text)("subject"),fromParsed:(0,f.text)("from_parsed"),toParsed:(0,f.text)("to_parsed"),ccParsed:(0,f.text)("cc_parsed"),bccParsed:(0,f.text)("bcc_parsed"),replyToParsed:(0,f.text)("reply_to_parsed"),textBody:(0,f.text)("text_body"),htmlBody:(0,f.text)("html_body"),rawEmailContent:(0,f.text)("raw_email_content"),inReplyTo:(0,e.varchar)("in_reply_to",{length:255}),references:(0,f.text)("references"),priority:(0,e.varchar)("priority",{length:50}),attachments:(0,f.text)("attachments"),headers:(0,f.text)("headers"),emailDate:(0,g.timestamp)("email_date"),receivedAt:(0,g.timestamp)("received_at").notNull(),processedAt:(0,g.timestamp)("processed_at"),status:(0,e.varchar)("status",{length:50}).notNull(),isRead:(0,h.boolean)("is_read").default(!1),readAt:(0,g.timestamp)("read_at"),metadata:(0,f.text)("metadata"),userId:(0,e.varchar)("user_id",{length:255}).notNull(),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),p=(0,d.pgTable)("parsed_emails",{id:(0,e.varchar)("id",{length:255}).primaryKey(),emailId:(0,e.varchar)("email_id",{length:255}).notNull(),messageId:(0,e.varchar)("message_id",{length:255}),fromText:(0,f.text)("from_text"),fromAddress:(0,e.varchar)("from_address",{length:255}),fromName:(0,e.varchar)("from_name",{length:255}),toText:(0,f.text)("to_text"),toAddresses:(0,f.text)("to_addresses"),ccText:(0,f.text)("cc_text"),ccAddresses:(0,f.text)("cc_addresses"),bccText:(0,f.text)("bcc_text"),bccAddresses:(0,f.text)("bcc_addresses"),replyToText:(0,f.text)("reply_to_text"),replyToAddresses:(0,f.text)("reply_to_addresses"),subject:(0,f.text)("subject"),textBody:(0,f.text)("text_body"),htmlBody:(0,f.text)("html_body"),inReplyTo:(0,e.varchar)("in_reply_to",{length:255}),references:(0,f.text)("references"),priority:(0,e.varchar)("priority",{length:50}),emailDate:(0,g.timestamp)("email_date"),attachments:(0,f.text)("attachments"),attachmentCount:(0,i.integer)("attachment_count").default(0),hasAttachments:(0,h.boolean)("has_attachments").default(!1),headers:(0,f.text)("headers"),hasTextBody:(0,h.boolean)("has_text_body").default(!1),hasHtmlBody:(0,h.boolean)("has_html_body").default(!1),parseSuccess:(0,h.boolean)("parse_success").default(!0),parseError:(0,f.text)("parse_error"),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),q=(0,d.pgTable)("structured_emails",{id:(0,e.varchar)("id",{length:255}).primaryKey(),emailId:(0,e.varchar)("email_id",{length:255}).notNull(),sesEventId:(0,e.varchar)("ses_event_id",{length:255}).notNull(),messageId:(0,e.varchar)("message_id",{length:255}),date:(0,g.timestamp)("date"),subject:(0,f.text)("subject"),fromData:(0,f.text)("from_data"),toData:(0,f.text)("to_data"),ccData:(0,f.text)("cc_data"),bccData:(0,f.text)("bcc_data"),replyToData:(0,f.text)("reply_to_data"),inReplyTo:(0,e.varchar)("in_reply_to",{length:255}),references:(0,f.text)("references"),textBody:(0,f.text)("text_body"),htmlBody:(0,f.text)("html_body"),rawContent:(0,f.text)("raw_content"),attachments:(0,f.text)("attachments"),headers:(0,f.text)("headers"),priority:(0,e.varchar)("priority",{length:50}),parseSuccess:(0,h.boolean)("parse_success").default(!0),parseError:(0,f.text)("parse_error"),isRead:(0,h.boolean)("is_read").default(!1),readAt:(0,g.timestamp)("read_at"),isArchived:(0,h.boolean)("is_archived").default(!1),archivedAt:(0,g.timestamp)("archived_at"),userId:(0,e.varchar)("user_id",{length:255}).notNull(),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),r=(0,d.pgTable)("webhook_deliveries",{id:(0,e.varchar)("id",{length:255}).primaryKey(),emailId:(0,e.varchar)("email_id",{length:255}),webhookId:(0,e.varchar)("webhook_id",{length:255}).notNull(),endpoint:(0,e.varchar)("endpoint",{length:500}).notNull(),payload:(0,f.text)("payload"),status:(0,e.varchar)("status",{length:50}).notNull(),attempts:(0,i.integer)("attempts").default(0),lastAttemptAt:(0,g.timestamp)("last_attempt_at"),responseCode:(0,i.integer)("response_code"),responseBody:(0,f.text)("response_body"),error:(0,f.text)("error"),deliveryTime:(0,i.integer)("delivery_time"),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),s=(0,d.pgTable)("domain_dns_records",{id:(0,e.varchar)("id",{length:255}).primaryKey(),domainId:(0,e.varchar)("domain_id",{length:255}).notNull(),recordType:(0,e.varchar)("record_type",{length:10}).notNull(),name:(0,e.varchar)("name",{length:255}).notNull(),value:(0,f.text)("value").notNull(),isRequired:(0,h.boolean)("is_required").default(!0),isVerified:(0,h.boolean)("is_verified").default(!1),lastChecked:(0,g.timestamp)("last_checked"),createdAt:(0,g.timestamp)("created_at").defaultNow()}),t=(0,d.pgTable)("endpoints",{id:(0,e.varchar)("id",{length:255}).primaryKey(),name:(0,e.varchar)("name",{length:255}).notNull(),type:(0,e.varchar)("type",{length:50}).notNull(),webhookFormat:(0,e.varchar)("webhook_format",{length:50}).default("inbound"),config:(0,f.text)("config").notNull(),isActive:(0,h.boolean)("is_active").default(!0),description:(0,f.text)("description"),userId:(0,e.varchar)("user_id",{length:255}).notNull(),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),u=(0,d.pgTable)("email_groups",{id:(0,e.varchar)("id",{length:255}).primaryKey(),endpointId:(0,e.varchar)("endpoint_id",{length:255}).notNull(),emailAddress:(0,e.varchar)("email_address",{length:255}).notNull(),createdAt:(0,g.timestamp)("created_at").defaultNow()}),v=(0,d.pgTable)("endpoint_deliveries",{id:(0,e.varchar)("id",{length:255}).primaryKey(),emailId:(0,e.varchar)("email_id",{length:255}),endpointId:(0,e.varchar)("endpoint_id",{length:255}).notNull(),deliveryType:(0,e.varchar)("delivery_type",{length:50}).notNull(),status:(0,e.varchar)("status",{length:50}).notNull(),attempts:(0,i.integer)("attempts").default(0),lastAttemptAt:(0,g.timestamp)("last_attempt_at"),responseData:(0,f.text)("response_data"),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),w=(0,d.pgTable)("blocked_emails",{id:(0,e.varchar)("id",{length:255}).primaryKey(),emailAddress:(0,e.varchar)("email_address",{length:255}).notNull().unique(),domainId:(0,e.varchar)("domain_id",{length:255}).notNull(),reason:(0,f.text)("reason"),blockedBy:(0,e.varchar)("blocked_by",{length:255}).notNull(),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),x=(0,d.pgTable)("sent_emails",{id:(0,e.varchar)("id",{length:255}).primaryKey(),from:(0,e.varchar)("from",{length:500}).notNull(),fromAddress:(0,e.varchar)("from_address",{length:255}).notNull(),fromDomain:(0,e.varchar)("from_domain",{length:255}).notNull(),to:(0,f.text)("to").notNull(),cc:(0,f.text)("cc"),bcc:(0,f.text)("bcc"),replyTo:(0,f.text)("reply_to"),subject:(0,f.text)("subject").notNull(),textBody:(0,f.text)("text_body"),htmlBody:(0,f.text)("html_body"),headers:(0,f.text)("headers"),attachments:(0,f.text)("attachments"),status:(0,e.varchar)("status",{length:50}).notNull().default("pending"),messageId:(0,e.varchar)("message_id",{length:255}),provider:(0,e.varchar)("provider",{length:50}).default("ses"),providerResponse:(0,f.text)("provider_response"),sentAt:(0,g.timestamp)("sent_at"),failureReason:(0,f.text)("failure_reason"),idempotencyKey:(0,e.varchar)("idempotency_key",{length:256}),userId:(0,e.varchar)("user_id",{length:255}).notNull(),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),y={PENDING:"pending",VERIFIED:"verified",FAILED:"failed"},z={PENDING:"Pending",SUCCESS:"Success",FAILED:"Failed"},A={HIGH:"high",MEDIUM:"medium",LOW:"low"},B={RECEIVED:"received",PROCESSING:"processing",FORWARDED:"forwarded",FAILED:"failed",BLOCKED:"blocked"},C={PENDING:"pending",SUCCESS:"success",FAILED:"failed"},D={WEBHOOK:"webhook",EMAIL:"email",EMAIL_GROUP:"email_group"},E={INBOUND:"inbound",DISCORD:"discord",SLACK:"slack"},F={WEBHOOK:"webhook",EMAIL:"email",EMAILGROUP:"emailgroup"},G=(0,d.pgTable)("vip_configs",{id:(0,e.varchar)("id",{length:255}).primaryKey(),emailAddressId:(0,e.varchar)("email_address_id",{length:255}).notNull().unique(),userId:(0,e.varchar)("user_id",{length:255}).notNull(),priceInCents:(0,i.integer)("price_in_cents").notNull().default(100),allowAfterPayment:(0,h.boolean)("allow_after_payment").default(!1),customMessage:(0,f.text)("custom_message"),paymentLinkExpirationHours:(0,i.integer)("payment_link_expiration_hours").default(24),isActive:(0,h.boolean)("is_active").default(!0),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),H=(0,d.pgTable)("vip_payment_sessions",{id:(0,e.varchar)("id",{length:255}).primaryKey(),vipConfigId:(0,e.varchar)("vip_config_id",{length:255}).notNull(),senderEmail:(0,e.varchar)("sender_email",{length:255}).notNull(),originalEmailId:(0,e.varchar)("original_email_id",{length:255}).notNull(),stripePaymentLinkId:(0,e.varchar)("stripe_payment_link_id",{length:255}),stripePaymentLinkUrl:(0,f.text)("stripe_payment_link_url"),stripeSessionId:(0,e.varchar)("stripe_session_id",{length:255}),status:(0,e.varchar)("status",{length:50}).notNull().default("pending"),paidAt:(0,g.timestamp)("paid_at"),expiresAt:(0,g.timestamp)("expires_at"),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),I=(0,d.pgTable)("vip_allowed_senders",{id:(0,e.varchar)("id",{length:255}).primaryKey(),vipConfigId:(0,e.varchar)("vip_config_id",{length:255}).notNull(),senderEmail:(0,e.varchar)("sender_email",{length:255}).notNull(),allowedAt:(0,g.timestamp)("allowed_at").defaultNow(),allowedUntil:(0,g.timestamp)("allowed_until"),paymentSessionId:(0,e.varchar)("payment_session_id",{length:255}),createdAt:(0,g.timestamp)("created_at").defaultNow()}),J=(0,d.pgTable)("vip_email_attempts",{id:(0,e.varchar)("id",{length:255}).primaryKey(),vipConfigId:(0,e.varchar)("vip_config_id",{length:255}).notNull(),senderEmail:(0,e.varchar)("sender_email",{length:255}).notNull(),recipientEmail:(0,e.varchar)("recipient_email",{length:255}).notNull(),originalEmailId:(0,e.varchar)("original_email_id",{length:255}).notNull(),emailSubject:(0,f.text)("email_subject"),status:(0,e.varchar)("status",{length:50}).notNull().default("payment_required"),paymentSessionId:(0,e.varchar)("payment_session_id",{length:255}),allowedReason:(0,e.varchar)("allowed_reason",{length:100}),createdAt:(0,g.timestamp)("created_at").defaultNow(),updatedAt:(0,g.timestamp)("updated_at").defaultNow()}),K={PENDING:"pending",PAID:"paid",EXPIRED:"expired",CANCELLED:"cancelled"},L={PENDING:"pending",SUCCESS:"success",FAILED:"failed"},M={PENDING:"pending",SENT:"sent",FAILED:"failed"}}},191712:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({}),a.i(186932),a.i(840347)},648788:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({__iconNode:()=>b,default:()=>c});var d=a.i(528442);let b=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],c=(0,d.default)("triangle-alert",b)}},380923:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({AlertTriangle:()=>d.default});var d=a.i(648788)},321540:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({DeleteConfirmationDialog:()=>h});var d=a.i(674420),e=a.i(232997),f=a.i(378903),g=a.i(380923);function h({open:a,onOpenChange:b,onConfirm:c,title:h,description:i,itemName:j,itemType:k="item",isLoading:l=!1}){let m=h||`Delete ${k}`,n=i||`Are you sure you want to delete ${j?`"${j}"`:`this ${k}`}? This action cannot be undone.`;return(0,d.jsx)(e.Dialog,{open:a,onOpenChange:b,children:(0,d.jsxs)(e.DialogContent,{className:"sm:max-w-md",children:[(0,d.jsxs)(e.DialogHeader,{children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-destructive/10",children:(0,d.jsx)(g.AlertTriangle,{className:"h-5 w-5 text-destructive"})}),(0,d.jsx)(e.DialogTitle,{className:"text-left",children:m})]}),(0,d.jsx)(e.DialogDescription,{className:"text-left mt-2",children:n})]}),(0,d.jsxs)(e.DialogFooter,{className:"flex items-center gap-2 sm:gap-2",children:[(0,d.jsx)(f.Button,{variant:"secondary",onClick:()=>b(!1),disabled:l,children:"Cancel"}),(0,d.jsx)(f.Button,{variant:"destructive",onClick:()=>{c()},disabled:l,children:l?"Deleting...":"Delete"})]})]})})}},868329:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({default:()=>P});var d=a.i(674420),e=a.i(722851),f=a.i(714513),g=a.i(918656),h=a.i(816486),i=a.i(123546),j=a.i(238769),k=a.i(378903),l=a.i(668018),m=a.i(386483),n=a.i(222239),o=a.i(791347),p=a.i(232997),q=a.i(180214),r=a.i(693610),s=a.i(667780),t=a.i(816692),u=a.i(960830),v=a.i(342064),w=a.i(2151),x=a.i(566825),y=a.i(195743),z=a.i(520910),A=a.i(569164),B=a.i(483182),C=a.i(188126),D=a.i(840462),E=a.i(300096),F=a.i(313812),G=a.i(323772);a.i(191712);var H=a.i(840347),I=a.i(526146),J=a.i(494334),K=a.i(321540),L=a.i(18337),M=a.i(378727);a.i(440712);var N=a.i(12237),O=a.i(790024);function P(){let{data:a}=(0,f.useSession)(),b=(0,g.useParams)(),c=(0,g.useRouter)(),P=b.id,Q=(0,M.useQueryClient)(),{data:R,isLoading:S,error:T,refetch:U}=(0,O.useDomainDetailsV2Query)(P),{data:V,isLoading:W,refetch:X}=(0,L.useQuery)({queryKey:[...O.domainV2Keys.emailAddresses(P)],queryFn:async()=>{let a=await fetch(`/api/v2/email-addresses?domainId=${P}`);if(!a.ok)throw Error((await a.json()).error||"Failed to fetch email addresses");return a.json()},enabled:!!P&&R?.status==="verified",staleTime:12e4,gcTime:6e5}),{data:Y,isLoading:Z}=(0,L.useQuery)({queryKey:["dnsRecords",P],queryFn:async()=>{let a=await fetch(`/api/v2/domains/${P}/dns-records`);if(!a.ok)throw Error((await a.json()).error||"Failed to fetch DNS records");return a.json()},enabled:!!P&&R?.status==="pending",staleTime:12e4,gcTime:6e5}),{data:$=[],isLoading:_}=(0,N.useEndpointsQuery)();(0,O.useDomainVerificationCheckV2)(P);let aa=(0,O.useDeleteDomainV2Mutation)(),ab=(0,O.useAddEmailAddressV2Mutation)(),ac=(0,O.useDeleteEmailAddressV2Mutation)(),ad=(0,O.useUpdateEmailEndpointV2Mutation)(),ae=(0,O.useUpdateDomainCatchAllV2Mutation)(),[af,ag]=(0,e.useState)(""),[ah,ai]=(0,e.useState)("none"),[aj,ak]=(0,e.useState)(null),[al,am]=(0,e.useState)(!1),[an,ao]=(0,e.useState)(new Set),[ap,aq]=(0,e.useState)(!1),[ar,as]=(0,e.useState)(!1),[at,au]=(0,e.useState)(""),[av,aw]=(0,e.useState)(!1),[ax,ay]=(0,e.useState)(!1),[az,aA]=(0,e.useState)(null),[aB,aC]=(0,e.useState)("none"),[aD,aE]=(0,e.useState)("none"),[aF,aG]=(0,e.useState)(null);(0,e.useState)(()=>{R?.catchAllEndpointId&&aE(R.catchAllEndpointId)});let aH=V?.data||[],aI=a=>{let b=new Set(an);b.has(a)?b.delete(a):b.add(a),ao(b)},aJ=async()=>{if(R?.domain)try{await navigator.clipboard.writeText(R.domain),aw(!0),G.toast.success("Domain copied to clipboard"),setTimeout(()=>{aw(!1)},2e3)}catch(a){G.toast.error("Failed to copy domain")}},aK=async()=>{console.log(" Forcing domain verification check..."),am(!0);try{let a=await fetch(`/api/v2/domains/${P}?check=true`);if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to check domain verification")}let b=await a.json();if(Q.setQueryData(O.domainV2Keys.detail(P),b),R?.status==="pending"&&"verified"===b.status)G.toast.success("Domain verified successfully!"),await X();else if("verified"===b.status)G.toast.success("Domain is already verified");else if("failed"===b.status)G.toast.error("Domain verification failed. Please check your DNS records.");else if(b.verificationCheck){let{dnsRecords:a,sesStatus:c}=b.verificationCheck,d=a?.filter(a=>!a.isVerified)||[];if(d.length>0){let a=d.find(a=>"MX"===a.type);if(a&&a.error){let b=a.value,c=a.error.match(/but found: \[(.*?)\]/)?.[1];c&&c.includes(`.${R?.domain||""}`)?G.toast.error(`MX record issue: Remove ".${R?.domain||""}" from the end of your MX record value. It should be just "${b.split(" ")[1]}"`,{duration:8e3}):G.toast.warning(`${d.length} DNS record(s) still pending verification`)}else{let a=d.map(a=>a.type).join(", ");G.toast.warning(`DNS records not verified: ${a}`)}}else"Success"!==c?G.toast.info(`DNS records verified. Email status: ${c}`):G.toast.info("Verification in progress...")}else G.toast.info("Verification status refreshed")}catch(a){console.error("Error refreshing verification:",a),G.toast.error("Failed to refresh verification status")}finally{am(!1)}},aL=async()=>{if(R&&af.trim()){ak(null);try{let a=af.includes("@")?af:`${af}@${R.domain}`;await ab.mutateAsync({address:a,domainId:P,endpointId:"none"===ah?void 0:ah}),ag(""),ai("none"),G.toast.success("Email address added successfully")}catch(b){let a=b instanceof Error?b.message:"Failed to add email address";ak(a),G.toast.error(a)}}},aM=(a,b)=>{aG({id:a,address:b})},aN=async()=>{if(aF&&R)try{await ac.mutateAsync({emailAddressId:aF.id,domainId:P}),aG(null)}catch(a){G.toast.error(a instanceof Error?a.message:"Failed to delete email address")}},aO=async()=>{if(R&&0!==an.size)try{let a=Array.from(an).map(a=>ac.mutateAsync({emailAddressId:a,domainId:P}));await Promise.all(a),G.toast.success(`Successfully deleted ${an.size} email address${an.size>1?"es":""}`),ao(new Set),aq(!1)}catch(a){G.toast.error(a instanceof Error?a.message:"Failed to delete some email addresses")}},aP=async()=>{if(R){if(at!==R.domain)return void G.toast.error("Please type the domain name exactly to confirm deletion");try{await aa.mutateAsync(P),G.toast.success("Domain deleted successfully"),as(!1),c.push("/emails")}catch(a){G.toast.error(a instanceof Error?a.message:"Failed to delete domain")}}},aQ=async()=>{if(az){console.log(" Updating email endpoint:",{emailId:az.id,currentEndpointId:az.endpointId,newEndpointId:"none"===aB?null:aB,domainId:P});try{let a=await ad.mutateAsync({emailAddressId:az.id,endpointId:"none"===aB?null:aB,domainId:P});console.log(" Update result:",a),G.toast.success("Endpoint updated successfully"),ay(!1),aA(null),aC("none"),await X()}catch(a){console.error(" Update failed:",a),G.toast.error(a instanceof Error?a.message:"Failed to update endpoint")}}},aR=a=>{aA(a),aC(a.endpointId||a.webhookId||"none"),ay(!0)},aS=async()=>{if(R)try{if(R.isCatchAllEnabled)await ae.mutateAsync({domainId:P,isCatchAllEnabled:!1,catchAllEndpointId:null}),G.toast.success("Catch-all disabled successfully");else{if("none"===aD)return void G.toast.error("Please select an endpoint for catch-all emails");await ae.mutateAsync({domainId:P,isCatchAllEnabled:!0,catchAllEndpointId:aD}),G.toast.success("Catch-all enabled successfully")}}catch(a){G.toast.error(a instanceof Error?a.message:"Failed to toggle catch-all")}};if(S)return(0,d.jsxs)("div",{className:"flex flex-1 flex-col gap-6 p-6",children:[(0,d.jsx)("div",{className:"flex items-center gap-4",children:(0,d.jsx)("div",{className:"h-4 w-24 bg-muted animate-pulse rounded"})}),(0,d.jsx)("div",{className:"h-32 bg-muted animate-pulse rounded-lg"}),(0,d.jsx)("div",{className:"h-64 bg-muted animate-pulse rounded-lg"})]});if(T||!R)return(0,d.jsxs)("div",{className:"flex flex-1 flex-col gap-6 p-6",children:[(0,d.jsx)("div",{className:"flex items-center gap-4",children:(0,d.jsx)(h.default,{href:"/emails",children:(0,d.jsxs)(k.Button,{variant:"ghost",size:"sm",children:[(0,d.jsx)(r.default,{width:"16",height:"16",className:"mr-2"}),"Back to Domains"]})})}),(0,d.jsx)(i.Card,{className:"border-destructive/50 bg-destructive/10",children:(0,d.jsx)(i.CardContent,{className:"pt-6",children:(0,d.jsxs)("div",{className:"flex items-center gap-2 text-destructive",children:[(0,d.jsx)(D.default,{width:"16",height:"16"}),(0,d.jsx)("span",{children:T instanceof Error?T.message:"Domain not found"}),(0,d.jsx)(k.Button,{variant:"ghost",size:"sm",onClick:()=>U(),className:"ml-auto text-destructive hover:text-destructive",children:"Try Again"})]})})})]});let{domain:aT,status:aU,stats:aV={totalEmailAddresses:0,activeEmailAddresses:0,emailsLast24h:0,emailsLast7d:0,emailsLast30d:0}}=R,aW=a=>{switch(a?.type){case"webhook":return E.default;case"email":default:return A.default;case"email_group":return F.default}},aX=a=>{if(!a?.isActive)return"#64748b";switch(a?.type){case"webhook":return"#8b5cf6";case"email":return"#3b82f6";case"email_group":return"#10b981";default:return"#6b7280"}},aY=aU===H.DOMAIN_STATUS.VERIFIED,aZ=aH.filter(a=>an.has(a.id));return(0,d.jsx)("div",{className:"h-full p-4 font-outfit",children:(0,d.jsxs)("div",{className:"max-w-4xl mx-auto space-y-4",children:[(0,d.jsx)("div",{className:"flex items-center",children:(0,d.jsxs)(h.default,{href:"/emails",className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground",children:[(0,d.jsx)(r.default,{width:"16",height:"16"}),"Back to Domains"]})}),(0,d.jsxs)("div",{className:"flex items-center justify-between bg-card text-card-foreground rounded-lg p-4 border border-border",children:[(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsx)(x.CustomInboundIcon,{Icon:z.default,size:40,backgroundColor:"#3b82f6"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-xl font-semibold mb-1",children:aT}),(0,d.jsxs)("div",{className:"text-sm text-muted-foreground",children:[aU===H.DOMAIN_STATUS.PENDING&&"Add DNS records to complete verification",aU===H.DOMAIN_STATUS.VERIFIED&&"Domain verified - manage email addresses below",aU===H.DOMAIN_STATUS.FAILED&&"Domain verification failed - please check your DNS records"]})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[aU===H.DOMAIN_STATUS.VERIFIED?(0,d.jsxs)(j.Badge,{className:"bg-emerald-500 text-white rounded-full px-2.5 py-0.5 text-xs font-medium shadow-sm pointer-events-none",children:[(0,d.jsx)(y.default,{width:"12",height:"12",className:"mr-1"}),"Verified"]}):aU===H.DOMAIN_STATUS.PENDING?(0,d.jsxs)(j.Badge,{className:"bg-amber-500 text-white rounded-full px-2.5 py-0.5 text-xs font-medium shadow-sm pointer-events-none",children:[(0,d.jsx)(q.default,{width:"12",height:"12",className:"mr-1"}),"Pending"]}):(0,d.jsxs)(j.Badge,{className:"bg-red-500 text-white rounded-full px-2.5 py-0.5 text-xs font-medium shadow-sm pointer-events-none",children:[(0,d.jsx)(D.default,{width:"12",height:"12",className:"mr-1"}),"Failed"]}),(0,d.jsxs)(k.Button,{variant:"secondary",size:"sm",onClick:aK,disabled:al,className:"flex items-center gap-2",children:[(0,d.jsx)(C.default,{width:"16",height:"16",className:al?"animate-spin":""}),al?"Checking...":"Refresh"]}),(0,d.jsxs)(p.Dialog,{open:ar,onOpenChange:as,children:[(0,d.jsxs)(k.Button,{variant:"destructive",size:"sm",onClick:()=>as(!0),children:[(0,d.jsx)(u.default,{width:"16",height:"16",className:"mr-2"}),"Delete"]}),(0,d.jsxs)(p.DialogContent,{children:[(0,d.jsxs)(p.DialogHeader,{children:[(0,d.jsx)(p.DialogTitle,{children:"Delete Domain"}),(0,d.jsxs)(p.DialogDescription,{children:['This action cannot be undone. This will permanently delete the domain "',aT,'" and all associated email addresses and data.']})]}),(0,d.jsx)("div",{className:"space-y-4",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)(m.Label,{htmlFor:"delete-confirm",children:["Type ",(0,d.jsxs)("strong",{className:"cursor-pointer hover:bg-muted px-1 py-0.5 rounded transition-colors inline-flex items-center gap-1 p-1 bg-muted",onClick:aJ,children:[aT," ",av?(0,d.jsx)(y.default,{width:"16",height:"16",className:"text-green-600"}):(0,d.jsx)(t.default,{width:"16",height:"16"})]})," to confirm deletion:"]}),(0,d.jsx)(l.Input,{id:"delete-confirm",value:at,onChange:a=>au(a.target.value),placeholder:aT,className:"mt-2"})]})}),(0,d.jsxs)(p.DialogFooter,{children:[(0,d.jsx)(k.Button,{variant:"secondary",onClick:()=>{as(!1),au("")},children:"Cancel"}),(0,d.jsx)(k.Button,{variant:"destructive",onClick:aP,disabled:at!==aT,children:"Delete Domain"})]})]})]})]})]}),aU===H.DOMAIN_STATUS.PENDING&&(0,d.jsx)(J.default,{preloadedDomain:aT,preloadedDomainId:R.id,preloadedDnsRecords:Y?.records?.map(a=>({type:a.recordType,name:a.name,value:a.value,isVerified:a.isVerified}))||[],preloadedStep:1,preloadedProvider:R.domainProvider||void 0,overrideRefreshFunction:aK,onSuccess:a=>{U()}}),aY&&(0,d.jsxs)(i.Card,{className:"bg-card border-border rounded-xl",children:[(0,d.jsx)(i.CardHeader,{className:"pb-4",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(i.CardTitle,{className:"flex items-center gap-2 text-foreground text-lg",children:"Email Management"}),(0,d.jsx)(i.CardDescription,{className:"text-muted-foreground",children:R?.isCatchAllEnabled?`Catch-all enabled - all emails to @${aT} are captured`:`Manage individual email addresses for @${aT}`})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,d.jsx)(A.default,{width:"16",height:"16"}),aV.totalEmailAddresses," addresses",(0,d.jsx)("span",{className:"text-muted-foreground/60",children:""}),(0,d.jsx)(s.default,{width:"16",height:"16"}),aV.emailsLast24h," emails (24h)"]})]})}),(0,d.jsxs)(i.CardContent,{className:"space-y-4",children:[!R?.isCatchAllEnabled&&(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 w-full",children:[(0,d.jsx)("div",{className:"w-full sm:flex-1",children:(0,d.jsxs)("div",{className:"flex items-center border border-input rounded-xl bg-background h-10 w-full",children:[(0,d.jsx)(l.Input,{type:"text",placeholder:"username",value:af,onChange:a=>ag(a.target.value),onKeyDown:a=>{"Enter"===a.key&&af.trim()&&aL()},className:"border-0 rounded-r-none focus:ring-0 flex-1 h-full"}),(0,d.jsxs)("div",{className:"px-3 bg-muted border-l border-border text-sm text-muted-foreground rounded-r-lg flex items-center h-full whitespace-nowrap",children:["@",aT]})]})}),(0,d.jsxs)("div",{className:"flex gap-2 w-full sm:flex-1",children:[(0,d.jsxs)(I.Select,{value:ah,onValueChange:a=>{"create-new"===a?c.push("/endpoints"):ai(a)},disabled:_,children:[(0,d.jsx)(I.SelectTrigger,{className:"flex-1 h-10 min-w-0",children:(0,d.jsx)(I.SelectValue,{placeholder:"Endpoint (optional)"})}),(0,d.jsxs)(I.SelectContent,{children:[(0,d.jsx)(I.SelectItem,{value:"none",children:"Store in Inbound"}),(0,d.jsx)(I.SelectItem,{value:"create-new",className:"text-blue-600 font-medium",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(B.default,{width:"16",height:"16"}),"Create Endpoint"]})}),$.length>0&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"px-2 py-1 text-xs font-medium text-muted-foreground border-t",children:"Endpoints"}),$.map(a=>(0,d.jsx)(I.SelectItem,{value:a.id,children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(x.CustomInboundIcon,{Icon:aW(a),size:16,backgroundColor:aX(a)}),a.name," (",a.type,")"]})},a.id))]})]})]}),(0,d.jsx)(k.Button,{onClick:aL,disabled:!af.trim(),className:"shrink-0 h-10 w-10",children:(0,d.jsx)(B.default,{width:"16",height:"16"})})]})]}),aj&&(0,d.jsx)("p",{className:"text-sm text-red-600",children:aj}),(0,d.jsx)(o.Separator,{}),0===aH.length?(0,d.jsxs)("div",{className:"text-center py-8",children:[(0,d.jsx)(A.default,{width:"32",height:"32",className:"text-muted-foreground mx-auto mb-2"}),(0,d.jsx)("p",{className:"text-muted-foreground",children:"No email addresses configured"})]}):(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg border border-border",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(n.Checkbox,{checked:aH.length>0&&an.size===aH.length,onCheckedChange:()=>{0!==aH.length&&(an.size===aH.length?ao(new Set):ao(new Set(aH.map(a=>a.id))))},className:"h-4 w-4"}),(0,d.jsxs)("span",{className:"text-sm font-medium text-foreground",children:["Select all (",aH.length,")",an.size>0&&(0,d.jsxs)("span",{className:"text-blue-600 ml-2",children:[" ",an.size," selected"]})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[an.size>0&&(0,d.jsx)(k.Button,{variant:"ghost",size:"sm",onClick:()=>{ao(new Set)},className:"text-muted-foreground hover:text-foreground h-8 px-3",children:"Clear"}),(0,d.jsxs)(k.Button,{variant:"destructive",size:"sm",onClick:()=>aq(!0),disabled:0===an.size,className:"h-8",children:[(0,d.jsx)(u.default,{width:"16",height:"16",className:"mr-2"}),"Delete Selected"]})]})]}),aH.map(a=>(0,d.jsxs)("div",{className:`flex items-center justify-between p-3 rounded-lg border border-border transition-colors ${an.has(a.id)?"bg-accent/50 border-accent":"bg-muted/30 border-border"}`,children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(n.Checkbox,{checked:an.has(a.id),onCheckedChange:()=>aI(a.id),className:"h-4 w-4"}),(0,d.jsx)("div",{className:"font-mono text-sm",children:a.address}),(0,d.jsx)(k.Button,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(a.address),G.toast.success("Copied to clipboard")},className:"h-6 w-6 p-0",children:(0,d.jsx)(t.default,{width:"12",height:"12"})})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"text-sm text-muted-foreground",children:(()=>{console.log(" Routing:",a.routing);let b=a.routing;if("endpoint"===b.type&&b.id){let a=$.find(a=>a.id===b.id);if(a){let c=aW(a);return(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(x.CustomInboundIcon,{Icon:c,size:25,backgroundColor:aX(a)}),(0,d.jsx)("span",{className:"font-medium",style:{color:aX(a)},children:b.name})]})}}else if("webhook"===b.type&&b.id)return(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(x.CustomInboundIcon,{Icon:E.default,size:14,backgroundColor:"#8b5cf6"}),(0,d.jsx)("span",{className:"text-amber-600 font-medium",children:b.name||"Legacy Webhook"})]});return(0,d.jsx)("span",{className:"text-muted-foreground",children:"Store in Inbound"})})()}),(0,d.jsx)(k.Button,{variant:"ghost",size:"sm",onClick:()=>aR(a),className:"h-8 w-8 p-0",children:(0,d.jsx)(v.default,{width:"16",height:"16"})}),(0,d.jsx)(k.Button,{variant:"ghost",size:"sm",onClick:()=>aM(a.id,a.address),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:(0,d.jsx)(u.default,{width:"16",height:"16"})})]})]},a.id))]}),(0,d.jsx)("div",{className:"flex items-center justify-center pt-2",children:(0,d.jsxs)(h.default,{href:"/endpoints",className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700",children:[(0,d.jsx)(w.default,{width:"12",height:"12"}),"Manage all endpoints"]})})]}),R&&(0,d.jsxs)(d.Fragment,{children:[!R.isCatchAllEnabled&&(0,d.jsx)(o.Separator,{}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsx)("div",{className:"flex items-center justify-between",children:(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"font-medium text-foreground",children:"Catch-all Configuration"}),(0,d.jsx)("div",{className:"text-sm text-muted-foreground",children:R.isCatchAllEnabled?"All emails to any address are captured":"Capture emails to any address on this domain"})]})}),(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[!R.isCatchAllEnabled&&(0,d.jsx)("div",{className:"flex-1",children:(0,d.jsxs)(I.Select,{value:aD,onValueChange:a=>{"create-new"===a?c.push("/endpoints"):aE(a)},disabled:_,children:[(0,d.jsx)(I.SelectTrigger,{className:"w-full h-10",children:(0,d.jsx)(I.SelectValue,{placeholder:"Select endpoint"})}),(0,d.jsxs)(I.SelectContent,{children:[(0,d.jsx)(I.SelectItem,{value:"none",children:"Store in Inbound"}),(0,d.jsx)(I.SelectItem,{value:"create-new",className:"text-blue-600 font-medium",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(B.default,{width:"16",height:"16"}),"Create Endpoint"]})}),$.length>0&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"px-2 py-1 text-xs font-medium text-muted-foreground border-t",children:"Endpoints"}),$.map(a=>(0,d.jsx)(I.SelectItem,{value:a.id,children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(x.CustomInboundIcon,{Icon:aW(a),size:16,backgroundColor:aX(a)}),a.name," (",a.type,")"]})},a.id))]})]})]})}),(0,d.jsx)("div",{className:R.isCatchAllEnabled?"w-full":"w-full sm:w-auto sm:min-w-[140px]",children:(0,d.jsx)(k.Button,{variant:R.isCatchAllEnabled?"destructive":"secondary",className:"h-10 w-full",onClick:aS,disabled:!R.isCatchAllEnabled&&"none"===aD,children:R.isCatchAllEnabled?"Disable Catch-all":"Enable Catch-all"})})]})]})]})]})]}),(0,d.jsx)(p.Dialog,{open:ax,onOpenChange:ay,children:(0,d.jsxs)(p.DialogContent,{className:"sm:max-w-[425px]",children:[(0,d.jsxs)(p.DialogHeader,{children:[(0,d.jsx)(p.DialogTitle,{children:"Configure Endpoint"}),(0,d.jsxs)(p.DialogDescription,{children:["Configure endpoint for ",az?.address]})]}),(0,d.jsx)("div",{className:"grid gap-4 py-4",children:(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsx)(m.Label,{htmlFor:"endpoint-assignment",children:"Endpoint Assignment"}),(0,d.jsxs)(I.Select,{value:aB,onValueChange:a=>{"create-new"===a?c.push("/endpoints"):aC(a)},disabled:_,children:[(0,d.jsx)(I.SelectTrigger,{children:(0,d.jsx)(I.SelectValue,{placeholder:"Store in Inbound"})}),(0,d.jsxs)(I.SelectContent,{children:[(0,d.jsx)(I.SelectItem,{value:"none",children:"Store in Inbound"}),(0,d.jsx)(I.SelectItem,{value:"create-new",className:"text-blue-600 font-medium",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(B.default,{width:"16",height:"16"}),"Create New Endpoint"]})}),$.length>0&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"px-2 py-1 text-xs font-medium text-muted-foreground border-t",children:"Existing Endpoints"}),$.map(a=>(0,d.jsx)(I.SelectItem,{value:a.id,children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(x.CustomInboundIcon,{Icon:aW(a),size:16,backgroundColor:aX(a)}),(0,d.jsxs)("span",{children:[a.name," (",a.type,")"]})]})},a.id))]})]})]})]})}),(0,d.jsxs)(p.DialogFooter,{children:[(0,d.jsx)(k.Button,{variant:"secondary",onClick:()=>{ay(!1),aA(null),aC("none")},children:"Cancel"}),(0,d.jsx)(k.Button,{onClick:aQ,children:"Update Endpoint"})]})]})}),(0,d.jsx)(p.Dialog,{open:ap,onOpenChange:aq,children:(0,d.jsxs)(p.DialogContent,{className:"sm:max-w-[425px]",children:[(0,d.jsxs)(p.DialogHeader,{children:[(0,d.jsx)(p.DialogTitle,{children:"Delete Email Addresses"}),(0,d.jsxs)(p.DialogDescription,{children:["Are you sure you want to delete ",an.size," email address",an.size>1?"es":"","? This action cannot be undone."]})]}),(0,d.jsx)("div",{className:"py-4",children:(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Email addresses to be deleted:"}),(0,d.jsx)("div",{className:"max-h-32 overflow-y-auto space-y-1",children:aZ.map(a=>(0,d.jsx)("div",{className:"text-sm text-muted-foreground font-mono bg-muted px-2 py-1 rounded",children:a.address},a.id))})]})}),(0,d.jsxs)(p.DialogFooter,{children:[(0,d.jsx)(k.Button,{variant:"secondary",onClick:()=>aq(!1),children:"Cancel"}),(0,d.jsx)(k.Button,{variant:"destructive",onClick:aO,disabled:ac.isPending,children:ac.isPending?"Deleting...":`Delete ${an.size} Address${an.size>1?"es":""}`})]})]})}),(0,d.jsx)(K.DeleteConfirmationDialog,{open:!!aF,onOpenChange:a=>!a&&aG(null),onConfirm:aN,title:"Delete Email Address",itemName:aF?.address,itemType:"email address",isLoading:ac.isPending})]})})}}};

//# sourceMappingURL=_4e451239._.js.map