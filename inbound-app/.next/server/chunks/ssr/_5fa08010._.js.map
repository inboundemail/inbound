{"version":3,"sources":["turbopack:///[project]/app/actions/webhooks.ts","turbopack:///[project]/.next-internal/server/app/(main)/webhooks/page/actions.js (server actions loader)"],"sourcesContent":["\"use server\"\n\nimport { auth } from \"@/lib/auth/auth\"\nimport { headers } from \"next/headers\"\nimport { db } from '@/lib/db'\nimport { webhooks, type NewWebhook } from '@/lib/db/schema'\nimport { eq, and } from 'drizzle-orm'\nimport { randomBytes } from 'crypto'\nimport { revalidatePath } from 'next/cache'\n\n// ============================================================================\n// WEBHOOK MANAGEMENT\n// ============================================================================\n\nexport async function getWebhooks() {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers()\n    })\n\n    if (!session?.user) {\n      return { error: 'Unauthorized' }\n    }\n\n    const userWebhooks = await db\n      .select()\n      .from(webhooks)\n      .where(eq(webhooks.userId, session.user.id))\n      .orderBy(webhooks.createdAt)\n\n    return { success: true, webhooks: userWebhooks }\n  } catch (error) {\n    console.error('Error fetching webhooks:', error)\n    return { error: 'Failed to fetch webhooks' }\n  }\n}\n\nexport async function getWebhook(id: string) {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers()\n    })\n\n    if (!session?.user) {\n      return { error: 'Unauthorized' }\n    }\n\n    const [webhook] = await db\n      .select()\n      .from(webhooks)\n      .where(and(\n        eq(webhooks.id, id),\n        eq(webhooks.userId, session.user.id)\n      ))\n      .limit(1)\n\n    if (!webhook) {\n      return { error: 'Webhook not found' }\n    }\n\n    return { success: true, webhook }\n  } catch (error) {\n    console.error('Error fetching webhook:', error)\n    return { error: 'Failed to fetch webhook' }\n  }\n}\n\nexport async function createWebhook(data: {\n  name: string\n  url: string\n  description?: string\n  headers?: Record<string, string>\n  timeout?: number\n  retryAttempts?: number\n}) {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers()\n    })\n\n    if (!session?.user) {\n      return { error: 'Unauthorized' }\n    }\n\n    const { name, url, description, headers: customHeaders, timeout, retryAttempts } = data\n\n    // Validate required fields\n    if (!name || !url) {\n      return { error: 'Name and URL are required' }\n    }\n\n    // Validate URL format\n    try {\n      new URL(url)\n    } catch {\n      return { error: 'Invalid URL format' }\n    }\n\n    // Check if name already exists for this user\n    const existingWebhook = await db\n      .select()\n      .from(webhooks)\n      .where(and(\n        eq(webhooks.userId, session.user.id),\n        eq(webhooks.name, name)\n      ))\n      .limit(1)\n\n    if (existingWebhook.length > 0) {\n      return { error: 'A webhook with this name already exists' }\n    }\n\n    // Generate a webhook secret\n    const secret = randomBytes(32).toString('hex')\n\n    const newWebhook: NewWebhook = {\n      id: randomBytes(16).toString('hex'),\n      name,\n      url,\n      description: description || null,\n      secret,\n      headers: customHeaders ? JSON.stringify(customHeaders) : null,\n      timeout: timeout || 30,\n      retryAttempts: retryAttempts || 3,\n      userId: session.user.id,\n      isActive: true,\n    }\n\n    const [createdWebhook] = await db\n      .insert(webhooks)\n      .values(newWebhook)\n      .returning()\n\n    // Revalidate relevant paths\n    revalidatePath('/webhooks')\n    revalidatePath('/emails')\n\n    return { success: true, webhook: createdWebhook }\n  } catch (error) {\n    console.error('Error creating webhook:', error)\n    return { error: 'Failed to create webhook' }\n  }\n}\n\nexport async function updateWebhook(id: string, data: {\n  name?: string\n  url?: string\n  description?: string\n  isActive?: boolean\n  headers?: Record<string, string>\n  timeout?: number\n  retryAttempts?: number\n}) {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers()\n    })\n\n    if (!session?.user) {\n      return { error: 'Unauthorized' }\n    }\n\n    const { name, url, description, isActive, headers: customHeaders, timeout, retryAttempts } = data\n\n    // Validate URL format if provided\n    if (url) {\n      try {\n        new URL(url)\n      } catch {\n        return { error: 'Invalid URL format' }\n      }\n    }\n\n    // Check if webhook exists and belongs to user\n    const [existingWebhook] = await db\n      .select()\n      .from(webhooks)\n      .where(and(\n        eq(webhooks.id, id),\n        eq(webhooks.userId, session.user.id)\n      ))\n      .limit(1)\n\n    if (!existingWebhook) {\n      return { error: 'Webhook not found' }\n    }\n\n    // Check if name already exists for this user (excluding current webhook)\n    if (name && name !== existingWebhook.name) {\n      const nameExists = await db\n        .select()\n        .from(webhooks)\n        .where(and(\n          eq(webhooks.userId, session.user.id),\n          eq(webhooks.name, name)\n        ))\n        .limit(1)\n\n      if (nameExists.length > 0 && nameExists[0].id !== id) {\n        return { error: 'A webhook with this name already exists' }\n      }\n    }\n\n    const updateData: any = {\n      updatedAt: new Date(),\n    }\n\n    if (name !== undefined) updateData.name = name\n    if (url !== undefined) updateData.url = url\n    if (description !== undefined) updateData.description = description\n    if (isActive !== undefined) updateData.isActive = isActive\n    if (customHeaders !== undefined) updateData.headers = customHeaders ? JSON.stringify(customHeaders) : null\n    if (timeout !== undefined) updateData.timeout = timeout\n    if (retryAttempts !== undefined) updateData.retryAttempts = retryAttempts\n\n    const [updatedWebhook] = await db\n      .update(webhooks)\n      .set(updateData)\n      .where(and(\n        eq(webhooks.id, id),\n        eq(webhooks.userId, session.user.id)\n      ))\n      .returning()\n\n    // Revalidate relevant paths\n    revalidatePath('/webhooks')\n    revalidatePath('/emails')\n\n    return { success: true, webhook: updatedWebhook }\n  } catch (error) {\n    console.error('Error updating webhook:', error)\n    return { error: 'Failed to update webhook' }\n  }\n}\n\nexport async function deleteWebhook(id: string) {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers()\n    })\n\n    if (!session?.user) {\n      return { error: 'Unauthorized' }\n    }\n\n    // Check if webhook exists and belongs to user\n    const [existingWebhook] = await db\n      .select()\n      .from(webhooks)\n      .where(and(\n        eq(webhooks.id, id),\n        eq(webhooks.userId, session.user.id)\n      ))\n      .limit(1)\n\n    if (!existingWebhook) {\n      return { error: 'Webhook not found' }\n    }\n\n    // TODO: Check if webhook is being used by any email addresses\n    // You might want to prevent deletion or cascade the deletion\n\n    await db\n      .delete(webhooks)\n      .where(and(\n        eq(webhooks.id, id),\n        eq(webhooks.userId, session.user.id)\n      ))\n\n    // Revalidate relevant paths\n    revalidatePath('/webhooks')\n    revalidatePath('/emails')\n\n    return { success: true, message: 'Webhook deleted successfully' }\n  } catch (error) {\n    console.error('Error deleting webhook:', error)\n    return { error: 'Failed to delete webhook' }\n  }\n}\n\nexport async function testWebhook(id: string) {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers()\n    })\n\n    if (!session?.user) {\n      return { error: 'Unauthorized' }\n    }\n\n    // Get webhook details\n    const [webhook] = await db\n      .select()\n      .from(webhooks)\n      .where(and(\n        eq(webhooks.id, id),\n        eq(webhooks.userId, session.user.id)\n      ))\n      .limit(1)\n\n    if (!webhook) {\n      return { error: 'Webhook not found' }\n    }\n\n    if (!webhook.isActive) {\n      return { error: 'Webhook is disabled' }\n    }\n\n    // Prepare test payload\n    const testPayload = {\n      event: 'webhook_test',\n      timestamp: new Date().toISOString(),\n      webhook_id: webhook.id,\n      test: true,\n      data: {\n        message: 'This is a test webhook delivery from Inbound'\n      }\n    }\n\n    // Prepare headers\n    const requestHeaders: Record<string, string> = {\n      'Content-Type': 'application/json',\n      'User-Agent': 'Inbound-Webhook/1.0',\n      'X-Webhook-Signature': webhook.secret || '', // In production, this should be a proper HMAC signature\n    }\n\n    // Add custom headers if any\n    if (webhook.headers) {\n      try {\n        const customHeaders = JSON.parse(webhook.headers)\n        Object.assign(requestHeaders, customHeaders)\n      } catch (error) {\n        console.error('Error parsing custom headers:', error)\n      }\n    }\n\n    // Make the webhook request\n    const startTime = Date.now()\n    let responseBody = ''\n    let responseHeaders: Record<string, string> = {}\n    \n    try {\n      console.log(`üîó Testing webhook: ${webhook.name} (${webhook.url})`)\n      console.log(`üì§ Test payload:`, JSON.stringify(testPayload, null, 2))\n      console.log(`üìã Request headers:`, JSON.stringify(requestHeaders, null, 2))\n      \n      const response = await fetch(webhook.url, {\n        method: 'POST',\n        headers: requestHeaders,\n        body: JSON.stringify(testPayload),\n        signal: AbortSignal.timeout((webhook.timeout || 30) * 1000)\n      })\n\n      const responseTime = Date.now() - startTime\n      \n      // Capture response headers\n      response.headers.forEach((value, key) => {\n        responseHeaders[key] = value\n      })\n      \n      // Capture response body\n      try {\n        responseBody = await response.text()\n      } catch (bodyError) {\n        responseBody = 'Unable to read response body'\n        console.error(`‚ùå Error reading response body:`, bodyError)\n      }\n\n      console.log(`${response.ok ? '‚úÖ' : '‚ùå'} Webhook test ${response.ok ? 'succeeded' : 'failed'}: ${response.status} in ${responseTime}ms`)\n      console.log(`üì® Response headers:`, JSON.stringify(responseHeaders, null, 2))\n      console.log(`üìÑ Response body:`, responseBody)\n\n      // Update webhook stats (you might want to add these fields to your schema)\n      await db\n        .update(webhooks)\n        .set({\n          lastUsed: new Date(),\n          totalDeliveries: (webhook.totalDeliveries || 0) + 1,\n          successfulDeliveries: response.ok ? (webhook.successfulDeliveries || 0) + 1 : (webhook.successfulDeliveries || 0),\n          failedDeliveries: response.ok ? (webhook.failedDeliveries || 0) : (webhook.failedDeliveries || 0) + 1,\n          updatedAt: new Date()\n        })\n        .where(eq(webhooks.id, id))\n\n      // Revalidate relevant paths\n      revalidatePath('/webhooks')\n\n      if (response.ok) {\n        return {\n          success: true,\n          statusCode: response.status,\n          message: `Webhook test successful! Response: ${response.status}`,\n          responseTime,\n          responseBody: responseBody.substring(0, 1000), // Limit response body for client\n          responseHeaders\n        }\n      } else {\n        const errorDetails = `Status: ${response.status} ${response.statusText}`\n        console.error(`‚ùå Webhook test failed - ${errorDetails}`)\n        console.error(`‚ùå Response body:`, responseBody)\n        \n        return {\n          success: false,\n          statusCode: response.status,\n          error: `Webhook test failed with status: ${response.status} ${response.statusText}`,\n          responseTime,\n          responseBody: responseBody.substring(0, 1000), // Limit response body for client\n          responseHeaders,\n          details: {\n            url: webhook.url,\n            timeout: webhook.timeout || 30,\n            statusText: response.statusText\n          }\n        }\n      }\n    } catch (fetchError: any) {\n      const responseTime = Date.now() - startTime\n      let errorMessage = 'Unknown error'\n      let errorType = 'network'\n      \n      if (fetchError.name === 'TimeoutError' || fetchError.name === 'AbortError') {\n        errorMessage = `Request timeout after ${webhook.timeout || 30} seconds`\n        errorType = 'timeout'\n      } else if (fetchError.name === 'TypeError' && fetchError.message.includes('fetch')) {\n        errorMessage = `Network error: ${fetchError.message}`\n        errorType = 'network'\n      } else {\n        errorMessage = fetchError.message || 'Unknown error'\n        errorType = 'unknown'\n      }\n\n      console.error(`‚ùå Webhook test failed with ${errorType} error:`, errorMessage)\n      console.error(`‚ùå Full error details:`, fetchError)\n      \n      // Update failed delivery count\n      await db\n        .update(webhooks)\n        .set({\n          totalDeliveries: (webhook.totalDeliveries || 0) + 1,\n          failedDeliveries: (webhook.failedDeliveries || 0) + 1,\n          updatedAt: new Date()\n        })\n        .where(eq(webhooks.id, id))\n\n      // Revalidate relevant paths\n      revalidatePath('/webhooks')\n\n      return {\n        success: false,\n        error: `Webhook test failed: ${errorMessage}`,\n        responseTime,\n        details: {\n          url: webhook.url,\n          timeout: webhook.timeout || 30,\n          errorType,\n          originalError: fetchError.message\n        }\n      }\n    }\n  } catch (error) {\n    console.error('Error testing webhook:', error)\n    return { error: 'Failed to test webhook' }\n  }\n} ","export {getAutumnCustomer as '00bd5c39d59f2c9e83dce14d93d44f40e9d2c4f1ae'} from 'ACTIONS_MODULE0'\nexport {sendFeedbackAction as '4001b46509619c2e0fe09e06802ee8157c6226ec8c'} from 'ACTIONS_MODULE1'\nexport {getDomainStats as '00faa09f01a5256e987f59d5eb3348cc00f9bf9491'} from 'ACTIONS_MODULE0'\nexport {generateAutumnBillingPortal as '00282b3a5eacbbc918f95ec4473b7dc09d0e5ffcf8'} from 'ACTIONS_MODULE0'\nexport {getOnboardingStatus as '40d22d6e027abaab42994fd38d69f454c777a42914'} from 'ACTIONS_MODULE2'\nexport {getWebhooks as '0033509ad366aa6a87e952e2313e6ac9178e219542'} from 'ACTIONS_MODULE3'\nexport {createWebhook as '40ac5c1f5a73f51e037883eba8504686a1e492c7ab'} from 'ACTIONS_MODULE3'\nexport {updateWebhook as '6059f1634f6dfc74054b84ae414c11596cceeb4c6e'} from 'ACTIONS_MODULE3'\nexport {deleteWebhook as '40678defcdd6d1be0653983f7df2baf1cbbfbc5edc'} from 'ACTIONS_MODULE3'\nexport {testWebhook as '400605f8cc72befca4c1d670ad479a8708cca3a3e0'} from 'ACTIONS_MODULE3'\n"],"names":[],"mappings":"qNAEA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,CAAA,CAAA,QAAA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAMO,eAAe,IACpB,GAAI,CACF,IAAM,EAAU,MAAM,EAAA,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,CACxC,QAAS,MAAM,CAAA,CADK,CACL,EAAA,OAAA,AAAM,GACvB,GAEA,GAAI,CAAC,GAAS,KACZ,CADkB,KACX,CAAE,KAJM,CAIC,cAAe,EAGjC,IAAM,EAAe,MAAM,EAAA,EAAE,CAC1B,MAAM,GACN,IAAI,CAAC,EAAA,QAAQ,EACb,KAAK,CAAC,CAAA,CAHkB,CAGlB,EAAA,EAAA,AAAC,EAAE,EAAA,QAAQ,CAAC,CADb,KACmB,CAAE,EAAQ,IAAI,CAAC,EAAE,GACzC,GADM,IACC,CAAC,CADC,CACD,QAAQ,CAAC,SAAS,EAE7B,MAAO,CAAE,SAAS,CAFP,CAEa,SAAU,CAAa,CACjD,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,2BAA4B,GACnC,CAAE,MAAO,0BAA2B,CAC7C,CACF,CAEO,eAAe,EAAW,CAAU,EACzC,GAAI,CACF,IAAM,EAAU,MAAM,EAAA,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,CACxC,QAAS,MAAM,CAAA,CADK,CACL,EAAA,OAAA,AAAM,GACvB,GAEA,GAAI,CAAC,GAAS,KACZ,CADkB,KACX,CAAE,KAJM,CAIC,cAAe,EAGjC,GAAM,CAAC,EAAQ,CAAG,MAAM,EAAA,EAAE,CACvB,MAAM,GACN,IAAI,CAAC,EAAA,QAAQ,EACb,KAAK,CAAC,CAAA,CAHe,CAGf,EAAA,GAAA,AAAE,EACP,CAAA,EAAA,EAAA,EAAA,AAAC,EAAE,EAAA,AAFC,QAEO,CAAC,EAAE,CAAE,GAChB,GAAA,EAAA,CAFK,CAEL,AAAC,EAAE,EAAA,KADH,GACW,CAAC,EADT,IACe,CAAE,EAAQ,IAAI,CAAC,EAAE,IAEpC,EAFC,GAEI,CAAC,EAFF,CAIP,GAAI,CAAC,EACH,MAAO,CADK,AACH,MAAO,mBAAoB,EAGtC,MAAO,CAAE,SAAS,UAAM,CAAQ,CAClC,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,0BAA2B,GAClC,CAAE,MAAO,yBAA0B,CAC5C,CACF,CAEO,eAAe,EAAc,CAOnC,EACC,GAAI,CACF,IAAM,EAAU,MAAM,EAAA,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,CACxC,QAAS,MAAM,CAAA,CADK,CACL,EAAA,OAAA,AAAM,GACvB,GAEA,GAAI,CAAC,GAAS,KACZ,CADkB,KACX,CAAE,KAJM,CAIC,cAAe,EAGjC,GAAM,MAAE,CAAI,KAAE,CAAG,aAAE,CAAW,CAAE,QAAS,CAAa,SAAE,CAAO,eAAE,CAAa,CAAE,CAAG,EAGnF,GAAI,CAAC,GAAQ,CAAC,EACZ,GADiB,GACV,CAAE,MAAO,2BAA4B,EAI9C,GAAI,CACF,IAAI,IAAI,EACV,CAAE,KAAM,CACN,MAAO,CAAE,MAAO,oBAAqB,CACvC,CAYA,GATwB,AASpB,OAT0B,EAAA,EAAE,CAC7B,MAAM,GACN,IAAI,CAAC,EAAA,QAAQ,EACb,KAAK,CAAC,CAAA,CAHqB,CAGrB,EAAA,GAAA,AAAE,EACP,CAAA,EAAA,EAAA,EAAA,AAAC,EAAE,EAFC,AAED,QAAQ,CAAC,MAAM,CAAE,EAAQ,GADvB,CAC2B,CAAC,EAAE,EACnC,CAAA,EAAA,CADA,CACA,EAAA,AAAC,EAAE,CADA,CACA,QAAQ,CAAC,IAAI,CAAE,KAEnB,KAAK,CAAC,EAAA,EAEW,EAJhB,IAIsB,CAAG,CAJtB,CAKL,CAD8B,KACvB,CAAE,MAAO,yCAA0C,EAI5D,IAAM,EAAS,CAAA,EAAA,EAAA,WAAA,AAAU,EAAE,IAAI,QAAQ,CAAC,OAElC,EAAyB,CAC7B,CAHa,EAGT,CAAA,EAAA,EAAA,WAAU,AAAV,EAAY,IAAI,QAAQ,CAAC,WAAzB,CACJ,MACA,EACA,YAAa,GAAe,YAC5B,EACA,QAAS,EAAgB,KAAK,SAAS,CAAC,GAAiB,KACzD,QAAS,GAAW,GACpB,cAAe,GAAiB,EAChC,OAAQ,EAAQ,IAAI,CAAC,EAAE,CACvB,UAAU,CACZ,EAEM,CAAC,EAAe,CAAG,MAAM,EAAA,EAAE,CAC9B,MAAM,CAAC,EAAA,QAAQ,EACf,MAAM,CAAC,GACP,KAH4B,IAGnB,GAMZ,KARU,CAKV,CAAA,EAAA,EAAA,cAAA,AAAa,EAAE,aACf,CAAA,EAAA,EAAA,GADA,WACA,AAAa,EAAE,WAER,CAAE,SAFT,AAEkB,EAAM,QAAS,CAAe,CAClD,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,0BAA2B,GAClC,CAAE,MAAO,0BAA2B,CAC7C,CACF,CAEO,eAAe,EAAc,CAAU,CAAE,CAQ/C,EACC,GAAI,CACF,IAAM,EAAU,MAAM,EAAA,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,CACxC,QAAS,MAAM,CAAA,CADK,CACL,EAAA,OAAA,AAAM,GACvB,GAEA,GAAI,CAAC,GAAS,KACZ,CADkB,KACX,CAAE,KAJM,CAIC,cAAe,EAGjC,GAAM,MAAE,CAAI,KAAE,CAAG,aAAE,CAAW,UAAE,CAAQ,CAAE,QAAS,CAAa,SAAE,CAAO,eAAE,CAAa,CAAE,CAAG,EAG7F,GAAI,EACF,GADO,AACH,CACF,IAAI,IAAI,EACV,CAAE,KAAM,CACN,MAAO,CAAE,MAAO,oBAAqB,CACvC,CAIF,GAAM,CAAC,EAAgB,CAAG,MAAM,EAAA,EAAE,CAC/B,MAAM,GACN,IAAI,CAAC,EAAA,QAAQ,EACb,KAAK,CAAC,CAAA,CAHuB,CAGvB,EAAA,GAAA,AAAE,EACP,CAAA,EAAA,EAAA,EAAA,AAAC,EAAE,EAAA,AAFC,QAEO,CAAC,EAAE,CAAE,GAChB,CAAA,EAAA,EAAA,CAFK,CAEL,AAAC,EAAE,EAAA,KADH,GACW,CAAC,EADT,IACe,CAAE,EAAQ,IAAI,CAAC,EAAE,IAEpC,EAFC,GAEI,CAAC,EAFF,CAIP,GAAI,CAAC,EACH,MAAO,CAAE,MAAO,EADI,iBACgB,EAItC,GAAI,GAAQ,IAAS,EAAgB,IAAI,CAAE,CACzC,IAAM,EAAa,MAAM,EAAA,EAAE,CACxB,MAAM,GACN,IAAI,CAAC,EAAA,QAAQ,EACb,KAAK,CAAC,CAAA,CAHgB,CAGhB,EAAA,GAAE,AAAF,EACL,CAAA,EAAA,EAAA,EAAA,AAAC,EAAE,EAAA,AAFC,QAEO,CAAC,MAAM,CAAE,EAAQ,GADvB,CAC2B,CAAC,EAAE,EACnC,CAAA,EAAA,CADA,CACA,EAAA,AAAC,EAAE,CADA,CACA,QAAQ,CAAC,IAAI,CAAE,KAEnB,KAAK,CAAC,GAET,GAAI,AAJA,EAIW,IAJR,EAIc,CAAG,GAAK,CAAU,CAAC,EAAE,CAAC,EAAE,GAAK,EAChD,EADoD,IAC7C,CAAE,MAAO,yCAA0C,CAE9D,CAEA,IAAM,EAAkB,CACtB,UAAW,IAAI,IACjB,CAEI,MAAS,QAAW,EAAW,IAAI,CAAG,CAAA,EACtC,KAAQ,QAAW,EAAW,GAAG,CAAG,CAAA,OACpB,IAAhB,IAA2B,EAAW,WAAW,CAAG,CAAA,OACvC,IAAb,IAAwB,EAAW,QAAQ,CAAG,CAAA,OAC5B,IAAlB,IAA6B,EAAW,OAAO,CAAG,EAAgB,KAAK,SAAS,CAAC,GAAiB,IAAA,EACtF,AAAZ,aAAuB,EAAW,OAAO,CAAG,CAAA,OAC1B,IAAlB,IAA6B,EAAW,aAAa,CAAG,CAAA,EAE5D,GAAM,CAAC,EAAe,CAAG,MAAM,EAAA,EAAE,CAC9B,MAAM,CAAC,EAAA,QAAQ,EACf,GAAG,CAAC,GACJ,KAAK,CAAC,CAAA,CAHsB,CAGtB,EAAA,GAAA,AAAE,EACP,GAAA,CAHM,CAGN,EAAA,AAAC,EAAE,EAAA,QAAQ,CAAC,EAAE,CAAE,GAChB,CAAA,EAAA,EAAA,CAFK,CAEL,AAAC,EAAE,EAAA,KADH,GACW,CAAC,EADT,IACe,CAAE,EAAQ,IAAI,CAAC,EAAE,IAEpC,EAFC,MAAG,CAEK,GAMZ,MAHA,CAAA,EAAA,EAAA,cAAA,AAAa,EAAE,aACf,CAAA,EAAA,EAAA,GADA,WACa,AAAb,EAAe,WAER,CAAE,SAAS,AAFlB,EAEwB,QAAS,CAAe,CAClD,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,0BAA2B,GAClC,CAAE,MAAO,0BAA2B,CAC7C,CACF,CAEO,eAAe,EAAc,CAAU,EAC5C,GAAI,CACF,IAAM,EAAU,MAAM,EAAA,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,CACxC,QAAS,MAAM,CAAA,CADK,CACL,EAAA,OAAA,AAAM,GACvB,GAEA,GAAI,CAAC,GAAS,KACZ,CADkB,KACX,CAAE,KAJM,CAIC,cAAe,EAIjC,GAAM,CAAC,EAAgB,CAAG,MAAM,EAAA,EAAE,CAC/B,MAAM,GACN,IAAI,CAAC,EAAA,QAAQ,EACb,KAAK,CAAC,CAAA,CAHuB,CAGvB,EAAA,GAAA,AAAE,EACP,CAAA,EAAA,EAAA,EAAA,AAAC,EAAE,EAAA,AAFC,QAEO,CAAC,EAAE,CAAE,GAChB,GAAA,EAAA,CAFK,CAEL,AAAC,EAAE,EAAA,KADH,GACW,CAAC,EADT,IACe,CAAE,EAAQ,IAAI,CAAC,EAAE,IAEpC,EAFC,GAEI,CAAC,EAFF,CAIP,GAAI,CAAC,EACH,MAAO,CAAE,MAAO,EADI,iBACgB,EAiBtC,OAXA,MAAM,EAAA,EAAE,CACL,MAAM,CAAC,EAAA,QAAQ,EACf,KAAK,CAAC,GAAA,EAAA,GAAA,AAAE,CAFL,CAGF,CAAA,EAAA,EAAA,EAAA,AAAC,EAAE,EAFG,AAEH,QAAQ,CAAC,EAAE,CAAE,GAChB,CAAA,EAAA,EAAA,CAFK,CAEL,AAAC,EAAE,EAAA,KADH,GACW,CAAC,EADT,IACe,CAAE,EAAQ,IAAI,CAAC,EAAE,IAIvC,CAAA,CAJI,CAIJ,EAAA,GAJO,WAIP,AAAa,EAAE,aACf,CAAA,EAAA,EAAA,GADA,WACA,AAAa,EAAE,WAER,CAAE,SAFT,AAEkB,EAAM,QAAS,8BAA+B,CAClE,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,0BAA2B,GAClC,CAAE,MAAO,0BAA2B,CAC7C,CACF,CAEO,eAAe,EAAY,CAAU,EAC1C,GAAI,CACF,IAAM,EAAU,MAAM,EAAA,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,CACxC,QAAS,MAAM,CAAA,CADK,CACL,EAAA,OAAA,AAAM,GACvB,GAEA,GAAI,CAAC,GAAS,KACZ,CADkB,KACX,CAAE,KAJM,CAIC,cAAe,EAIjC,GAAM,CAAC,EAAQ,CAAG,MAAM,EAAA,EAAE,CACvB,MAAM,GACN,IAAI,CAAC,EAAA,QAAQ,EACb,KAAK,CAAC,CAAA,CAHe,CAGf,EAAA,GAAA,AAAE,EACP,CAAA,EAAA,EAAA,EAAC,AAAD,EAAG,EAAA,AAFC,QAEO,CAAC,EAAE,CAAE,GAChB,CAAA,EAAA,EAAA,CAFK,CAEL,AAAC,EAAE,EAAA,KADH,GACW,CAAC,EADT,IACe,CAAE,EAAQ,IAAI,CAAC,EAAE,IAEpC,EAFC,GAEI,CAAC,EAFF,CAIP,GAAI,CAAC,EACH,MAAO,CADK,AACH,MAAO,mBAAoB,EAGtC,GAAI,CAAC,EAAQ,QAAQ,CACnB,CADqB,KACd,CAAE,MAAO,qBAAsB,EAIxC,IAAM,EAAc,CAClB,MAAO,eACP,UAAW,IAAI,OAAO,WAAW,GACjC,WAAY,EAAQ,EAAE,CACtB,MAAM,EACN,KAAM,CACJ,QAAS,8CACX,CACF,EAGM,EAAyC,CAC7C,eAAgB,mBAChB,aAAc,sBACd,sBAAuB,EAAQ,MAAM,EAAI,EAC3C,EAGA,GAAI,EAAQ,OAAO,CACjB,CADmB,EACf,CACF,IAAM,EAAgB,KAAK,KAAK,CAAC,EAAQ,OAAO,EAChD,OAAO,MAAM,CAAC,EAAgB,EAChC,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,gCAAiC,EACjD,CAIF,IAAM,EAAY,KAAK,GAAG,GACtB,EAAe,GACf,EAA0C,CAAC,EAE/C,GAAI,CACF,QAAQ,GAAG,CAAC,CAAC,oBAAoB,EAAE,EAAQ,IAAI,CAAC,EAAE,EAAE,EAAQ,GAAG,CAAC,CAAC,CAAC,EAClE,QAAQ,GAAG,CAAC,CAAC,gBAAgB,CAAC,CAAE,KAAK,SAAS,CAAC,EAAa,KAAM,IAClE,QAAQ,GAAG,CAAC,CAAC,mBAAmB,CAAC,CAAE,KAAK,SAAS,CAAC,EAAgB,KAAM,IAExE,IAAM,EAAW,MAAM,MAAM,EAAQ,GAAG,CAAE,CACxC,OAAQ,OACR,QAAS,EACT,KAAM,KAAK,SAAS,CAAC,GACrB,OAAQ,YAAY,OAAO,CAAC,AAA0B,KAAzB,EAAQ,OAAO,EAAI,EAAA,CAAE,CACpD,GAEM,EAAe,KAAK,GAAG,GAAK,EAGlC,EAAS,OAAO,CAAC,OAAO,CAAC,CAAC,EAAO,KAC/B,CAAe,CAAC,EAAI,CAAG,CACzB,GAGA,GAAI,CACF,EAAe,MAAM,EAAS,IAAI,EACpC,CAAE,MAAO,EAAW,CAClB,EAAe,+BACf,QAAQ,KAAK,CAAC,CAAC,8BAA8B,CAAC,CAAE,EAClD,CAqBA,GAnBA,QAAQ,GAAG,CAAC,CAAA,EAAG,EAAS,EAAE,CAAG,IAAM,IAAI,cAAc,EAAE,EAAS,EAAE,CAAG,YAAc,SAAS,EAAE,EAAE,EAAS,MAAM,CAAC,IAAI,EAAE,EAAa,EAAE,CAAC,EACtI,QAAQ,GAAG,CAAC,CAAC,oBAAoB,CAAC,CAAE,KAAK,SAAS,CAAC,EAAiB,KAAM,IAC1E,QAAQ,GAAG,CAAC,CAAC,iBAAiB,CAAC,CAAE,GAGjC,MAAM,EAAA,EAAE,CACL,MAAM,CAAC,EAAA,QAAQ,EACf,GAAG,CAAC,CACH,SAAU,CAHR,GAGY,KACd,IAHM,YAGW,CAAC,EAAQ,eAAe,GAAI,CAAC,CAAI,EAClD,qBAAsB,EAAS,EAAE,CAAG,CAAC,EAAQ,oBAAoB,GAAI,CAAC,CAAI,EAAK,EAAQ,oBAAoB,EAAI,EAC/G,iBAAkB,EAAS,EAAE,CAAI,EAAQ,gBAAgB,EAAI,EAAK,CAAC,EAAQ,gBAAgB,EAAI,CAAC,EAAI,EACpG,UAAW,IAAI,IACjB,GACC,KAAK,CAAC,CAAA,EAAA,EAAA,EAAC,AAAD,EAAG,EAAA,QAAQ,CAAC,EAAE,CAAE,IAGzB,CAAA,EAAA,EAAA,UAHS,IAGT,AAAa,EAAE,AAHH,aAKR,EAAS,EAAE,CACb,CADe,EAFjB,GAGS,CACL,SAAS,EACT,WAAY,EAAS,MAAM,CAC3B,QAAS,CAAC,mCAAmC,EAAE,EAAS,MAAM,CAAA,CAAE,cAChE,EACA,aAAc,EAAa,SAAS,CAAC,EAAG,qBACxC,CACF,CACK,EACL,IAAM,EAAe,CAAC,QAAQ,EAAE,EAAS,MAAM,CAAC,CAAC,EAAE,EAAS,UAAU,CAAA,CAAE,CAIxE,OAHA,QAAQ,KAAK,CAAC,CAAC,wBAAwB,EAAE,EAAA,CAAc,EACvD,QAAQ,KAAK,CAAC,CAAC,gBAAgB,CAAC,CAAE,GAE3B,CACL,SAAS,EACT,WAAY,EAAS,MAAM,CAC3B,MAAO,CAAC,iCAAiC,EAAE,EAAS,MAAM,CAAC,CAAC,EAAE,EAAS,UAAU,CAAA,CAAE,cACnF,EACA,aAAc,EAAa,SAAS,CAAC,EAAG,qBACxC,EACA,QAAS,CACP,IAAK,EAAQ,GAAG,CAChB,QAAS,EAAQ,OAAO,EAAI,GAC5B,WAAY,EAAS,UAAU,AACjC,CACF,CACF,CACF,CAAE,MAAO,EAAiB,CACxB,IAAM,EAAe,KAAK,GAAG,GAAK,EAC9B,EAAe,gBACf,EAAY,UA6BhB,MA3BwB,iBAApB,EAAW,IAAI,EAA2C,cAAc,CAAlC,EAAW,IAAI,EACvD,EAAe,CAAC,sBAAsB,EAAE,EAAQ,OAAO,EAAI,GAAG,QAAQ,CAAC,CACvE,EAAY,WACiB,cAApB,EAAW,IAAI,EAAoB,EAAW,OAAO,CAAC,QAAQ,CAAC,UAAU,AAClF,EAAe,CAAC,eAAe,EAAE,EAAW,OAAO,CAAA,CAAE,CACrD,EAAY,YAEZ,EAAe,EAAW,OAAO,EAAI,gBACrC,EAAY,WAGd,QAAQ,KAAK,CAAC,CAAC,2BAA2B,EAAE,EAAU,OAAO,CAAC,CAAE,GAChE,QAAQ,KAAK,CAAC,CAAC,qBAAqB,CAAC,CAAE,GAGvC,MAAM,EAAA,EAAE,CACL,MAAM,CAAC,EAAA,QAAQ,EACf,GAAG,CAAC,CACH,UAHE,MAGe,CAAC,EAAQ,GAFpB,YAEmC,GAAI,CAAC,CAAI,EAClD,iBAAkB,AAAC,GAAQ,gBAAgB,GAAI,CAAC,CAAI,EACpD,UAAW,IAAI,IACjB,GACC,KAAK,CAAC,CAAA,EAAA,EAAA,EAAA,AAAC,EAAE,EAAA,QAAQ,CAAC,EAAE,CAAE,IAGzB,CAAA,EAAA,EAAA,UAHS,IAGT,AAAa,EAAE,AAHH,aAKL,CACL,OAHF,EAGW,EACT,MAAO,CAAC,qBAAqB,EAAE,EAAA,CAAc,cAC7C,EACA,QAAS,CACP,IAAK,EAAQ,GAAG,CAChB,QAAS,EAAQ,OAAO,EAAI,aAC5B,EACA,cAAe,EAAW,OAAO,AACnC,CACF,CACF,CACF,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,yBAA0B,GACjC,CAAE,MAAO,wBAAyB,CAC3C,CACF,2CAjcsB,EAuBA,EA8BA,EA6EA,EA2FA,EA6CA,IA1QA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAuBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA8BA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA6EA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA2FA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA6CA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,qFCxRtB,EAAA,CAAA,CAAA,QACA,IAAA,EAAA,EAAA,CAAA,CAAA,QAGA,EAAA,CAAA,CAAA,QACA,EAAA,CAAA,CAAA"}